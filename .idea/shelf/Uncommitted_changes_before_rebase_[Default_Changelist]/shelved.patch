Index: app/src/main/java/com/misit/faceidchecklogptabp/Response/MainResponse/FirstLoadResponse.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/misit/faceidchecklogptabp/Response/MainResponse/FirstLoadResponse.kt	(date 1617087458734)
+++ app/src/main/java/com/misit/faceidchecklogptabp/Response/MainResponse/FirstLoadResponse.kt	(date 1617087458734)
@@ -0,0 +1,111 @@
+package com.misit.faceidchecklogptabp.Response.MainResponse
+
+import com.google.gson.annotations.SerializedName
+
+data class FirstLoadResponse(
+
+	@field:SerializedName("area")
+	val area: String? = null,
+
+	@field:SerializedName("hari")
+	val hari: String? = null,
+
+	@field:SerializedName("roster")
+	val roster: Roster? = null,
+
+	@field:SerializedName("detik")
+	val detik: String? = null,
+
+	@field:SerializedName("jam")
+	val jam: String? = null,
+
+	@field:SerializedName("presensi")
+	val presensi: List<PresensiItem?>? = null,
+
+	@field:SerializedName("absensi")
+	val absensi: Absensi? = null,
+
+	@field:SerializedName("tanggal")
+	val tanggal: String? = null,
+
+	@field:SerializedName("menit")
+	val menit: String? = null
+)
+
+data class Absensi(
+
+	@field:SerializedName("app")
+	val app: String? = null,
+
+	@field:SerializedName("nik")
+	val nik: String? = null,
+
+	@field:SerializedName("phone_token")
+	val phoneToken: String? = null,
+
+	@field:SerializedName("flag")
+	val flag: Int? = null,
+
+	@field:SerializedName("app_version")
+	val appVersion: String? = null,
+
+	@field:SerializedName("jam")
+	val jam: String? = null,
+
+	@field:SerializedName("tgl")
+	val tgl: String? = null,
+
+	@field:SerializedName("imei")
+	val imei: String? = null,
+
+	@field:SerializedName("id")
+	val id: Int? = null
+)
+
+data class PresensiItem(
+
+	@field:SerializedName("nik")
+	val nik: String? = null,
+
+	@field:SerializedName("pulang")
+	val pulang: String? = null,
+
+	@field:SerializedName("jam")
+	val jam: String? = null,
+
+	@field:SerializedName("masuk")
+	val masuk: String? = null,
+
+	@field:SerializedName("tanggal")
+	val tanggal: String? = null,
+
+	@field:SerializedName("id_roster")
+	val idRoster: Int? = null,
+
+	@field:SerializedName("kode_jam")
+	val kodeJam: String? = null,
+
+	@field:SerializedName("status")
+	val status: String? = null
+)
+
+data class Roster(
+
+	@field:SerializedName("nik")
+	val nik: String? = null,
+
+	@field:SerializedName("pulang")
+	val pulang: String? = null,
+
+	@field:SerializedName("masuk")
+	val masuk: String? = null,
+
+	@field:SerializedName("tanggal")
+	val tanggal: String? = null,
+
+	@field:SerializedName("id_roster")
+	val idRoster: Int? = null,
+
+	@field:SerializedName("kode_jam")
+	val kodeJam: String? = null
+)
Index: app/src/main/java/com/misit/faceidchecklogptabp/MainActivity.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.misit.faceidchecklogptabp\r\n\r\nimport android.Manifest\r\nimport android.content.Context\r\nimport android.content.Intent\r\nimport android.content.pm.PackageInfo\r\nimport android.content.pm.PackageManager\r\nimport android.location.Location\r\nimport android.location.LocationListener\r\nimport android.location.LocationManager\r\nimport android.net.ConnectivityManager\r\nimport android.net.Uri\r\nimport android.os.Build\r\nimport android.os.Bundle\r\nimport android.os.Handler\r\nimport android.util.Log\r\nimport android.view.View\r\nimport android.widget.Toast\r\nimport androidx.appcompat.app.AlertDialog\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport androidx.core.app.ActivityCompat\r\nimport androidx.core.content.ContextCompat\r\nimport com.bumptech.glide.Glide\r\nimport com.google.android.gms.ads.AdListener\r\nimport com.google.android.gms.ads.AdRequest\r\nimport com.google.android.gms.ads.AdView\r\nimport com.google.android.gms.ads.MobileAds\r\nimport com.google.android.gms.tasks.OnCompleteListener\r\nimport com.google.firebase.analytics.FirebaseAnalytics\r\nimport com.google.firebase.iid.FirebaseInstanceId\r\nimport com.google.firebase.messaging.FirebaseMessaging\r\nimport com.misit.abpenergy.api.ApiClient\r\nimport com.misit.abpenergy.api.ApiEndPoint\r\nimport com.misit.faceidchecklogptabp.Response.AbpResponse\r\nimport com.misit.faceidchecklogptabp.Response.AndroidTokenResponse\r\nimport com.misit.faceidchecklogptabp.Response.AppVersionResponse\r\nimport com.misit.faceidchecklogptabp.Utils.PrefsUtil\r\nimport es.dmoral.toasty.Toasty\r\nimport kotlinx.android.synthetic.main.activity_main.*\r\nimport retrofit2.Call\r\nimport retrofit2.Callback\r\nimport retrofit2.Response\r\n\r\n\r\nclass MainActivity : AppCompatActivity(), LocationListener {\r\n    private var app_version : String?=\"\"\r\n    lateinit var runnable:Runnable\r\n    lateinit var handler: Handler\r\n    private var android_token : String?=null\r\n    var tipe:String?=null\r\n    lateinit var mAdView : AdView\r\n    lateinit var  mFirebaseAnalytics: FirebaseAnalytics\r\n    var isWifiConn: Boolean = false\r\n    lateinit var url_base:ApiClient\r\n    private var mLocationManager : LocationManager?=null\r\n    private var mLocation : Location?= null\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n            super.onCreate(savedInstanceState)\r\n            setContentView(R.layout.activity_main)\r\n\r\n        handler = Handler()\r\n        PrefsUtil.initInstance(this)\r\n//        val connMgr = getSystemService(Context.CONNECTIVITY_SERVICE) as ConnectivityManager\r\n\r\n        getGPS()\r\n//        var activeNetwork = connMgr.getActiveNetworkInfo()\r\n//        if (activeNetwork != null) {\r\n//            // connected to the internet\r\n//            if (activeNetwork.getType() == ConnectivityManager.TYPE_WIFI) {\r\n//                // connected to wifi\r\n//                isWifiConn = isWifiConn\r\n//            } else if (activeNetwork.getType() == ConnectivityManager.TYPE_MOBILE) {\r\n//                // connected to mobile data\r\n//            }\r\n//        } else {\r\n//            // not connected to the internet\r\n//        }\r\n\r\n//        var url_base = ApiClient\r\n//        if(PrefsUtil.getInstance().getBooleanState(PrefsUtil.IS_LOGGED_IN,false)) {\r\n//            if(PrefsUtil.getInstance()\r\n//                    .getStringState(PrefsUtil.NIK,null)==\"18060207\"){\r\n//                url_base.loadURL(\"https://abpjobsite.com\")\r\n//                updateProgress()\r\n//            }else{\r\n//                url_base.loadURL(\"http://10.10.3.13\")\r\n//                if(isWifiConn){\r\n\r\n//                }else{\r\n//                    koneksiInActive()\r\n//                }\r\n//            }\r\n//        }\r\n//        Log.d(DEBUG_TAG, \"Wifi connected: $isWifiConn\")\r\n\r\n//        updateProgress()\r\n\r\n        cekLokasi()\r\n\r\n        if (Build.VERSION.SDK_INT > Build.VERSION_CODES.LOLLIPOP) {\r\n            verifyStoragePermissions()\r\n        }\r\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {\r\n            window.decorView.apply {\r\n                systemUiVisibility = View.SYSTEM_UI_FLAG_HIDE_NAVIGATION  or View.SYSTEM_UI_FLAG_FULLSCREEN\r\n            }\r\n\r\n        }\r\n        androidToken()\r\n        versionApp()\r\n\r\n\r\n        tipe = intent.getStringExtra(TIPE)\r\n        Glide.with(this).load(R.drawable.abp).into(imageView)\r\n\r\n        tvVersionCode.text=\" V.${app_version}\"\r\n\r\n\r\n\r\n    }\r\n\r\n    override fun onResume() {\r\n        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this)\r\n        MobileAds.initialize(this) {}\r\n\r\n        mAdView = findViewById(R.id.adView)\r\n        val adRequest = AdRequest.Builder().build()\r\n        mAdView.loadAd(adRequest)\r\n\r\n        mAdView.adListener = object: AdListener() {\r\n            override fun onAdLoaded() {\r\n//                    updateProgress()\r\n            }\r\n\r\n            override fun onAdFailedToLoad(errorCode : Int) {\r\n//                    updateProgress()\r\n            }\r\n\r\n            override fun onAdOpened() {\r\n            }\r\n\r\n            override fun onAdClicked() {\r\n            }\r\n\r\n            override fun onAdLeftApplication() {\r\n            }\r\n\r\n            override fun onAdClosed() {\r\n            }\r\n        }\r\n        super.onResume()\r\n    }\r\n    fun getGPS(){\r\n        mLocationManager = getSystemService(Context.LOCATION_SERVICE) as LocationManager\r\n        if(Build.VERSION.SDK_INT>= Build.VERSION_CODES.LOLLIPOP){\r\n            if(ActivityCompat.checkSelfPermission(this,\r\n                    Manifest.permission.ACCESS_FINE_LOCATION)\r\n                != PackageManager.PERMISSION_GRANTED ){\r\n                PackageManager.PERMISSION_GRANTED\r\n                ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.ACCESS_FINE_LOCATION),1)\r\n                return\r\n            }else{\r\n                updateProgress()\r\n            }\r\n        }\r\n        assert(mLocationManager!=null)\r\n        mLocationManager?.requestLocationUpdates(LocationManager.GPS_PROVIDER,\r\n            10,10f,this)\r\n    }\r\n    override fun onRequestPermissionsResult(\r\n        requestCode: Int,\r\n        permissions: Array<out String>,\r\n        grantResults: IntArray\r\n    ) {\r\n        if(requestCode==1){\r\n            if(grantResults[0]==PackageManager.PERMISSION_GRANTED){\r\n                if(ActivityCompat.checkSelfPermission(this,\r\n                        Manifest.permission.ACCESS_FINE_LOCATION)\r\n                    != PackageManager.PERMISSION_GRANTED\r\n                    &&\r\n                    ActivityCompat.checkSelfPermission(this,Manifest.permission.ACCESS_COARSE_LOCATION)\r\n                    != PackageManager.PERMISSION_GRANTED)\r\n                {\r\n//                    Toasty.info(this@MainActivity,\"B\",Toasty.LENGTH_LONG).show()\r\n                    return\r\n                }else\r\n                {\r\n//                    ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.ACCESS_FINE_LOCATION),1)\r\n//                    Toast.makeText(this,\"tidak mendapatkan lokasi\",Toast.LENGTH_SHORT).show()\r\n                }\r\n                mLocationManager!!.requestLocationUpdates(LocationManager.GPS_PROVIDER,\r\n                    10,10f,this)\r\n                updateProgress()\r\n//                PopupUtil.showLoading(this,\"\",\"Finding your location\")\r\n            }else{\r\n                ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.ACCESS_FINE_LOCATION),1)\r\n\r\n//                Toasty.info(this@MainActivity,\"C\",Toasty.LENGTH_LONG).show()\r\n            }\r\n        }\r\n        super.onRequestPermissionsResult(requestCode, permissions, grantResults)\r\n    }\r\n    private fun verifyStoragePermissions() {\r\n        val permission = ContextCompat.checkSelfPermission(this,\r\n            Manifest.permission.READ_EXTERNAL_STORAGE)\r\n        val permission1 = ContextCompat.checkSelfPermission(this,\r\n            Manifest.permission.WRITE_EXTERNAL_STORAGE)\r\n        val permission2 = ContextCompat.checkSelfPermission(this,\r\n            Manifest.permission.READ_PHONE_STATE)\r\n\r\n        if (permission != PackageManager.PERMISSION_GRANTED) {\r\n            Log.i(\"Permition Denied\", \"Permission to record denied\")\r\n        }\r\n        if (permission1 != PackageManager.PERMISSION_GRANTED) {\r\n            Log.i(\"Permition Denied\", \"Permission to record denied\")\r\n        }\r\n        if (permission2 != PackageManager.PERMISSION_GRANTED) {\r\n            Log.i(\"Permition Denied\", \"Permission to record denied\")\r\n        }\r\n    }\r\n\r\n\r\n    fun versionApp(){\r\n         try {\r\n            val pInfo: PackageInfo = this.getPackageManager().getPackageInfo(packageName, 0)\r\n            app_version = pInfo.versionName\r\n            LAST_VERSION=pInfo.versionName\r\n        } catch (e: PackageManager.NameNotFoundException) {\r\n            e.printStackTrace()\r\n        }\r\n    }\r\n    fun checkVersion(){\r\n\r\n        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.getAppVersion(\"face\")\r\n        call?.enqueue(object : Callback<AppVersionResponse?> {\r\n            override fun onFailure(call: Call<AppVersionResponse?>, t: Throwable) {\r\n                finish()\r\n            }\r\n\r\n            override fun onResponse(\r\n                call: Call<AppVersionResponse?>,\r\n                response: Response<AppVersionResponse?>\r\n            ) {\r\n                var resVersion = response.body()\r\n                if(resVersion!=null){\r\n                    LAST_VERSION = resVersion.version!!\r\n                    var currentVersion=app_version?.toFloat()\r\n                    var lastVersion=LAST_VERSION.toFloat()\r\n                    if(currentVersion!! < lastVersion){\r\n                        updateAplication(resVersion.url!!)\r\n                    }else{\r\n                        updateProgress()\r\n                    }\r\n                }\r\n            }\r\n\r\n        })\r\n    }\r\n    fun updateProgress(){\r\n        runnable= Runnable{\r\n            var besar = progressHorizontal.progress\r\n            progressHorizontal.progress = besar + 10\r\n            if (besar == 40) {\r\n                cekLokasi()\r\n            }else if(besar<75){\r\n                checkVersion()\r\n            }else if(besar<100){\r\n                updateProgress()\r\n            } else {\r\n                if(PrefsUtil.getInstance().getBooleanState(PrefsUtil.IS_LOGGED_IN,false))\r\n                {\r\n                    var nik = PrefsUtil.getInstance().getStringState(PrefsUtil.NIK,\"\")\r\n\r\n                    val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)\r\n                    val call = apiEndPoint.getAndroidToken(nik,\"faceId\")\r\n                    call?.enqueue(object : Callback<AndroidTokenResponse?> {\r\n                        override fun onFailure(call: Call<AndroidTokenResponse?>, t: Throwable) {\r\n                            PrefsUtil.getInstance().setBooleanState(\r\n                                PrefsUtil.IS_LOGGED_IN,false)\r\n                            intent = Intent(this@MainActivity, LoginActivity::class.java)\r\n                            startActivity(intent)\r\n                            finish()\r\n\r\n                        }\r\n\r\n                        override fun onResponse(\r\n                            call: Call<AndroidTokenResponse?>,\r\n                            response: Response<AndroidTokenResponse?>\r\n                        ) {\r\n                            var androidToken = response.body()\r\n\r\n                            if(androidToken==null){\r\n                                PrefsUtil.getInstance().setBooleanState(\r\n                                    PrefsUtil.IS_LOGGED_IN,false)\r\n                                intent = Intent(this@MainActivity, LoginActivity::class.java)\r\n\r\n                                startActivity(intent)\r\n                                finish()\r\n                            }else{\r\n//                                Toasty.info(this@MainActivity,androidToken.phoneToken.toString()).show()\r\n                                if(androidToken.phoneToken==android_token){\r\n                                var intent = Intent(this@MainActivity, IndexActivity::class.java)\r\n                                    intent.putExtra(IndexActivity.TIPE,tipe)\r\n                                    startActivity(intent)\r\n                                    finish()\r\n                                }else{\r\n                                    PrefsUtil.getInstance().setBooleanState(\r\n                                        PrefsUtil.IS_LOGGED_IN,false)\r\n                                    intent = Intent(this@MainActivity, LoginActivity::class.java)\r\n                                    startActivity(intent)\r\n                                    finish()\r\n                                }\r\n\r\n                            }\r\n\r\n                        }\r\n\r\n                    })\r\n                }\r\n                else\r\n                {\r\n                    intent = Intent(this, LoginActivity::class.java)\r\n                    startActivity(intent)\r\n                    finish()\r\n                }\r\n                handler.removeCallbacks(runnable)\r\n            }\r\n        }\r\n        handler.postDelayed(runnable,100)\r\n    }\r\n    fun androidToken(){\r\n        FirebaseMessaging.getInstance().isAutoInitEnabled = true\r\n        FirebaseInstanceId.getInstance().instanceId\r\n            .addOnCompleteListener(OnCompleteListener { task ->\r\n                if (!task.isSuccessful) {\r\n                    Toast.makeText(this@MainActivity,\"Error : $task.exception\", Toast.LENGTH_SHORT).show()\r\n\r\n                    return@OnCompleteListener\r\n                }\r\n                // Get new Instance ID token\r\n                android_token = task.result?.token\r\n            })\r\n    }\r\n    fun updateAplication(uriString:String){\r\n        AlertDialog.Builder(this)\r\n            .setTitle(\"Pambaharuan , Aplikasi Versi \"+ LAST_VERSION+\" Telah Tersedia.\")\r\n            .setPositiveButton(\"Ya, Perbaharui\",{\r\n                    _,\r\n                    _ ->\r\n                var intent = Intent(Intent.ACTION_VIEW);\r\n                intent.setData(Uri.parse(uriString));\r\n                startActivity(intent);\r\n            })\r\n            .setNegativeButton(\"Tidak, Keluar\",{\r\n                _, _ ->\r\n                finish()\r\n            })\r\n            .setOnDismissListener({_ -> finish()  })\r\n            .show()\r\n    }\r\n    fun koneksiInActive(){\r\n        AlertDialog.Builder(this)\r\n            .setTitle(\"Maaf , Anda Harus Menggunakan Jaringan Wifi PT. ABP!\")\r\n            .setPositiveButton(\"OK, Keluar\",{\r\n                    _,\r\n                    _ ->\r\n                finish()\r\n            })\r\n            .setOnDismissListener({_ -> finish()  })\r\n            .show()\r\n    }\r\n    fun cekLokasi(){\r\n        val apiEndPoint = ApiClient.getClient(this@MainActivity)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.cekLokasi()\r\n        call?.enqueue(object : Callback<AbpResponse?> {\r\n            override fun onFailure(call: Call<AbpResponse?>, t: Throwable) {\r\n                koneksiInActive()\r\n            }\r\n\r\n            override fun onResponse(call: Call<AbpResponse?>, response: Response<AbpResponse?>) {\r\n                var koneksiCek = response.body()\r\n                if(koneksiCek!=null){\r\n                    versionApp()\r\n                    updateProgress()\r\n                }else{\r\n                    koneksiInActive()\r\n                }\r\n            }\r\n\r\n        })\r\n\r\n    }\r\n\r\n    companion object{\r\n        var TIPE = \"TIPE\"\r\n        var LAST_VERSION = \"LAST_VERSION\"\r\n        var NIK = \"NIK\"\r\n        var NAMA = \"NAMA\"\r\n        var LAT = 0.0\r\n        var LNG = 0.0\r\n        var NotifNik=\"NotifNik\"\r\n        private const val DEBUG_TAG = \"NetworkStatusExample\"\r\n    }\r\n\r\n\r\n    override fun onLocationChanged(location: Location?) {\r\n        mLocation=location\r\n//        mLocationManager?.removeUpdates(this)\r\n        if (location != null) {\r\n            LAT=location.latitude\r\n        }\r\n        if (location != null) {\r\n            LNG=location.longitude\r\n        }\r\n        if (location != null) {\r\n            PrefsUtil.getInstance()\r\n                .setStringState(PrefsUtil.CURRENT_LAT,\r\n                    location.latitude.toString())\r\n        }\r\n        if (location != null) {\r\n            PrefsUtil.getInstance()\r\n                .setStringState(PrefsUtil.CURRENT_LNG,\r\n                    location.longitude.toString())\r\n        }\r\n    }\r\n\r\n    override fun onStatusChanged(provider: String?, status: Int, extras: Bundle?) {\r\n    }\r\n\r\n    override fun onProviderEnabled(provider: String?) {\r\n    }\r\n\r\n    override fun onProviderDisabled(provider: String?) {\r\n    }\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/misit/faceidchecklogptabp/MainActivity.kt	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/java/com/misit/faceidchecklogptabp/MainActivity.kt	(date 1617086889454)
@@ -34,6 +34,7 @@
 import com.misit.faceidchecklogptabp.Response.AbpResponse
 import com.misit.faceidchecklogptabp.Response.AndroidTokenResponse
 import com.misit.faceidchecklogptabp.Response.AppVersionResponse
+import com.misit.faceidchecklogptabp.Response.MainResponse.FirstLoadResponse
 import com.misit.faceidchecklogptabp.Utils.PrefsUtil
 import es.dmoral.toasty.Toasty
 import kotlinx.android.synthetic.main.activity_main.*
@@ -43,84 +44,44 @@
 
 
 class MainActivity : AppCompatActivity(), LocationListener {
+
     private var app_version : String?=""
     lateinit var runnable:Runnable
     lateinit var handler: Handler
     private var android_token : String?=null
     var tipe:String?=null
     lateinit var mAdView : AdView
-    lateinit var  mFirebaseAnalytics: FirebaseAnalytics
+//    lateinit var  mFirebaseAnalytics: FirebaseAnalytics
     var isWifiConn: Boolean = false
     lateinit var url_base:ApiClient
     private var mLocationManager : LocationManager?=null
     private var mLocation : Location?= null
+
     override fun onCreate(savedInstanceState: Bundle?) {
             super.onCreate(savedInstanceState)
             setContentView(R.layout.activity_main)
 
-        handler = Handler()
-        PrefsUtil.initInstance(this)
-//        val connMgr = getSystemService(Context.CONNECTIVITY_SERVICE) as ConnectivityManager
-
-        getGPS()
-//        var activeNetwork = connMgr.getActiveNetworkInfo()
-//        if (activeNetwork != null) {
-//            // connected to the internet
-//            if (activeNetwork.getType() == ConnectivityManager.TYPE_WIFI) {
-//                // connected to wifi
-//                isWifiConn = isWifiConn
-//            } else if (activeNetwork.getType() == ConnectivityManager.TYPE_MOBILE) {
-//                // connected to mobile data
-//            }
-//        } else {
-//            // not connected to the internet
-//        }
-
-//        var url_base = ApiClient
-//        if(PrefsUtil.getInstance().getBooleanState(PrefsUtil.IS_LOGGED_IN,false)) {
-//            if(PrefsUtil.getInstance()
-//                    .getStringState(PrefsUtil.NIK,null)=="18060207"){
-//                url_base.loadURL("https://abpjobsite.com")
-//                updateProgress()
-//            }else{
-//                url_base.loadURL("http://10.10.3.13")
-//                if(isWifiConn){
-
-//                }else{
-//                    koneksiInActive()
-//                }
-//            }
-//        }
-//        Log.d(DEBUG_TAG, "Wifi connected: $isWifiConn")
-
-//        updateProgress()
-
-        cekLokasi()
-
-        if (Build.VERSION.SDK_INT > Build.VERSION_CODES.LOLLIPOP) {
-            verifyStoragePermissions()
-        }
         if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
             window.decorView.apply {
                 systemUiVisibility = View.SYSTEM_UI_FLAG_HIDE_NAVIGATION  or View.SYSTEM_UI_FLAG_FULLSCREEN
             }
 
         }
+        handler = Handler()
+        PrefsUtil.initInstance(this)
+        getGPS()
         androidToken()
         versionApp()
 
-
         tipe = intent.getStringExtra(TIPE)
         Glide.with(this).load(R.drawable.abp).into(imageView)
 
         tvVersionCode.text=" V.${app_version}"
-
-
-
+        updateProgress()
     }
 
     override fun onResume() {
-        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this)
+//        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this)
         MobileAds.initialize(this) {}
 
         mAdView = findViewById(R.id.adView)
@@ -150,6 +111,7 @@
         }
         super.onResume()
     }
+
     fun getGPS(){
         mLocationManager = getSystemService(Context.LOCATION_SERVICE) as LocationManager
         if(Build.VERSION.SDK_INT>= Build.VERSION_CODES.LOLLIPOP){
@@ -165,8 +127,9 @@
         }
         assert(mLocationManager!=null)
         mLocationManager?.requestLocationUpdates(LocationManager.GPS_PROVIDER,
-            10,10f,this)
+            10,5f,this)
     }
+
     override fun onRequestPermissionsResult(
         requestCode: Int,
         permissions: Array<out String>,
@@ -181,25 +144,21 @@
                     ActivityCompat.checkSelfPermission(this,Manifest.permission.ACCESS_COARSE_LOCATION)
                     != PackageManager.PERMISSION_GRANTED)
                 {
-//                    Toasty.info(this@MainActivity,"B",Toasty.LENGTH_LONG).show()
                     return
                 }else
                 {
-//                    ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.ACCESS_FINE_LOCATION),1)
-//                    Toast.makeText(this,"tidak mendapatkan lokasi",Toast.LENGTH_SHORT).show()
+                    ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.ACCESS_FINE_LOCATION),1)
                 }
                 mLocationManager!!.requestLocationUpdates(LocationManager.GPS_PROVIDER,
                     10,10f,this)
-                updateProgress()
-//                PopupUtil.showLoading(this,"","Finding your location")
             }else{
                 ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.ACCESS_FINE_LOCATION),1)
-
-//                Toasty.info(this@MainActivity,"C",Toasty.LENGTH_LONG).show()
             }
         }
         super.onRequestPermissionsResult(requestCode, permissions, grantResults)
     }
+
+//    verifyStoragePermissions
     private fun verifyStoragePermissions() {
         val permission = ContextCompat.checkSelfPermission(this,
             Manifest.permission.READ_EXTERNAL_STORAGE)
@@ -209,17 +168,30 @@
             Manifest.permission.READ_PHONE_STATE)
 
         if (permission != PackageManager.PERMISSION_GRANTED) {
-            Log.i("Permition Denied", "Permission to record denied")
+            Log.i("FaceId", "READ_EXTERNAL_STORAGE Permission to record denied")
+            ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.READ_EXTERNAL_STORAGE),11)
+//            finish()
+        }else{
+            updateProgress()
         }
         if (permission1 != PackageManager.PERMISSION_GRANTED) {
-            Log.i("Permition Denied", "Permission to record denied")
+            Log.i("FaceId", "WRITE_EXTERNAL_STORAGE Permission to record denied")
+            ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.WRITE_EXTERNAL_STORAGE),12)
+//            finish()
+        }else{
+            updateProgress()
         }
         if (permission2 != PackageManager.PERMISSION_GRANTED) {
-            Log.i("Permition Denied", "Permission to record denied")
+            Log.i("FaceId", "READ_PHONE_STATE Permission to record denied")
+            ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.READ_PHONE_STATE),13)
+//            finish()
+        }else{
+            updateProgress()
         }
     }
+//verifyStoragePermissions
 
-
+//versionApp
     fun versionApp(){
          try {
             val pInfo: PackageInfo = this.getPackageManager().getPackageInfo(packageName, 0)
@@ -229,6 +201,9 @@
             e.printStackTrace()
         }
     }
+//    versionApp
+
+//    checkVersion
     fun checkVersion(){
 
         val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)
@@ -257,78 +232,69 @@
 
         })
     }
+//    checkVersion
+
     fun updateProgress(){
         runnable= Runnable{
             var besar = progressHorizontal.progress
             progressHorizontal.progress = besar + 10
-            if (besar == 40) {
-                cekLokasi()
-            }else if(besar<75){
-                checkVersion()
+            if(besar<40){
+                verifyStoragePermissions()
             }else if(besar<100){
-                updateProgress()
-            } else {
-                if(PrefsUtil.getInstance().getBooleanState(PrefsUtil.IS_LOGGED_IN,false))
-                {
-                    var nik = PrefsUtil.getInstance().getStringState(PrefsUtil.NIK,"")
-
-                    val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)
-                    val call = apiEndPoint.getAndroidToken(nik,"faceId")
-                    call?.enqueue(object : Callback<AndroidTokenResponse?> {
-                        override fun onFailure(call: Call<AndroidTokenResponse?>, t: Throwable) {
-                            PrefsUtil.getInstance().setBooleanState(
-                                PrefsUtil.IS_LOGGED_IN,false)
-                            intent = Intent(this@MainActivity, LoginActivity::class.java)
-                            startActivity(intent)
-                            finish()
-
-                        }
-
-                        override fun onResponse(
-                            call: Call<AndroidTokenResponse?>,
-                            response: Response<AndroidTokenResponse?>
-                        ) {
-                            var androidToken = response.body()
+            updateProgress()
+            } else if(besar==100){
+                handler.removeCallbacks(runnable)
+                loadFirst()
+            }
+        }
+        handler.postDelayed(runnable,100)
+    }
+
+    fun loadFirst(){
+        Log.v("FaceId",android_token)
+        if(PrefsUtil.getInstance().getBooleanState(PrefsUtil.IS_LOGGED_IN,false))
+        {
+            var nik = PrefsUtil.getInstance().getStringState(PrefsUtil.NIK,"")
+            val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)
+            val call = apiEndPoint.getAndroidToken(nik,"faceId",android_token)
+            call?.enqueue(object : Callback<FirstLoadResponse?> {
+                override fun onFailure(call: Call<FirstLoadResponse?>, t: Throwable) {
+                    Log.v("FaceId","Error: "+t.toString())
+                    koneksiInActive()
+                }
+                override fun onResponse(
+                    call: Call<FirstLoadResponse?>,
+                    response: Response<FirstLoadResponse?>
+                ) {
+                    var loadResponse = response.body()
 
-                            if(androidToken==null){
-                                PrefsUtil.getInstance().setBooleanState(
-                                    PrefsUtil.IS_LOGGED_IN,false)
-                                intent = Intent(this@MainActivity, LoginActivity::class.java)
-
-                                startActivity(intent)
-                                finish()
-                            }else{
-//                                Toasty.info(this@MainActivity,androidToken.phoneToken.toString()).show()
-                                if(androidToken.phoneToken==android_token){
-                                var intent = Intent(this@MainActivity, IndexActivity::class.java)
-                                    intent.putExtra(IndexActivity.TIPE,tipe)
-                                    startActivity(intent)
-                                    finish()
-                                }else{
-                                    PrefsUtil.getInstance().setBooleanState(
-                                        PrefsUtil.IS_LOGGED_IN,false)
-                                    intent = Intent(this@MainActivity, LoginActivity::class.java)
-                                    startActivity(intent)
-                                    finish()
-                                }
+                    if(loadResponse!=null) {
+                        Log.v("FaceId","Data"+loadResponse.toString())
+                        if (loadResponse!!.absensi == null) {
+                            loadPage("Login")
+                        } else {
+                            if (loadResponse!!.absensi!!.phoneToken == android_token) {
+                                loadPage("Index")
+                            } else {
+                                loadPage("Index")
+                            }
 
-                            }
+                        }
+                    }else{
+                        loadPage("Login")
+                    }
 
-                        }
+                }
 
-                    })
-                }
-                else
-                {
-                    intent = Intent(this, LoginActivity::class.java)
-                    startActivity(intent)
-                    finish()
-                }
-                handler.removeCallbacks(runnable)
-            }
+            })
+        }
+
+        else
+        {
+            loadPage("Login")
         }
-        handler.postDelayed(runnable,100)
     }
+//    androidToken
     fun androidToken(){
         FirebaseMessaging.getInstance().isAutoInitEnabled = true
         FirebaseInstanceId.getInstance().instanceId
@@ -342,6 +308,9 @@
                 android_token = task.result?.token
             })
     }
+//    androidToken
+
+//    updateAplication
     fun updateAplication(uriString:String){
         AlertDialog.Builder(this)
             .setTitle("Pambaharuan , Aplikasi Versi "+ LAST_VERSION+" Telah Tersedia.")
@@ -359,6 +328,9 @@
             .setOnDismissListener({_ -> finish()  })
             .show()
     }
+//    updateAplication
+
+//    koneksiInActive
     fun koneksiInActive(){
         AlertDialog.Builder(this)
             .setTitle("Maaf , Anda Harus Menggunakan Jaringan Wifi PT. ABP!")
@@ -370,27 +342,31 @@
             .setOnDismissListener({_ -> finish()  })
             .show()
     }
-    fun cekLokasi(){
-        val apiEndPoint = ApiClient.getClient(this@MainActivity)!!.create(ApiEndPoint::class.java)
-        val call = apiEndPoint.cekLokasi()
-        call?.enqueue(object : Callback<AbpResponse?> {
-            override fun onFailure(call: Call<AbpResponse?>, t: Throwable) {
-                koneksiInActive()
-            }
+//    koneksiInActive
 
-            override fun onResponse(call: Call<AbpResponse?>, response: Response<AbpResponse?>) {
-                var koneksiCek = response.body()
-                if(koneksiCek!=null){
-                    versionApp()
-                    updateProgress()
-                }else{
-                    koneksiInActive()
-                }
-            }
+
+//    loadPage
+    fun loadPage(pageName:String){
+        var intent:Intent?=null
+        if(pageName=="Login"){
+            PrefsUtil.getInstance().setBooleanState(
+                PrefsUtil.IS_LOGGED_IN, false
+            )
+            intent = Intent(this@MainActivity, LoginActivity::class.java)
+            startActivity(intent)
+            finish()
+        }else if(pageName=="Index"){
+            intent = Intent(this@MainActivity, HomeActivity::class.java)
+            intent.putExtra(IndexActivity.TIPE, tipe)
+            startActivity(intent)
+            finish()
+        }else{
+
+        }
 
-        })
 
     }
+//    loadPage
 
     companion object{
         var TIPE = "TIPE"
Index: .idea/gradle.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"GradleSettings\">\r\n    <option name=\"linkedExternalProjectsSettings\">\r\n      <GradleProjectSettings>\r\n        <option name=\"distributionType\" value=\"DEFAULT_WRAPPED\" />\r\n        <option name=\"externalProjectPath\" value=\"$PROJECT_DIR$\" />\r\n        <option name=\"modules\">\r\n          <set>\r\n            <option value=\"$PROJECT_DIR$\" />\r\n            <option value=\"$PROJECT_DIR$/app\" />\r\n          </set>\r\n        </option>\r\n        <option name=\"resolveModulePerSourceSet\" value=\"false\" />\r\n        <option name=\"testRunner\" value=\"PLATFORM\" />\r\n      </GradleProjectSettings>\r\n    </option>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/gradle.xml	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ .idea/gradle.xml	(date 1616028110496)
@@ -1,8 +1,11 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <project version="4">
+  <component name="GradleMigrationSettings" migrationVersion="1" />
   <component name="GradleSettings">
     <option name="linkedExternalProjectsSettings">
       <GradleProjectSettings>
+        <option name="delegatedBuild" value="false" />
+        <option name="testRunner" value="PLATFORM" />
         <option name="distributionType" value="DEFAULT_WRAPPED" />
         <option name="externalProjectPath" value="$PROJECT_DIR$" />
         <option name="modules">
@@ -12,7 +15,7 @@
           </set>
         </option>
         <option name="resolveModulePerSourceSet" value="false" />
-        <option name="testRunner" value="PLATFORM" />
+        <option name="useQualifiedModuleNames" value="true" />
       </GradleProjectSettings>
     </option>
   </component>
Index: app/build.gradle
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>apply plugin: 'com.android.application'\r\n\r\napply plugin: 'kotlin-android'\r\n\r\napply plugin: 'kotlin-android-extensions'\r\n\r\napply plugin: 'com.google.gms.google-services'\r\napply plugin: 'com.google.firebase.crashlytics'\r\n\r\nandroid {\r\n    compileSdkVersion 29\r\n    buildToolsVersion \"29.0.2\"\r\n    defaultConfig {\r\n        applicationId \"com.misit.faceidchecklogptabp\"\r\n        minSdkVersion 21\r\n        targetSdkVersion 29\r\n        versionCode 12\r\n        versionName \"2.2\"\r\n        testInstrumentationRunner \"androidx.test.runner.AndroidJUnitRunner\"\r\n    }\r\n    buildTypes {\r\n        release {\r\n            minifyEnabled false\r\n            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'\r\n        }\r\n    }\r\n\r\n    dataBinding {\r\n        enabled = true\r\n    }\r\n}\r\n\r\ndependencies {\r\n    implementation fileTree(dir: 'libs', include: ['*.jar'])\r\n    implementation \"org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version\"\r\n    implementation 'androidx.appcompat:appcompat:1.1.0'\r\n    implementation 'androidx.core:core-ktx:1.2.0'\r\n    implementation 'androidx.constraintlayout:constraintlayout:1.1.3'\r\n    implementation 'com.google.firebase:firebase-crashlytics:17.1.1'\r\n    testImplementation 'junit:junit:4.12'\r\n    androidTestImplementation 'androidx.test.ext:junit:1.1.1'\r\n    androidTestImplementation 'androidx.test.espresso:espresso-core:3.2.0'\r\n    implementation 'com.google.firebase:firebase-analytics:17.4.4'\r\n    implementation 'com.wonderkiln:camerakit:0.13.1'\r\n    implementation 'com.google.firebase:firebase-auth:19.3.0'\r\n    implementation 'com.google.firebase:firebase-core:17.4.4'\r\n    implementation 'com.google.firebase:firebase-ml-vision:24.0.3'\r\n    implementation 'com.github.d-max:spots-dialog:1.1@aar'\r\n\r\n    implementation 'com.google.firebase:firebase-ml-vision-face-model:20.0.1'\r\n    // Custom model\r\n    implementation 'com.google.firebase:firebase-ml-model-interpreter:22.0.3'\r\n    // AutoML model\r\n    implementation 'com.google.firebase:firebase-ml-vision-automl:18.0.5'\r\n\r\n\r\n    implementation 'com.squareup.okhttp3:logging-interceptor:3.9.0'\r\n    implementation 'com.squareup.okhttp3:okhttp-urlconnection:3.9.0'\r\n\r\n    implementation 'com.squareup.retrofit2:retrofit:2.6.0'\r\n\r\n    implementation 'com.squareup.retrofit2:converter-gson:2.3.0'\r\n\r\n    def nav_version = \"2.3.0-alpha03\"\r\n\r\n    // Kotlin\r\n    implementation \"androidx.navigation:navigation-fragment-ktx:$nav_version\"\r\n    implementation \"androidx.navigation:navigation-ui-ktx:$nav_version\"\r\n\r\n    implementation 'com.squareup.picasso:picasso:2.71828'\r\n\r\n    implementation \"androidx.recyclerview:recyclerview-selection:1.1.0-rc01\"\r\n    implementation \"androidx.recyclerview:recyclerview:1.1.0\"\r\n    implementation 'com.github.GrenderG:Toasty:1.4.2'\r\n\r\n    implementation 'com.mikhaellopez:circularimageview:4.2.0'\r\n    implementation 'joda-time:joda-time:2.9.9'\r\n    implementation 'com.github.franmontiel:PersistentCookieJar:v1.0.1'\r\n    implementation 'commons-codec:commons-codec:1.10'\r\n    implementation 'androidx.lifecycle:lifecycle-extensions:2.2.0'\r\n    implementation 'com.github.bumptech.glide:glide:4.11.0'\r\n    annotationProcessor 'com.github.bumptech.glide:compiler:4.11.0'\r\n    implementation group: 'com.camerakit', name: 'camerakit', version: '1.0.0-Snapshot', changing: true\r\n    implementation 'com.google.firebase:firebase-messaging:20.1.7'\r\n    implementation 'com.github.PhilJay:MPAndroidChart:v3.0.3'\r\n    implementation 'com.google.android.gms:play-services-ads:19.3.0'\r\n    implementation 'com.google.android.gms:play-services-maps:17.0.0'\r\n\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/build.gradle	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/build.gradle	(date 1616555185329)
@@ -28,6 +28,13 @@
     dataBinding {
         enabled = true
     }
+    compileOptions {
+        sourceCompatibility JavaVersion.VERSION_1_8
+        targetCompatibility JavaVersion.VERSION_1_8
+    }
+    kotlinOptions {
+        jvmTarget = '1.8'
+    }
 }
 
 dependencies {
@@ -44,7 +51,7 @@
     implementation 'com.wonderkiln:camerakit:0.13.1'
     implementation 'com.google.firebase:firebase-auth:19.3.0'
     implementation 'com.google.firebase:firebase-core:17.4.4'
-    implementation 'com.google.firebase:firebase-ml-vision:24.0.3'
+//    implementation 'com.google.firebase:firebase-ml-vision:24.0.3'
     implementation 'com.github.d-max:spots-dialog:1.1@aar'
 
     implementation 'com.google.firebase:firebase-ml-vision-face-model:20.0.1'
@@ -85,6 +92,7 @@
     implementation 'com.github.PhilJay:MPAndroidChart:v3.0.3'
     implementation 'com.google.android.gms:play-services-ads:19.3.0'
     implementation 'com.google.android.gms:play-services-maps:17.0.0'
+    implementation 'com.google.android.gms:play-services-location:18.0.0'
 
 
 }
Index: .idea/inspectionProfiles/Project_Default.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/inspectionProfiles/Project_Default.xml	(date 1616553767590)
+++ .idea/inspectionProfiles/Project_Default.xml	(date 1616553767590)
@@ -0,0 +1,6 @@
+<component name="InspectionProjectProfileManager">
+  <profile version="1.0">
+    <option name="myName" value="Project Default" />
+    <inspection_tool class="MarkdownUnresolvedFileReference" enabled="true" level="WARNING" enabled_by_default="true" />
+  </profile>
+</component>
\ No newline at end of file
Index: app/src/main/java/com/misit/faceidchecklogptabp/IndexActivity.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.misit.faceidchecklogptabp\r\n\r\nimport android.Manifest\r\nimport android.annotation.SuppressLint\r\nimport android.app.DatePickerDialog\r\nimport android.content.Context\r\nimport android.content.Intent\r\nimport android.content.pm.PackageInfo\r\nimport android.content.pm.PackageManager\r\nimport android.graphics.Color\r\nimport android.graphics.drawable.ColorDrawable\r\nimport android.location.Location\r\nimport android.location.LocationListener\r\nimport android.location.LocationManager\r\nimport android.os.Build\r\nimport android.os.Bundle\r\nimport android.os.Handler\r\nimport android.provider.Settings\r\nimport android.telecom.TelecomManager\r\nimport android.telephony.TelephonyManager\r\nimport android.util.Log\r\nimport android.view.LayoutInflater\r\nimport android.view.View\r\nimport android.view.ViewGroup\r\nimport android.widget.DatePicker\r\nimport android.widget.Toast\r\nimport androidx.appcompat.app.AlertDialog\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport androidx.core.app.ActivityCompat\r\nimport androidx.core.content.ContextCompat\r\nimport com.google.android.gms.ads.AdListener\r\nimport com.google.android.gms.ads.AdRequest\r\nimport com.google.android.gms.ads.AdView\r\nimport com.google.android.gms.ads.MobileAds\r\nimport com.google.android.material.textfield.TextInputEditText\r\nimport com.google.firebase.analytics.FirebaseAnalytics\r\nimport com.misit.abpenergy.api.ApiClient\r\nimport com.misit.abpenergy.api.ApiEndPoint\r\nimport com.misit.faceidchecklogptabp.Absen.*\r\nimport com.misit.faceidchecklogptabp.Chart.PersentaseActivity\r\nimport com.misit.faceidchecklogptabp.Helper.KirimMasukanActivity\r\nimport com.misit.faceidchecklogptabp.Masukan.MasukanActivity\r\nimport com.misit.faceidchecklogptabp.Response.*\r\nimport com.misit.faceidchecklogptabp.Response.Absen.DirInfoResponse\r\nimport com.misit.faceidchecklogptabp.Utils.DateUtils\r\nimport com.misit.faceidchecklogptabp.Utils.PopupUtil\r\nimport com.misit.faceidchecklogptabp.Utils.PopupUtil.updateProgress\r\nimport com.misit.faceidchecklogptabp.Utils.PrefsUtil\r\nimport es.dmoral.toasty.Toasty\r\nimport kotlinx.android.synthetic.main.activity_index.*\r\nimport kotlinx.android.synthetic.main.change_password.view.*\r\nimport kotlinx.android.synthetic.main.info_app.view.*\r\nimport kotlinx.android.synthetic.main.informasi.view.*\r\nimport kotlinx.android.synthetic.main.lupa_masuk.view.*\r\nimport kotlinx.android.synthetic.main.lupa_pulang.view.*\r\nimport org.joda.time.LocalTime\r\nimport retrofit2.Call\r\nimport retrofit2.Callback\r\nimport retrofit2.Response\r\nimport java.text.SimpleDateFormat\r\nimport java.util.*\r\n\r\n\r\nclass IndexActivity : AppCompatActivity(),View.OnClickListener, LocationListener {\r\n\r\n    lateinit var handler :Handler\r\n    private var r :Runnable?=null\r\n    lateinit var tm :TelephonyManager\r\n    private var IMEI :String?=null\r\n    private var time: Date?=null\r\n    private var csrf_token : String?=\"\"\r\n    private var jamSekarang : Int=0\r\n    private var menitSekarang : Int=0\r\n    private var detikSekarang : Int=0\r\n    var tipe :String?=null\r\n    private var app_version : String?=\"\"\r\n    private var mLocationManager : LocationManager?=null\r\n    private var mLocation : Location?= null\r\n    lateinit var viewPassword: View\r\n    lateinit var alertDialog: AlertDialog\r\n    private var mFirebaseAnalytics: FirebaseAnalytics? = null\r\n\r\n    lateinit var mAdView : AdView\r\n\r\n    @SuppressLint(\"MissingPermission\")\r\n\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        super.onCreate(savedInstanceState)\r\n        setContentView(R.layout.activity_index)\r\n        var intPerm :Int= ContextCompat.checkSelfPermission(this,Manifest.permission.READ_PHONE_STATE)\r\n        if(intPerm==PackageManager.PERMISSION_GRANTED){\r\n            tm = getSystemService(Context.TELEPHONY_SERVICE) as TelephonyManager\r\n            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {\r\n                IMEI = Settings.Secure.getString(this.getContentResolver(), Settings.Secure.ANDROID_ID)\r\n\r\n            } else {\r\n                IMEI = tm.getDeviceId()\r\n            }\r\n        }else{\r\n            ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.READ_PHONE_STATE),123)\r\n        }\r\n        getGPS()\r\n        PrefsUtil.initInstance(this)\r\n        if(PrefsUtil.getInstance().getBooleanState(PrefsUtil.IS_LOGGED_IN,true)){\r\n            NAMA = PrefsUtil.getInstance().getStringState(PrefsUtil.NAMA_LENGKAP,\"\")\r\n            NIK = PrefsUtil.getInstance().getStringState(PrefsUtil.NIK,\"\")\r\n            SHOW_ABSEN = PrefsUtil.getInstance().getStringState(PrefsUtil.SHOW_ABSEN,\"\")\r\n        }\r\n        tipe = intent.getStringExtra(TIPE)\r\n        if(tipe==\"terlambat\"){\r\n            listAbsen()\r\n        }\r\n        tvNama.text= NAMA\r\n        tvNik.text=NIK\r\n        handler= Handler()\r\n        MobileAds.initialize(this) {}\r\n\r\n//        handler.postDelayed(r,1)\r\n        showInformasi()\r\n        btn_masuk.setOnClickListener(this)\r\n        btnListAbsen.setOnClickListener(this)\r\n        btn_pulang.setOnClickListener(this)\r\n        btnLihatAbsen.setOnClickListener(this)\r\n        logOut.setOnClickListener(this)\r\n        btnSandi.setOnClickListener(this)\r\n        btnInfoApp.setOnClickListener(this)\r\n        btnChart.setOnClickListener(this)\r\n        btnLupaMasuk.setOnClickListener(this)\r\n        btnLupaPulang.setOnClickListener(this)\r\n        btnMasukan.setOnClickListener(this)\r\n        btnDaftarWajah.setOnClickListener(this)\r\n        btnMasukanList.setOnClickListener(this)\r\n\r\n    }\r\n\r\n    private fun getGPS() {\r\n\r\n            mLocationManager = getSystemService(Context.LOCATION_SERVICE) as LocationManager\r\n            if(Build.VERSION.SDK_INT>= Build.VERSION_CODES.LOLLIPOP){\r\n                if(ActivityCompat.checkSelfPermission(this,\r\n                        Manifest.permission.ACCESS_FINE_LOCATION)\r\n                    != PackageManager.PERMISSION_GRANTED ){\r\n                    PackageManager.PERMISSION_GRANTED\r\n                    ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.ACCESS_FINE_LOCATION),1)\r\n                    return\r\n                }else{\r\n                }\r\n            }\r\n            assert(mLocationManager!=null)\r\n            mLocationManager?.requestLocationUpdates(LocationManager.GPS_PROVIDER,\r\n                10,10f,this)\r\n\r\n    }\r\n\r\n    fun cekFaceID(){\r\n        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.getDirInfo(NIK!!)\r\n        call?.enqueue(object : Callback<DirInfoResponse?> {\r\n            override fun onFailure(call: Call<DirInfoResponse?>, t: Throwable) {\r\n                cekFaceID()\r\n            }\r\n            override fun onResponse(\r\n                call: Call<DirInfoResponse?>,\r\n                response: Response<DirInfoResponse?>\r\n            ) {\r\n                val faceRes = response.body()\r\n                if(faceRes!=null){\r\n                    if(faceRes.folder!!){\r\n                        btnFaceFalse.visibility=View.GONE\r\n                        btnFaceTrue.visibility=View.VISIBLE\r\n                        PopupUtil.dismissDialog()\r\n                        loadAbsen()\r\n                        btnDaftarWajah.visibility=View.GONE\r\n                    }else{\r\n                        btnFaceFalse.visibility=View.VISIBLE\r\n                        btnFaceTrue.visibility=View.GONE\r\n                        PopupUtil.dismissDialog()\r\n                        val intent = Intent(this@IndexActivity,DaftarWajahActivity::class.java)\r\n                        startActivity(intent)\r\n                    }\r\n                }\r\n            }\r\n        })\r\n        PopupUtil.dismissDialog()\r\n    }\r\n    fun listAbsen(){\r\n        val intent= Intent(this, ListAbsenActivity::class.java)\r\n        intent.putExtra(ListAbsenActivity.NIK, NIK)\r\n\r\n        startActivity(intent)\r\n    }\r\n    override fun onResume() {\r\n        cekLokasi()\r\n\r\n        r = Runnable{\r\n            doJob()\r\n        }\r\n        MobileAds.initialize(this) {}\r\n\r\n        mAdView = findViewById(R.id.adViewIndex)\r\n        val adRequest = AdRequest.Builder().build()\r\n        mAdView.loadAd(adRequest)\r\n\r\n        mAdView.adListener = object: AdListener() {\r\n            override fun onAdLoaded() {\r\n                // Code to be executed when an ad finishes loading.\r\n            }\r\n\r\n            override fun onAdFailedToLoad(errorCode : Int) {\r\n                Log.d(\"errorCode\",errorCode.toString())\r\n                // Code to be executed when an ad request fails.\r\n            }\r\n\r\n            override fun onAdOpened() {\r\n                // Code to be executed when an ad opens an overlay that\r\n                // covers the screen.\r\n            }\r\n\r\n            override fun onAdClicked() {\r\n                // Code to be executed when the user clicks on an ad.\r\n            }\r\n\r\n            override fun onAdLeftApplication() {\r\n                // Code to be executed when the user has left the app.\r\n            }\r\n\r\n            override fun onAdClosed() {\r\n                // Code to be executed when the user is about to return\r\n                // to the app after tapping on an ad.\r\n            }\r\n        }\r\n\r\n        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);\r\n\r\n        PopupUtil.showProgress(this,\"Loading\",\"Update Data Dari Server!!\")\r\n        cekFaceID()\r\n\r\n        if(SHOW_ABSEN==\"1\"){\r\n            presentasiPengguna()\r\n            btnListAbsen.visibility=View.VISIBLE\r\n            btnChart.visibility=View.VISIBLE\r\n            btnMasukanList.visibility=View.VISIBLE\r\n        }else{\r\n            btnChart.visibility=View.GONE\r\n            btnListAbsen.visibility=View.GONE\r\n            btnMasukanList.visibility=View.GONE\r\n        }\r\n        super.onResume()\r\n    }\r\n\r\n    override fun onPause() {\r\n        handler.removeCallbacks(r)\r\n        super.onPause()\r\n    }\r\n    fun loadAbsen(){\r\n        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.lastAbsen(NIK!!)\r\n        call?.enqueue(object : Callback<LastAbsenResponse?> {\r\n            override fun onFailure(call: Call<LastAbsenResponse?>, t: Throwable) {\r\n\r\n            }\r\n            override fun onResponse(\r\n                call: Call<LastAbsenResponse?>,\r\n                response: Response<LastAbsenResponse?>\r\n            ) {\r\n\r\n                val lastRes = response.body()\r\n                if(lastRes!=null){\r\n                    if(lastRes?.lastNew!=null){\r\n//                        Toasty.info(this@IndexActivity,lastRes?.lastAbsen).show()\r\n                        if(lastRes.lastNew==\"Masuk\"){\r\n                            chkMasuk.isChecked=true\r\n                            chkPulang.isChecked=false\r\n                            btn_pulang.isEnabled=true\r\n                            btn_masuk.isEnabled=true\r\n                            btn_masuk.visibility=View.GONE\r\n                            btn_pulang.visibility=View.VISIBLE\r\n                        }else\r\n                        if(lastRes.lastNew==\"Pulang\"){\r\n                            chkMasuk.isChecked=true\r\n                            chkPulang.isChecked=true\r\n                            btn_pulang.isEnabled=true\r\n                            btn_masuk.isEnabled=true\r\n                            btn_masuk.visibility=View.VISIBLE\r\n                            btn_pulang.visibility=View.GONE\r\n                        }else{\r\n                            chkMasuk.isChecked=false\r\n                            chkPulang.isChecked=false\r\n                            btn_masuk.isEnabled=true\r\n                            btn_pulang.isEnabled=true\r\n                            btn_masuk.visibility=View.VISIBLE\r\n                            btn_pulang.visibility=View.GONE\r\n                        }\r\n                        if(btn_masuk.isEnabled==false){\r\n//                            Toasty.info(this@IndexActivity,\"Anda Sudah Melakukan Absen Masuk Dan Pulang!\",Toasty.LENGTH_SHORT).show()\r\n                        }\r\n                    }else{\r\n                        chkMasuk.isChecked=false\r\n                        chkPulang.isChecked=false\r\n                        btn_masuk.isEnabled=true\r\n                        btn_pulang.isEnabled=true\r\n                        btn_masuk.visibility=View.VISIBLE\r\n                        btn_pulang.visibility=View.GONE\r\n                    }\r\n                }\r\n            }\r\n\r\n        })\r\n    }\r\n    private fun logout() {\r\n        AlertDialog.Builder(this)\r\n            .setTitle(\"Confirmation\")\r\n            .setPositiveButton(\"OK , Sign Out\",{\r\n                    dialog,\r\n                    which ->\r\n                if(PrefsUtil.getInstance().getBooleanState(\r\n                        PrefsUtil.IS_LOGGED_IN,true)){\r\n                    PrefsUtil.getInstance().setBooleanState(\r\n                        PrefsUtil.IS_LOGGED_IN,false)\r\n                    PrefsUtil.getInstance().setStringState(\r\n                        PrefsUtil.NAMA_LENGKAP,null)\r\n                    PrefsUtil.getInstance().setStringState(\r\n                        PrefsUtil.NIK,null)\r\n                    val intent = Intent(this,LoginActivity::class.java)\r\n                    startActivity(intent)\r\n                    finish()\r\n                }\r\n            })\r\n            .setNegativeButton(\"Cancel\",\r\n                {\r\n                        dialog,\r\n                        which ->\r\n                    dialog.dismiss()\r\n                })\r\n            .show()\r\n    }\r\n    private fun showInformasi() {\r\n        MobileAds.initialize(this) {}\r\n        viewPassword = LayoutInflater.from(this@IndexActivity).inflate(R.layout.informasi,null)\r\n        if(viewPassword.parent!=null){\r\n            (viewPassword.parent as ViewGroup).removeView(viewPassword)\r\n        }\r\n        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);\r\n\r\n        mAdView = viewPassword.adViewAPPINFORMASI\r\n        val adRequest = AdRequest.Builder().build()\r\n        mAdView.loadAd(adRequest)\r\n        viewPassword.btnInformasiOK.setOnClickListener{\r\n            alertDialog.dismiss()\r\n        }\r\n        alertDialog = AlertDialog.Builder(this@IndexActivity)\r\n            .setView(viewPassword).create()\r\n        alertDialog.window?.setBackgroundDrawable(ColorDrawable(Color.TRANSPARENT))\r\n\r\n        alertDialog.show()\r\n    }\r\n    fun doJob() {\r\n        if(detikSekarang!!.toInt()>=59){\r\n            if(menitSekarang!!.toInt()>=59){\r\n                if(jamSekarang!!.toInt()>=23){\r\n                    jamSekarang==0\r\n                    menitSekarang=0\r\n                    detikSekarang=0\r\n                }else{\r\n                    jamSekarang=jamSekarang+1\r\n                    menitSekarang=0\r\n                    detikSekarang=0\r\n                }\r\n            }else{\r\n                menitSekarang=menitSekarang+1\r\n                detikSekarang=0\r\n            }\r\n        }else{\r\n            detikSekarang=detikSekarang+1\r\n        }\r\n        if(jamSekarang<10) {\r\n            if(menitSekarang<10){\r\n                if(detikSekarang<10){\r\n                    tvJam.text = \"Pukul : 0\" + \"${jamSekarang} : 0\" + \"${menitSekarang} : 0\" + \"${detikSekarang}\"\r\n                }else{\r\n                    tvJam.text = \"Pukul : 0\" + \"${jamSekarang} : 0\" + \"${menitSekarang} : ${detikSekarang}\"\r\n                }\r\n            }else{\r\n                if(detikSekarang<10){\r\n                    tvJam.text = \"Pukul : 0\" + \"${jamSekarang} : ${menitSekarang} : 0\" + \"${detikSekarang}\"\r\n                }else{\r\n                    tvJam.text = \"Pukul : 0\" + \"${jamSekarang} : ${menitSekarang} : ${detikSekarang}\"\r\n                }\r\n            }\r\n        }else{\r\n            if(menitSekarang<10){\r\n                if(detikSekarang<10){\r\n                    tvJam.text = \"Pukul : ${jamSekarang} : 0\" + \"${menitSekarang} : 0\" + \"${detikSekarang}\"\r\n                }else{\r\n                    tvJam.text = \"Pukul : ${jamSekarang} : 0\" + \"${menitSekarang} : ${detikSekarang}\"\r\n                }\r\n            }else{\r\n                if(detikSekarang<10){\r\n                    tvJam.text = \"Pukul : ${jamSekarang} : ${menitSekarang} : 0\" + \"${detikSekarang}\"\r\n                }else{\r\n                    tvJam.text =  \"Pukul : ${jamSekarang} : ${menitSekarang} : ${detikSekarang}\"\r\n                }\r\n            }\r\n        }\r\n        handler.postDelayed(r,1000)\r\n    }\r\n    fun cekLokasi(){\r\n        val apiEndPoint = ApiClient.getClient(this@IndexActivity)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.cekLokasi()\r\n        call?.enqueue(object : Callback<AbpResponse?> {\r\n            override fun onFailure(call: Call<AbpResponse?>, t: Throwable) {\r\n                koneksiInActive()\r\n            }\r\n\r\n            override fun onResponse(call: Call<AbpResponse?>, response: Response<AbpResponse?>) {\r\n                var koneksiCek = response.body()\r\n                if(koneksiCek!=null){\r\n                    if(koneksiCek.jam!=null)\r\n                        jamSekarang = koneksiCek.jam!!.toInt()\r\n                        menitSekarang = koneksiCek.menit!!.toInt()\r\n                        detikSekarang = koneksiCek.detik!!.toInt()\r\n                        doJob()\r\n//                    Log.d(\"JAMNYA\", \"${koneksiCek.jam}\")\r\n                }else{\r\n                    koneksiInActive()\r\n                }\r\n            }\r\n        })\r\n\r\n    }\r\n    fun koneksiInActive(){\r\n        AlertDialog.Builder(this)\r\n            .setTitle(\"Maaf , Anda Harus Menggunakan Jaringan Wifi PT. ABP!\")\r\n            .setPositiveButton(\"OK, Keluar\",{\r\n                    _,\r\n                    _ ->\r\n                finish()\r\n            })\r\n            .setOnDismissListener({_ -> finish()  })\r\n            .show()\r\n    }\r\n    fun showDialogOption(nik:String,nama: String){\r\n        viewPassword = LayoutInflater.from(this@IndexActivity).inflate(R.layout.change_password,null)\r\n        if(viewPassword.parent!=null){\r\n            (viewPassword.parent as ViewGroup).removeView(viewPassword)\r\n        }\r\n        viewPassword.tvCHname.text=\"Nama: ${nama}\"\r\n        viewPassword.tvCHnik.text=\"NIK : ${nik}\"\r\n        viewPassword.btnUpdateSandi.setOnClickListener {\r\n            val oldPass = viewPassword.oldInChPassword.text\r\n            val newPass = viewPassword.InChPassword.text\r\n            updatePassword(nik,oldPass.toString(),newPass.toString())\r\n        }\r\n        alertDialog = AlertDialog.Builder(this@IndexActivity)\r\n            .setView(viewPassword).create()\r\n        alertDialog.window?.setBackgroundDrawable(ColorDrawable(Color.TRANSPARENT))\r\n\r\n        alertDialog.show()\r\n    }\r\n    private fun getToken() {\r\n        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.getToken(\"csrf_token\")\r\n        call?.enqueue(object : Callback<CsrfTokenResponse> {\r\n            override fun onFailure(call: Call<CsrfTokenResponse>, t: Throwable) {\r\n                Toast.makeText(this@IndexActivity,\"Error : $t\", Toast.LENGTH_SHORT).show()\r\n            }\r\n            override fun onResponse(\r\n                call: Call<CsrfTokenResponse>,\r\n                response: Response<CsrfTokenResponse>\r\n            ) {\r\n                csrf_token = response.body()?.csrfToken\r\n            }\r\n        })\r\n    }\r\n    fun updatePassword(nik:String,oldPass:String,newPass:String){\r\n        PopupUtil.showLoading(this@IndexActivity,\"Update Password\",\"Please Wait\")\r\n        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.updatePassword(nik,oldPass,newPass,csrf_token)\r\n        call?.enqueue(object : Callback<LoginResponse?> {\r\n            override fun onFailure(call: Call<LoginResponse?>, t: Throwable) {\r\n                Toasty.error(this@IndexActivity,\"Error While Update...\",Toasty.LENGTH_SHORT).show()\r\n                PopupUtil.dismissDialog()\r\n            }\r\n            override fun onResponse(\r\n                call: Call<LoginResponse?>,\r\n                response: Response<LoginResponse?>\r\n            ) {\r\n                var usrResponse =response.body()\r\n                if (usrResponse!=null) {\r\n                    if (usrResponse.success!!) {\r\n                        Toasty.success(this@IndexActivity,\"Update Password Success...\",Toasty.LENGTH_SHORT).show()\r\n                    }else{\r\n                        Toasty.error(this@IndexActivity,\"Update Password Failed...\",Toasty.LENGTH_SHORT).show()\r\n                    }\r\n                }else{\r\n                    Toasty.error(this@IndexActivity,\"Update Password Failed...\",Toasty.LENGTH_SHORT).show()\r\n                }\r\n                PopupUtil.dismissDialog()\r\n                alertDialog.dismiss()\r\n            }\r\n        })\r\n    }\r\n    companion object{\r\n        var TIPE = \"TIPE\"\r\n        var PENGGUNA = \"PENGGUNA\"\r\n        var KARYAWAN = \"KARYAWAN\"\r\n        var NIK = \"NIK\"\r\n        var NAMA = \"NAMA\"\r\n        var SHOW_ABSEN=\"SHOW_ABSEN\"\r\n        var PERSENTASE = \"PERSENTASE\"\r\n        var LAT = 0.0\r\n        var LNG = 0.0\r\n    }\r\n\r\n    override fun onClick(v: View?) {\r\n        if(v!!.id==R.id.btn_masuk){\r\n                val intent= Intent(this, MasukActivity::class.java)\r\n                intent.putExtra(MasukActivity.NIK, NIK)\r\n                startActivity(intent)\r\n        }\r\n        else if(v!!.id==R.id.btnSandi){\r\n            getToken()\r\n            showDialogOption(NIK, NAMA)\r\n        }\r\n        else if(v!!.id==R.id.logOut){\r\n            logout()\r\n        }\r\n        else if(v!!.id==R.id.btnLihatAbsen){\r\n            val intent= Intent(this, LihatAbsenActivity::class.java)\r\n            intent.putExtra(LihatAbsenActivity.NIK, NIK)\r\n            startActivity(intent)\r\n        }\r\n        else if(v!!.id==R.id.btn_pulang){\r\n            val intent= Intent(this, PulangActivity::class.java)\r\n            intent.putExtra(PulangActivity.NIK, NIK)\r\n            startActivity(intent)\r\n        }\r\n        else if(v!!.id==R.id.btnListAbsen){\r\n            listAbsen()\r\n        }\r\n        else if(v!!.id==R.id.btnInfoApp){\r\n            showDialogInfoApp()\r\n        }\r\n        else if(v!!.id==R.id.btnChart){\r\n            val intent= Intent(this, PersentaseActivity::class.java)\r\n            intent.putExtra(PersentaseActivity.KARYAWAN, KARYAWAN)\r\n            intent.putExtra(PersentaseActivity.PENGGUNA, PENGGUNA)\r\n            intent.putExtra(PersentaseActivity.PERSENTASE, PERSENTASE)\r\n            startActivity(intent)\r\n        }\r\n        else if(v!!.id==R.id.btnLupaMasuk){\r\n            showDialogLupaMasuk()\r\n\r\n        }\r\n        else if(v!!.id==R.id.btnLupaPulang){\r\n//            val intent= Intent(this, LupaPulangActivity::class.java)\r\n//            intent.putExtra(LupaPulangActivity.NIK, NIK)\r\n//            startActivity(intent)\r\n            showDialogLupaPulang()\r\n        }else if(v!!.id==R.id.btnMasukan){\r\n            kirimMasukan()\r\n        }else if(v!!.id==R.id.btnDaftarWajah){\r\n            val intent = Intent(this@IndexActivity,DaftarWajahActivity::class.java)\r\n            startActivity(intent)\r\n        }else if(v!!.id==R.id.btnMasukanList){\r\n            val intent = Intent(this@IndexActivity,MasukanActivity::class.java)\r\n            startActivity(intent)\r\n        }\r\n    }\r\n\r\n    fun showDialogInfoApp(){\r\n\r\n        MobileAds.initialize(this) {}\r\n\r\n\r\n        versionApp()\r\n        viewPassword = LayoutInflater.from(this@IndexActivity).inflate(R.layout.info_app,null)\r\n        if(viewPassword.parent!=null){\r\n            (viewPassword.parent as ViewGroup).removeView(viewPassword)\r\n        }\r\n        viewPassword.tvVersionCode.text = \"Version \"+app_version\r\n        if(IMEI!=null){\r\n            viewPassword.phoneIMEI.text = \"IMEI :\"+IMEI\r\n        }else{\r\n            viewPassword.phoneIMEI.text = \"IMEI: MISSING\"\r\n        }\r\n        mAdView = viewPassword.adViewAPPINFO\r\n        val adRequest = AdRequest.Builder().build()\r\n        mAdView.loadAd(adRequest)\r\n        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);\r\n\r\n        alertDialog = AlertDialog.Builder(this@IndexActivity)\r\n            .setView(viewPassword).create()\r\n        alertDialog.window?.setBackgroundDrawable(ColorDrawable(Color.TRANSPARENT))\r\n\r\n        alertDialog.show()\r\n    }\r\n\r\n    fun showDialogLupaMasuk(){\r\n        MobileAds.initialize(this) {}\r\n\r\n        viewPassword = LayoutInflater.from(this@IndexActivity).inflate(R.layout.lupa_masuk,null)\r\n        if(viewPassword.parent!=null){\r\n            (viewPassword.parent as ViewGroup).removeView(viewPassword)\r\n        }\r\n        viewPassword.tglLupaAbsenMasuk.setOnClickListener{\r\n            showDialogTgl(viewPassword.tglLupaAbsenMasuk)\r\n        }\r\n        viewPassword.btnLupaAbsenMasuk.setOnClickListener{\r\n            if(viewPassword.tglLupaAbsenMasuk.text!!.isNotEmpty()){\r\n                val intent= Intent(this, LupaMasukActivity::class.java)\r\n                intent.putExtra(LupaMasukActivity.TGL_LUPA_ABSEN, viewPassword.tglLupaAbsenMasuk.text.toString())\r\n                startActivity(intent)\r\n\r\n                alertDialog.dismiss()\r\n            }else{\r\n                viewPassword.tilTanggalLupaMasuk.error=\"Tidak Boleh Kosong\"\r\n            }\r\n        }\r\n\r\n        viewPassword.btnBatalLupaAbsenMasuk.setOnClickListener{\r\n            alertDialog.dismiss()\r\n        }\r\n        mAdView = viewPassword.adViewLMasuk\r\n        val adRequest = AdRequest.Builder().build()\r\n        mAdView.loadAd(adRequest)\r\n        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);\r\n        alertDialog = AlertDialog.Builder(this@IndexActivity)\r\n            .setView(viewPassword).create()\r\n        alertDialog.window?.setBackgroundDrawable(ColorDrawable(Color.TRANSPARENT))\r\n        alertDialog.show()\r\n    }\r\n\r\n    fun showDialogLupaPulang(){\r\n        MobileAds.initialize(this) {}\r\n\r\n\r\n        viewPassword = LayoutInflater.from(this@IndexActivity).inflate(R.layout.lupa_pulang,null)\r\n        if(viewPassword.parent!=null){\r\n            (viewPassword.parent as ViewGroup).removeView(viewPassword)\r\n        }\r\n        viewPassword.tglLupaAbsenPulang.setOnClickListener{\r\n            showDialogTgl(viewPassword.tglLupaAbsenPulang)\r\n        }\r\n        viewPassword.btnLupaAbsenPulang.setOnClickListener{\r\n            if(viewPassword.tglLupaAbsenPulang.text!!.isNotEmpty()){\r\n                val intent= Intent(this, LupaPulangActivity::class.java)\r\n                intent.putExtra(LupaPulangActivity.TGL_LUPA_ABSEN, viewPassword.tglLupaAbsenPulang.text.toString())\r\n                startActivity(intent)\r\n                alertDialog.dismiss()\r\n            }else{\r\n                viewPassword.tilTanggalLupaPulang.error=\"Tidak Boleh Kosong\"\r\n            }\r\n        }\r\n\r\n        viewPassword.btnBatalLupaAbsenPulang.setOnClickListener{\r\n            alertDialog.dismiss()\r\n        }\r\n        mAdView = viewPassword.adViewLPulang\r\n        val adRequest = AdRequest.Builder().build()\r\n        mAdView.loadAd(adRequest)\r\n        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);\r\n        alertDialog = AlertDialog.Builder(this@IndexActivity)\r\n            .setView(viewPassword).create()\r\n        alertDialog.window?.setBackgroundDrawable(ColorDrawable(Color.TRANSPARENT))\r\n        alertDialog.show()\r\n    }\r\n    fun showDialogTgl(inTgl: TextInputEditText){\r\n        val now = Calendar.getInstance()\r\n        val datePicker  = DatePickerDialog.OnDateSetListener{\r\n                view: DatePicker?, year: Int, month: Int, dayOfMonth: Int ->\r\n            now.set(Calendar.YEAR,year)\r\n            now.set(Calendar.MONTH,month)\r\n            now.set(Calendar.DAY_OF_MONTH,dayOfMonth)\r\n            inTgl.setText(SimpleDateFormat(\"dd MMMM yyyy\").format(now.time))\r\n        }\r\n\r\n        DatePickerDialog(this,\r\n            datePicker,\r\n            now.get(Calendar.YEAR),\r\n            now.get(Calendar.MONTH),\r\n            now.get(Calendar.DAY_OF_MONTH)\r\n        ).show()\r\n    }\r\n    fun versionApp(){\r\n        Use@ try {\r\n            val pInfo: PackageInfo = this.getPackageManager().getPackageInfo(packageName, 0)\r\n            app_version = pInfo.versionName\r\n        } catch (e: PackageManager.NameNotFoundException) {\r\n            e.printStackTrace()\r\n        }\r\n    }\r\n\r\n    override fun onBackPressed() {\r\n        AlertDialog.Builder(this)\r\n            .setTitle(\"Kirim Masukan?\")\r\n            .setPositiveButton(\"Ya\",{\r\n                    dialog,\r\n                    which ->\r\n                kirimMasukan()\r\n                finish()\r\n            })\r\n            .setNegativeButton(\"Tidak\",\r\n                {\r\n                        dialog,\r\n                        which ->\r\n                    finish()\r\n                })\r\n            .show()\r\n        //super.onBackPressed()\r\n    }\r\n\r\n    private fun kirimMasukan() {\r\n        val intent = Intent(this,KirimMasukanActivity::class.java)\r\n        startActivity(intent)\r\n    }\r\n\r\n    fun presentasiPengguna(){\r\n        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.getPresentasiPengguna()\r\n        call?.enqueue(object : Callback<PresentasiPenggunaResponse?> {\r\n            override fun onFailure(call: Call<PresentasiPenggunaResponse?>, t: Throwable) {\r\n            }\r\n\r\n            override fun onResponse(\r\n                call: Call<PresentasiPenggunaResponse?>,\r\n                response: Response<PresentasiPenggunaResponse?>\r\n            ) {\r\n                var  res = response.body()\r\n                if(res!=null){\r\n                    PENGGUNA = res.jumlah_pengguna!!.toString()\r\n                    KARYAWAN = res.jumlah_karyawan!!.toString()\r\n                    PERSENTASE = \"%.2f\".format(res.persentasi!!.toFloat())\r\n                    btnChart.setText(\"${PERSENTASE} % Pengguna Aktif\")\r\n                    var s = \"${res.persentasi} - ${res.jumlah_pengguna} - ${res.jumlah_karyawan}\";\r\n//                    Toasty.info(this@IndexActivity,s).show()\r\n                }\r\n            }\r\n        })\r\n\r\n    }\r\n\r\n    override fun onLocationChanged(location: Location?) {\r\n        mLocation=location\r\n//        mLocationManager?.removeUpdates(this)\r\n        if (location != null) {\r\n            LAT=location.latitude\r\n        }\r\n        if (location != null) {\r\n            LNG=location.longitude\r\n        }\r\n        if (location != null) {\r\n            PrefsUtil.getInstance()\r\n                .setStringState(PrefsUtil.CURRENT_LAT,\r\n                    location.latitude.toString())\r\n        }\r\n        if (location != null) {\r\n            PrefsUtil.getInstance()\r\n                .setStringState(PrefsUtil.CURRENT_LNG,\r\n                    location.longitude.toString())\r\n        }\r\n    }\r\n\r\n    override fun onStatusChanged(provider: String?, status: Int, extras: Bundle?) {\r\n    }\r\n\r\n    override fun onProviderEnabled(provider: String?) {\r\n    }\r\n\r\n    override fun onProviderDisabled(provider: String?) {\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/misit/faceidchecklogptabp/IndexActivity.kt	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/java/com/misit/faceidchecklogptabp/IndexActivity.kt	(date 1617086333597)
@@ -78,12 +78,12 @@
     private var mLocation : Location?= null
     lateinit var viewPassword: View
     lateinit var alertDialog: AlertDialog
-    private var mFirebaseAnalytics: FirebaseAnalytics? = null
+//    private var mFirebaseAnalytics: FirebaseAnalytics? = null
 
     lateinit var mAdView : AdView
 
+
     @SuppressLint("MissingPermission")
-
     override fun onCreate(savedInstanceState: Bundle?) {
         super.onCreate(savedInstanceState)
         setContentView(R.layout.activity_index)
@@ -191,7 +191,6 @@
     }
     override fun onResume() {
         cekLokasi()
-
         r = Runnable{
             doJob()
         }
@@ -230,7 +229,7 @@
             }
         }
 
-        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
+//        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
 
         PopupUtil.showProgress(this,"Loading","Update Data Dari Server!!")
         cekFaceID()
@@ -340,7 +339,7 @@
         if(viewPassword.parent!=null){
             (viewPassword.parent as ViewGroup).removeView(viewPassword)
         }
-        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
+//        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
 
         mAdView = viewPassword.adViewAPPINFORMASI
         val adRequest = AdRequest.Builder().build()
@@ -405,6 +404,8 @@
         handler.postDelayed(r,1000)
     }
     fun cekLokasi(){
+        handler.removeCallbacks(r)
+
         val apiEndPoint = ApiClient.getClient(this@IndexActivity)!!.create(ApiEndPoint::class.java)
         val call = apiEndPoint.cekLokasi()
         call?.enqueue(object : Callback<AbpResponse?> {
@@ -587,7 +588,7 @@
         mAdView = viewPassword.adViewAPPINFO
         val adRequest = AdRequest.Builder().build()
         mAdView.loadAd(adRequest)
-        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
+//        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
 
         alertDialog = AlertDialog.Builder(this@IndexActivity)
             .setView(viewPassword).create()
@@ -624,7 +625,7 @@
         mAdView = viewPassword.adViewLMasuk
         val adRequest = AdRequest.Builder().build()
         mAdView.loadAd(adRequest)
-        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
+//        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
         alertDialog = AlertDialog.Builder(this@IndexActivity)
             .setView(viewPassword).create()
         alertDialog.window?.setBackgroundDrawable(ColorDrawable(Color.TRANSPARENT))
@@ -659,7 +660,7 @@
         mAdView = viewPassword.adViewLPulang
         val adRequest = AdRequest.Builder().build()
         mAdView.loadAd(adRequest)
-        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
+//        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
         alertDialog = AlertDialog.Builder(this@IndexActivity)
             .setView(viewPassword).create()
         alertDialog.window?.setBackgroundDrawable(ColorDrawable(Color.TRANSPARENT))
Index: .idea/codeStyles/Project.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><component name=\"ProjectCodeStyleConfiguration\">\r\n  <code_scheme name=\"Project\" version=\"173\">\r\n    <AndroidXmlCodeStyleSettings>\r\n      <option name=\"ARRANGEMENT_SETTINGS_MIGRATED_TO_191\" value=\"true\" />\r\n    </AndroidXmlCodeStyleSettings>\r\n    <JetCodeStyleSettings>\r\n      <option name=\"CODE_STYLE_DEFAULTS\" value=\"KOTLIN_OFFICIAL\" />\r\n    </JetCodeStyleSettings>\r\n    <codeStyleSettings language=\"XML\">\r\n      <indentOptions>\r\n        <option name=\"CONTINUATION_INDENT_SIZE\" value=\"4\" />\r\n      </indentOptions>\r\n      <arrangement>\r\n        <rules>\r\n          <section>\r\n            <rule>\r\n              <match>\r\n                <AND>\r\n                  <NAME>xmlns:android</NAME>\r\n                  <XML_ATTRIBUTE />\r\n                  <XML_NAMESPACE>^$</XML_NAMESPACE>\r\n                </AND>\r\n              </match>\r\n            </rule>\r\n          </section>\r\n          <section>\r\n            <rule>\r\n              <match>\r\n                <AND>\r\n                  <NAME>xmlns:.*</NAME>\r\n                  <XML_ATTRIBUTE />\r\n                  <XML_NAMESPACE>^$</XML_NAMESPACE>\r\n                </AND>\r\n              </match>\r\n              <order>BY_NAME</order>\r\n            </rule>\r\n          </section>\r\n          <section>\r\n            <rule>\r\n              <match>\r\n                <AND>\r\n                  <NAME>.*:id</NAME>\r\n                  <XML_ATTRIBUTE />\r\n                  <XML_NAMESPACE>http://schemas.android.com/apk/res/android</XML_NAMESPACE>\r\n                </AND>\r\n              </match>\r\n            </rule>\r\n          </section>\r\n          <section>\r\n            <rule>\r\n              <match>\r\n                <AND>\r\n                  <NAME>.*:name</NAME>\r\n                  <XML_ATTRIBUTE />\r\n                  <XML_NAMESPACE>http://schemas.android.com/apk/res/android</XML_NAMESPACE>\r\n                </AND>\r\n              </match>\r\n            </rule>\r\n          </section>\r\n          <section>\r\n            <rule>\r\n              <match>\r\n                <AND>\r\n                  <NAME>name</NAME>\r\n                  <XML_ATTRIBUTE />\r\n                  <XML_NAMESPACE>^$</XML_NAMESPACE>\r\n                </AND>\r\n              </match>\r\n            </rule>\r\n          </section>\r\n          <section>\r\n            <rule>\r\n              <match>\r\n                <AND>\r\n                  <NAME>style</NAME>\r\n                  <XML_ATTRIBUTE />\r\n                  <XML_NAMESPACE>^$</XML_NAMESPACE>\r\n                </AND>\r\n              </match>\r\n            </rule>\r\n          </section>\r\n          <section>\r\n            <rule>\r\n              <match>\r\n                <AND>\r\n                  <NAME>.*</NAME>\r\n                  <XML_ATTRIBUTE />\r\n                  <XML_NAMESPACE>^$</XML_NAMESPACE>\r\n                </AND>\r\n              </match>\r\n              <order>BY_NAME</order>\r\n            </rule>\r\n          </section>\r\n          <section>\r\n            <rule>\r\n              <match>\r\n                <AND>\r\n                  <NAME>.*</NAME>\r\n                  <XML_ATTRIBUTE />\r\n                  <XML_NAMESPACE>http://schemas.android.com/apk/res/android</XML_NAMESPACE>\r\n                </AND>\r\n              </match>\r\n              <order>ANDROID_ATTRIBUTE_ORDER</order>\r\n            </rule>\r\n          </section>\r\n          <section>\r\n            <rule>\r\n              <match>\r\n                <AND>\r\n                  <NAME>.*</NAME>\r\n                  <XML_ATTRIBUTE />\r\n                  <XML_NAMESPACE>.*</XML_NAMESPACE>\r\n                </AND>\r\n              </match>\r\n              <order>BY_NAME</order>\r\n            </rule>\r\n          </section>\r\n        </rules>\r\n      </arrangement>\r\n    </codeStyleSettings>\r\n    <codeStyleSettings language=\"kotlin\">\r\n      <option name=\"CODE_STYLE_DEFAULTS\" value=\"KOTLIN_OFFICIAL\" />\r\n    </codeStyleSettings>\r\n  </code_scheme>\r\n</component>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/codeStyles/Project.xml	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ .idea/codeStyles/Project.xml	(date 1616554511124)
@@ -1,8 +1,5 @@
 <component name="ProjectCodeStyleConfiguration">
   <code_scheme name="Project" version="173">
-    <AndroidXmlCodeStyleSettings>
-      <option name="ARRANGEMENT_SETTINGS_MIGRATED_TO_191" value="true" />
-    </AndroidXmlCodeStyleSettings>
     <JetCodeStyleSettings>
       <option name="CODE_STYLE_DEFAULTS" value="KOTLIN_OFFICIAL" />
     </JetCodeStyleSettings>
Index: app/src/main/java/com/misit/faceidchecklogptabp/HomeActivity.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/misit/faceidchecklogptabp/HomeActivity.kt	(date 1617087146155)
+++ app/src/main/java/com/misit/faceidchecklogptabp/HomeActivity.kt	(date 1617087146155)
@@ -0,0 +1,358 @@
+package com.misit.faceidchecklogptabp
+
+import android.Manifest
+import android.annotation.SuppressLint
+import android.content.Context
+import android.content.Intent
+import android.content.pm.PackageManager
+import android.location.Location
+import android.location.LocationListener
+import android.location.LocationManager
+import android.os.Build
+import androidx.appcompat.app.AppCompatActivity
+import android.os.Bundle
+import android.os.Handler
+import android.provider.Settings
+import android.telephony.TelephonyManager
+import android.util.Log
+import android.view.View
+import android.widget.Toast
+import androidx.appcompat.app.AlertDialog
+import androidx.core.app.ActivityCompat
+import androidx.core.content.ContextCompat
+import com.google.android.gms.ads.AdListener
+import com.google.android.gms.ads.AdRequest
+import com.google.android.gms.ads.AdView
+import com.google.android.gms.ads.MobileAds
+import com.google.android.gms.tasks.OnCompleteListener
+import com.google.firebase.iid.FirebaseInstanceId
+import com.google.firebase.messaging.FirebaseMessaging
+import com.misit.abpenergy.api.ApiClient
+import com.misit.abpenergy.api.ApiEndPoint
+import com.misit.faceidchecklogptabp.Absen.DaftarWajahActivity
+import com.misit.faceidchecklogptabp.Response.AbpResponse
+import com.misit.faceidchecklogptabp.Response.Absen.DirInfoResponse
+import com.misit.faceidchecklogptabp.Response.LastAbsenResponse
+import com.misit.faceidchecklogptabp.Response.MainResponse.FirstLoadResponse
+import com.misit.faceidchecklogptabp.Utils.PopupUtil
+import com.misit.faceidchecklogptabp.Utils.PrefsUtil
+import kotlinx.android.synthetic.main.activity_home.*
+import retrofit2.Call
+import retrofit2.Callback
+import retrofit2.Response
+import java.util.*
+
+class HomeActivity : AppCompatActivity(),View.OnClickListener, LocationListener {
+    lateinit var handler : Handler
+    private var r :Runnable?=null
+    lateinit var tm : TelephonyManager
+    private var IMEI :String?=null
+    private var time: Date?=null
+    private var csrf_token : String?=""
+    private var jamSekarang : Int=0
+    private var menitSekarang : Int=0
+    private var detikSekarang : Int=0
+    var tipe :String?=null
+    private var app_version : String?=""
+    private var mLocationManager : LocationManager?=null
+    private var mLocation : Location?= null
+    lateinit var viewPassword: View
+    lateinit var alertDialog: AlertDialog
+//    private var mFirebaseAnalytics: FirebaseAnalytics? = null
+    private var android_token : String?=null
+
+    lateinit var mAdView : AdView
+    @SuppressLint("MissingPermission")
+    override fun onCreate(savedInstanceState: Bundle?) {
+        super.onCreate(savedInstanceState)
+        setContentView(R.layout.activity_home)
+        androidToken()
+        var intPerm :Int= ContextCompat.checkSelfPermission(this, Manifest.permission.READ_PHONE_STATE)
+        if(intPerm== PackageManager.PERMISSION_GRANTED){
+            tm = getSystemService(Context.TELEPHONY_SERVICE) as TelephonyManager
+            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
+                IMEI = Settings.Secure.getString(this.getContentResolver(), Settings.Secure.ANDROID_ID)
+
+            } else {
+                IMEI = tm.getDeviceId()
+            }
+        }
+        else{
+            ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.READ_PHONE_STATE),123)
+        }
+        getGPS()
+        PrefsUtil.initInstance(this)
+        if(PrefsUtil.getInstance().getBooleanState(PrefsUtil.IS_LOGGED_IN,false)){
+            NAMA = PrefsUtil.getInstance().getStringState(PrefsUtil.NAMA_LENGKAP,"")
+            NIK = PrefsUtil.getInstance().getStringState(PrefsUtil.NIK,"")
+            SHOW_ABSEN = PrefsUtil.getInstance().getStringState(PrefsUtil.SHOW_ABSEN,"")
+        }
+        tipe = intent.getStringExtra(TIPE)
+        if(tipe=="terlambat"){
+//            listAbsen()
+        }
+        tvNama.text= NAMA
+        tvNik.text= NIK
+        handler= Handler()
+        MobileAds.initialize(this) {}
+    }
+
+    override fun onClick(v: View?) {
+    }
+
+    override fun onLocationChanged(location: Location?) {
+    }
+
+    override fun onStatusChanged(provider: String?, status: Int, extras: Bundle?) {
+    }
+
+    override fun onProviderEnabled(provider: String?) {
+    }
+
+    override fun onProviderDisabled(provider: String?) {
+    }
+    private fun getGPS() {
+
+        mLocationManager = getSystemService(Context.LOCATION_SERVICE) as LocationManager
+        if(Build.VERSION.SDK_INT>= Build.VERSION_CODES.LOLLIPOP){
+            if(ActivityCompat.checkSelfPermission(this,
+                    Manifest.permission.ACCESS_FINE_LOCATION)
+                != PackageManager.PERMISSION_GRANTED ){
+                PackageManager.PERMISSION_GRANTED
+                ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.ACCESS_FINE_LOCATION),1)
+                return
+            }else{
+            }
+        }
+        assert(mLocationManager!=null)
+        mLocationManager?.requestLocationUpdates(LocationManager.GPS_PROVIDER,
+            10,10f,this)
+
+    }
+
+    //    androidToken
+    fun androidToken(){
+        FirebaseMessaging.getInstance().isAutoInitEnabled = true
+        FirebaseInstanceId.getInstance().instanceId
+            .addOnCompleteListener(OnCompleteListener { task ->
+                if (!task.isSuccessful) {
+                    Toast.makeText(this@HomeActivity,"Error : $task.exception", Toast.LENGTH_SHORT).show()
+
+                    return@OnCompleteListener
+                }
+                // Get new Instance ID token
+                android_token = task.result?.token
+            })
+    }
+    //    androidToken
+    override fun onResume() {
+        cekLokasi()
+
+        r = Runnable{
+            doJob()
+        }
+        cekFaceID()
+        super.onResume()
+    }
+
+    override fun onPause() {
+        handler.removeCallbacks(r)
+        super.onPause()
+    }
+
+    override fun onStop() {
+        handler.removeCallbacks(r)
+        super.onStop()
+    }
+    fun doJob() {
+            if(detikSekarang!!.toInt()>=59){
+                if(menitSekarang!!.toInt()>=59){
+                    if(jamSekarang!!.toInt()>=23){
+                        jamSekarang==0
+                        menitSekarang=0
+                        detikSekarang=0
+                    }else{
+                        jamSekarang=jamSekarang+1
+                        menitSekarang=0
+                        detikSekarang=0
+                    }
+                }else{
+                    menitSekarang=menitSekarang+1
+                    detikSekarang=0
+                }
+            }else{
+                detikSekarang=detikSekarang+1
+            }
+            if(jamSekarang<10) {
+                if(menitSekarang<10){
+                    if(detikSekarang<10){
+                        tvJam.text = "0" + "${jamSekarang} : 0" + "${menitSekarang} : 0" + "${detikSekarang}"
+                    }else{
+                        tvJam.text = "0" + "${jamSekarang} : 0" + "${menitSekarang} : ${detikSekarang}"
+                    }
+                }else{
+                    if(detikSekarang<10){
+                        tvJam.text = "0" + "${jamSekarang} : ${menitSekarang} : 0" + "${detikSekarang}"
+                    }else{
+                        tvJam.text = "0" + "${jamSekarang} : ${menitSekarang} : ${detikSekarang}"
+                    }
+                }
+            }else{
+                if(menitSekarang<10){
+                    if(detikSekarang<10){
+                        tvJam.text = "${jamSekarang} : 0" + "${menitSekarang} : 0" + "${detikSekarang}"
+                    }else{
+                        tvJam.text = "${jamSekarang} : 0" + "${menitSekarang} : ${detikSekarang}"
+                    }
+                }else{
+                    if(detikSekarang<10){
+                        tvJam.text = "${jamSekarang} : ${menitSekarang} : 0" + "${detikSekarang}"
+                    }else{
+                        tvJam.text =  "${jamSekarang} : ${menitSekarang} : ${detikSekarang}"
+                    }
+                }
+            }
+            tvTanggal.text = TANGGAL
+            handler.postDelayed(r,1000)
+        }
+    fun cekLokasi(){
+        val apiEndPoint = ApiClient.getClient(this@HomeActivity)!!.create(ApiEndPoint::class.java)
+        val call = apiEndPoint.getAndroidToken(NIK,"faceId",android_token)
+        call?.enqueue(object : Callback<FirstLoadResponse?> {
+            override fun onFailure(call: Call<FirstLoadResponse?>, t: Throwable) {
+                koneksiInActive()
+            }
+
+            override fun onResponse(call: Call<FirstLoadResponse?>, response: Response<FirstLoadResponse?>) {
+                var koneksiCek = response.body()
+                Log.v("CekData",koneksiCek.toString())
+                if(koneksiCek!=null){
+                    if(koneksiCek.jam!=null)
+                        jamSekarang = koneksiCek.jam!!.toInt()
+                        menitSekarang = koneksiCek.menit!!.toInt()
+                        detikSekarang = koneksiCek.detik!!.toInt()
+                        TANGGAL = "${koneksiCek.hari}, ${koneksiCek.tanggal}"
+                        doJob()
+//                    Log.d("JAMNYA", "${koneksiCek.jam}")
+                }else{
+                    koneksiInActive()
+                }
+            }
+        })
+
+    }
+    fun koneksiInActive(){
+        AlertDialog.Builder(this)
+            .setTitle("Maaf , Anda Harus Menggunakan Jaringan Wifi PT. ABP!")
+            .setPositiveButton("OK, Keluar",{
+                    _,
+                    _ ->
+                finish()
+            })
+            .setOnDismissListener({_ -> finish()  })
+            .show()
+    }
+    fun cekFaceID(){
+        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)
+        val call = apiEndPoint.getDirInfo(IndexActivity.NIK!!)
+        call?.enqueue(object : Callback<DirInfoResponse?> {
+            override fun onFailure(call: Call<DirInfoResponse?>, t: Throwable) {
+                cekFaceID()
+            }
+            override fun onResponse(
+                call: Call<DirInfoResponse?>,
+                response: Response<DirInfoResponse?>
+            ) {
+                val faceRes = response.body()
+                if(faceRes!=null){
+                    if(faceRes.folder!!){
+//                        btnFaceFalse.visibility=View.GONE
+//                        btnFaceTrue.visibility=View.VISIBLE
+                        PopupUtil.dismissDialog()
+                        loadAbsen()
+//                        btnDaftarWajah.visibility=View.GONE
+                    }else{
+//                        btnFaceFalse.visibility=View.VISIBLE
+//                        btnFaceTrue.visibility=View.GONE
+                        PopupUtil.dismissDialog()
+                        val intent = Intent(this@HomeActivity, DaftarWajahActivity::class.java)
+                        startActivity(intent)
+                    }
+                }
+            }
+        })
+        PopupUtil.dismissDialog()
+    }
+    fun loadAbsen(){
+        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)
+        val call = apiEndPoint.lastAbsen(NIK!!)
+        call?.enqueue(object : Callback<LastAbsenResponse?> {
+            override fun onFailure(call: Call<LastAbsenResponse?>, t: Throwable) {
+
+            }
+            override fun onResponse(
+                call: Call<LastAbsenResponse?>,
+                response: Response<LastAbsenResponse?>
+            ) {
+
+                val lastRes = response.body()
+                if(lastRes!=null){
+                    if(lastRes?.lastNew!=null){
+//                        Toasty.info(this@IndexActivity,lastRes?.lastAbsen).show()
+                        if(lastRes.lastNew=="Masuk"){
+                            btnNewPulang.isEnabled=true
+                            btnNewMasuk.isEnabled=true
+                            btnNewMasuk.visibility=View.GONE
+                            btnNewPulang.visibility=View.VISIBLE
+                            tvNewMasuk.visibility=View.VISIBLE
+                            tvNewPulang.visibility=View.GONE
+                        }else
+                            if(lastRes.lastNew=="Pulang"){
+//                                chkMasuk.isChecked=true
+//                                chkPulang.isChecked=true
+                                btnNewPulang.isEnabled=true
+                                btnNewMasuk.isEnabled=true
+                                btnNewMasuk.visibility=View.VISIBLE
+                                btnNewPulang.visibility=View.GONE
+                                tvNewMasuk.visibility=View.GONE
+                                tvNewPulang.visibility=View.VISIBLE
+
+                            }else{
+//                                chkMasuk.isChecked=false
+//                                chkPulang.isChecked=false
+                                btnNewMasuk.isEnabled=true
+                                btnNewPulang.isEnabled=true
+                                btnNewMasuk.visibility=View.VISIBLE
+                                btnNewPulang.visibility=View.VISIBLE
+                                tvNewMasuk.visibility=View.GONE
+                                tvNewPulang.visibility=View.GONE
+                            }
+                        if(btnNewMasuk.isEnabled==false){
+//                            Toasty.info(this@IndexActivity,"Anda Sudah Melakukan Absen Masuk Dan Pulang!",Toasty.LENGTH_SHORT).show()
+                        }
+                    }else{
+//                        chkMasuk.isChecked=false
+//                        chkPulang.isChecked=false
+                        btnNewMasuk.isEnabled=true
+                        btnNewPulang.isEnabled=true
+                        btnNewMasuk.visibility=View.VISIBLE
+                        btnNewPulang.visibility=View.GONE
+                    }
+                }
+            }
+
+        })
+    }
+    companion object{
+        var TIPE = "TIPE"
+        var PENGGUNA = "PENGGUNA"
+        var KARYAWAN = "KARYAWAN"
+        var NIK = "NIK"
+        var NAMA = "NAMA"
+        var SHOW_ABSEN="SHOW_ABSEN"
+        var PERSENTASE = "PERSENTASE"
+        var LAT = 0.0
+        var LNG = 0.0
+        var TANGGAL = "Selasa, 30 Maret 2021"
+    }
+}
\ No newline at end of file
Index: app/src/main/res/drawable/ic_baseline_people_24.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/drawable/ic_baseline_people_24.xml	(date 1617005354280)
+++ app/src/main/res/drawable/ic_baseline_people_24.xml	(date 1617005354280)
@@ -0,0 +1,5 @@
+<vector android:height="24dp" android:tint="#FFF7FF"
+    android:viewportHeight="24" android:viewportWidth="24"
+    android:width="24dp" xmlns:android="http://schemas.android.com/apk/res/android">
+    <path android:fillColor="@android:color/white" android:pathData="M16,11c1.66,0 2.99,-1.34 2.99,-3S17.66,5 16,5c-1.66,0 -3,1.34 -3,3s1.34,3 3,3zM8,11c1.66,0 2.99,-1.34 2.99,-3S9.66,5 8,5C6.34,5 5,6.34 5,8s1.34,3 3,3zM8,13c-2.33,0 -7,1.17 -7,3.5L1,19h14v-2.5c0,-2.33 -4.67,-3.5 -7,-3.5zM16,13c-0.29,0 -0.62,0.02 -0.97,0.05 1.16,0.84 1.97,1.97 1.97,3.45L17,19h6v-2.5c0,-2.33 -4.67,-3.5 -7,-3.5z"/>
+</vector>
Index: app/src/main/res/layout/activity_index.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\nandroid:layout_width=\"match_parent\"\r\nandroid:layout_height=\"match_parent\"\r\nandroid:orientation=\"vertical\"\r\ntools:context=\".IndexActivity\">\r\n    <LinearLayout\r\n        android:orientation=\"vertical\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"match_parent\">\r\n    <androidx.appcompat.widget.Toolbar\r\n        android:id=\"@+id/toolbar\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"?attr/actionBarSize\"\r\n        android:background=\"@drawable/toolbar_bg\"\r\n        app:popupTheme=\"@style/ThemeOverlay.AppCompat.Light\"\r\n        app:titleTextColor=\"@color/colorPrimary\" >\r\n        <ImageView\r\n            android:layout_gravity=\"center\"\r\n            android:layout_width=\"45dp\"\r\n            android:layout_height=\"45dp\"\r\n            android:layout_weight=\"1\"\r\n            android:src=\"@drawable/abp_logo\"\r\n            android:layout_marginTop=\"5dp\"\r\n            android:layout_marginBottom=\"5dp\"\r\n            />\r\n        <ImageView\r\n            android:id=\"@+id/btnInfoApp\"\r\n            android:layout_gravity=\"right\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_weight=\"1\"\r\n            android:padding=\"5dp\"\r\n            android:src=\"@drawable/ic_info_outline_black_24dp\"\r\n            android:layout_marginTop=\"5dp\"\r\n            android:layout_marginRight=\"5dp\"\r\n            android:layout_marginBottom=\"5dp\"\r\n            />\r\n        <ImageView\r\n            android:id=\"@+id/btnMasukanList\"\r\n            android:layout_gravity=\"right\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_weight=\"1\"\r\n            android:padding=\"5dp\"\r\n            android:src=\"@drawable/ic_sms_failed_black_24dp\"\r\n            android:layout_marginTop=\"5dp\"\r\n            android:layout_marginRight=\"5dp\"\r\n            android:layout_marginBottom=\"5dp\"\r\n            />\r\n        <ImageView\r\n            android:visibility=\"gone\"\r\n            android:id=\"@+id/btnFaceTrue\"\r\n            android:layout_gravity=\"left\"\r\n            android:layout_width=\"40dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_weight=\"1\"\r\n            android:padding=\"5dp\"\r\n            android:src=\"@drawable/face_true\"\r\n            android:layout_marginTop=\"5dp\"\r\n            android:layout_marginLeft=\"5dp\"\r\n            android:layout_marginBottom=\"5dp\"\r\n            />\r\n        <ImageView\r\n            android:id=\"@+id/btnFaceFalse\"\r\n            android:layout_gravity=\"left\"\r\n            android:layout_width=\"40dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_weight=\"1\"\r\n            android:padding=\"5dp\"\r\n            android:src=\"@drawable/face_false\"\r\n            android:layout_marginTop=\"5dp\"\r\n            android:layout_marginLeft=\"5dp\"\r\n            android:layout_marginBottom=\"5dp\"\r\n            />\r\n    </androidx.appcompat.widget.Toolbar>\r\n<androidx.constraintlayout.widget.ConstraintLayout\r\n    android:id=\"@+id/headerTop\"\r\n    android:background=\"@color/white\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"wrap_content\">\r\n\r\n    <View\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"0.5dp\"\r\n        android:background=\"#81333333\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\" />\r\n    <LinearLayout\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"horizontal\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintLeft_toLeftOf=\"@+id/headerTop\"\r\n        app:layout_constraintTop_toTopOf=\"parent\">\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_margin=\"5dp\"\r\n            android:orientation=\"vertical\">\r\n\r\n            <TextView\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"Nama\" />\r\n\r\n            <TextView\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"Nik\" />\r\n        </LinearLayout>\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_margin=\"5dp\"\r\n            android:orientation=\"vertical\">\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvNama\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvNik\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"\" />\r\n        </LinearLayout>\r\n    </LinearLayout>\r\n\r\n    <LinearLayout\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginEnd=\"4dp\"\r\n        android:orientation=\"horizontal\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\">\r\n\r\n        <Button\r\n            android:visibility=\"gone\"\r\n            android:id=\"@+id/btnSandi\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"match_parent\"\r\n            android:background=\"@drawable/bg_password\"\r\n            android:text=\"Ganti Sandi\"\r\n            android:textAllCaps=\"false\"\r\n            android:textColor=\"@color/white\"\r\n            android:textSize=\"11sp\" />\r\n    </LinearLayout>\r\n    <View\r\n        android:id=\"@+id/view\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"0.5dp\"\r\n        android:background=\"#81333333\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\" />\r\n</androidx.constraintlayout.widget.ConstraintLayout>\r\n<LinearLayout\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"wrap_content\"\r\n    android:orientation=\"horizontal\">\r\n    <TextView\r\n        android:id=\"@+id/tvJam\"\r\n        android:layout_weight=\"1\"\r\n        android:padding=\"20dp\"\r\n        android:layout_width=\"0dp\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:text=\"Jam\"/>\r\n    <Button\r\n        android:visibility=\"gone\"\r\n        android:id=\"@+id/logOut\"\r\n        android:layout_width=\"0dp\"\r\n        android:layout_height=\"35dp\"\r\n        android:layout_marginRight=\"5dp\"\r\n        android:layout_weight=\"0.4\"\r\n        android:background=\"@drawable/bg_keluar\"\r\n        android:padding=\"0dp\"\r\n        android:text=\"Keluar\"\r\n        android:textAllCaps=\"false\"\r\n        android:textColor=\"@color/white\"\r\n        android:textSize=\"11sp\"\r\n        android:textStyle=\"bold\" />\r\n</LinearLayout>\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"vertical\">\r\n\r\n        <HorizontalScrollView\r\n            android:background=\"#17112233\"\r\n            android:scrollbarAlwaysDrawHorizontalTrack=\"true\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"horizontal\">\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"horizontal\"\r\n                android:paddingTop=\"15dp\"\r\n                android:paddingBottom=\"5dp\">\r\n                <Button\r\n                    android:id=\"@+id/btnLihatAbsen\"\r\n                    android:layout_width=\"100dp\"\r\n                    android:layout_height=\"35dp\"\r\n                    android:layout_marginLeft=\"5dp\"\r\n                    android:layout_marginRight=\"5dp\"\r\n                    android:layout_marginBottom=\"10dp\"\r\n                    android:background=\"@drawable/bg_absen\"\r\n                    android:text=\"Lihat Absen\"\r\n                    android:textAllCaps=\"false\"\r\n                    android:textColor=\"@color/white\"\r\n                    android:textSize=\"11sp\"\r\n                    android:textStyle=\"bold\" />\r\n\r\n                <Button\r\n                    android:id=\"@+id/btnListAbsen\"\r\n                    android:layout_width=\"150dp\"\r\n                    android:layout_height=\"35dp\"\r\n                    android:layout_marginLeft=\"5dp\"\r\n                    android:layout_marginRight=\"5dp\"\r\n                    android:layout_marginBottom=\"10dp\"\r\n                    android:background=\"@drawable/lihar_absen\"\r\n                    android:text=\"Lihat Semua Absen\"\r\n                    android:textAllCaps=\"false\"\r\n                    android:textColor=\"@color/defaultTextColor\"\r\n                    android:textSize=\"11sp\"\r\n                    android:textStyle=\"bold\" />\r\n                <Button\r\n                    android:id=\"@+id/btnChart\"\r\n                    android:layout_width=\"150dp\"\r\n                    android:layout_height=\"35dp\"\r\n                    android:layout_marginLeft=\"5dp\"\r\n                    android:layout_marginRight=\"5dp\"\r\n                    android:layout_marginBottom=\"10dp\"\r\n                    android:background=\"@drawable/bg_masuk\"\r\n                    android:text=\"Persentase Penguna\"\r\n                    android:textAllCaps=\"false\"\r\n                    android:textColor=\"@color/successColor\"\r\n                    android:textSize=\"11sp\"\r\n                    android:textStyle=\"bold\" />\r\n                <Button\r\n                    android:id=\"@+id/btnMasukan\"\r\n                    android:layout_width=\"150dp\"\r\n                    android:layout_height=\"35dp\"\r\n                    android:layout_marginLeft=\"5dp\"\r\n                    android:layout_marginRight=\"5dp\"\r\n                    android:layout_marginBottom=\"10dp\"\r\n                    android:background=\"@drawable/kirim_masukan\"\r\n                    android:text=\"Kirim Masukan\"\r\n                    android:textAllCaps=\"false\"\r\n                    android:textColor=\"@color/white\"\r\n                    android:textSize=\"11sp\"\r\n                    android:textStyle=\"bold\" />\r\n            </LinearLayout>\r\n        </HorizontalScrollView>\r\n\r\n        <LinearLayout\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"wrap_content\"\r\n    android:orientation=\"horizontal\">\r\n    <CheckBox\r\n        android:layout_marginLeft=\"20dp\"\r\n        android:clickable=\"false\"\r\n        android:id=\"@+id/chkMasuk\"\r\n        android:text=\"Masuk\"\r\n        android:checked=\"false\"\r\n        android:layout_weight=\"0.5\"\r\n        android:layout_width=\"0dp\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:visibility=\"gone\"/>\r\n\r\n    <CheckBox\r\n        android:visibility=\"gone\"\r\n        android:id=\"@+id/chkPulang\"\r\n        android:layout_width=\"0dp\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_weight=\"0.5\"\r\n        android:checked=\"false\"\r\n        android:clickable=\"false\"\r\n        android:text=\"Pulang\" />\r\n</LinearLayout>\r\n    </LinearLayout>\r\n\r\n<LinearLayout\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:orientation=\"vertical\">\r\n<LinearLayout\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"wrap_content\"\r\n    android:orientation=\"horizontal\">\r\n\r\n    <Button\r\n        android:id=\"@+id/btnLupaMasuk\"\r\n        android:layout_width=\"0dp\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_margin=\"10dp\"\r\n        android:layout_weight=\"1\"\r\n        android:background=\"@drawable/masuk\"\r\n        android:text=\"Lupa Absen Masuk\"\r\n        android:textColor=\"@color/white\"\r\n        android:textSize=\"10sp\" />\r\n\r\n    <Button\r\n        android:textSize=\"10sp\"\r\n        android:layout_margin=\"10dp\"\r\n        android:id=\"@+id/btnLupaPulang\"\r\n        android:layout_width=\"0dp\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:text=\"Lupa Absen Pulang\"\r\n        android:layout_weight=\"1\"\r\n        android:textColor=\"@color/white\"\r\n        android:background=\"@drawable/pulang\"/>\r\n</LinearLayout>\r\n\r\n    <Button\r\n        android:id=\"@+id/btnDaftarWajah\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"0dp\"\r\n        android:layout_margin=\"10dp\"\r\n        android:layout_weight=\"1\"\r\n        android:background=\"@drawable/border_btn\"\r\n        android:text=\"Wajah Belum Terdaftar,\r\n         Daftarkan !\" />\r\n\r\n    <Button\r\n        android:visibility=\"gone\"\r\n        android:id=\"@+id/btn_masuk\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"0dp\"\r\n        android:text=\"Masuk\"\r\n        android:layout_weight=\"1\"\r\n        android:textColor=\"@color/white\"\r\n        android:background=\"@drawable/masuk\"\r\n        android:layout_margin=\"10dp\"/>\r\n    <Button\r\n        android:visibility=\"gone\"\r\n        android:id=\"@+id/btn_pulang\"\r\n        android:layout_margin=\"10dp\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"0dp\"\r\n        android:text=\"Pulang\"\r\n        android:layout_weight=\"1\"\r\n        android:textColor=\"@color/white\"\r\n        android:background=\"@drawable/pulang\"/>\r\n</LinearLayout>\r\n    </LinearLayout>\r\n    <com.google.android.gms.ads.AdView\r\n        android:id=\"@+id/adViewIndex\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_alignParentBottom=\"true\"\r\n        android:layout_centerHorizontal=\"true\"\r\n        app:adSize=\"BANNER\"\r\n        app:adUnitId=\"@string/APP_ADMOB_ID_BANNER\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\">\r\n    </com.google.android.gms.ads.AdView>\r\n</RelativeLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_index.xml	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/res/layout/activity_index.xml	(date 1617003250381)
@@ -10,73 +10,75 @@
         android:orientation="vertical"
         android:layout_width="match_parent"
         android:layout_height="match_parent">
-    <androidx.appcompat.widget.Toolbar
-        android:id="@+id/toolbar"
-        android:layout_width="match_parent"
-        android:layout_height="?attr/actionBarSize"
-        android:background="@drawable/toolbar_bg"
-        app:popupTheme="@style/ThemeOverlay.AppCompat.Light"
-        app:titleTextColor="@color/colorPrimary" >
-        <ImageView
-            android:layout_gravity="center"
-            android:layout_width="45dp"
-            android:layout_height="45dp"
-            android:layout_weight="1"
-            android:src="@drawable/abp_logo"
-            android:layout_marginTop="5dp"
-            android:layout_marginBottom="5dp"
-            />
-        <ImageView
-            android:id="@+id/btnInfoApp"
-            android:layout_gravity="right"
-            android:layout_width="wrap_content"
-            android:layout_height="wrap_content"
-            android:layout_weight="1"
-            android:padding="5dp"
-            android:src="@drawable/ic_info_outline_black_24dp"
-            android:layout_marginTop="5dp"
-            android:layout_marginRight="5dp"
-            android:layout_marginBottom="5dp"
-            />
-        <ImageView
-            android:id="@+id/btnMasukanList"
-            android:layout_gravity="right"
-            android:layout_width="wrap_content"
-            android:layout_height="wrap_content"
-            android:layout_weight="1"
-            android:padding="5dp"
-            android:src="@drawable/ic_sms_failed_black_24dp"
-            android:layout_marginTop="5dp"
-            android:layout_marginRight="5dp"
-            android:layout_marginBottom="5dp"
-            />
-        <ImageView
-            android:visibility="gone"
-            android:id="@+id/btnFaceTrue"
-            android:layout_gravity="left"
-            android:layout_width="40dp"
-            android:layout_height="wrap_content"
-            android:layout_weight="1"
-            android:padding="5dp"
-            android:src="@drawable/face_true"
-            android:layout_marginTop="5dp"
-            android:layout_marginLeft="5dp"
-            android:layout_marginBottom="5dp"
-            />
-        <ImageView
-            android:id="@+id/btnFaceFalse"
-            android:layout_gravity="left"
-            android:layout_width="40dp"
-            android:layout_height="wrap_content"
-            android:layout_weight="1"
-            android:padding="5dp"
-            android:src="@drawable/face_false"
-            android:layout_marginTop="5dp"
-            android:layout_marginLeft="5dp"
-            android:layout_marginBottom="5dp"
-            />
-    </androidx.appcompat.widget.Toolbar>
-<androidx.constraintlayout.widget.ConstraintLayout
+
+        <androidx.appcompat.widget.Toolbar
+            android:id="@+id/toolbar"
+            android:layout_width="match_parent"
+            android:layout_height="?attr/actionBarSize"
+            android:background="@drawable/toolbar_bg"
+            app:popupTheme="@style/ThemeOverlay.AppCompat.Light"
+            app:titleTextColor="@color/colorPrimary">
+
+            <ImageView
+                android:layout_width="45dp"
+                android:layout_height="45dp"
+                android:layout_gravity="center"
+                android:layout_marginTop="5dp"
+                android:layout_marginBottom="5dp"
+                android:layout_weight="1"
+                android:src="@drawable/abp_logo" />
+
+            <ImageView
+                android:id="@+id/btnInfoApp"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:layout_gravity="right"
+                android:layout_marginTop="5dp"
+                android:layout_marginRight="5dp"
+                android:layout_marginBottom="5dp"
+                android:layout_weight="1"
+                android:padding="5dp"
+                android:src="@drawable/ic_info_outline_black_24dp" />
+
+            <ImageView
+                android:id="@+id/btnMasukanList"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:layout_gravity="right"
+                android:layout_marginTop="5dp"
+                android:layout_marginRight="5dp"
+                android:layout_marginBottom="5dp"
+                android:layout_weight="1"
+                android:padding="5dp"
+                android:src="@drawable/ic_sms_failed_black_24dp" />
+
+            <ImageView
+                android:id="@+id/btnFaceTrue"
+                android:layout_width="40dp"
+                android:layout_height="wrap_content"
+                android:layout_gravity="left"
+                android:layout_marginLeft="5dp"
+                android:layout_marginTop="5dp"
+                android:layout_marginBottom="5dp"
+                android:layout_weight="1"
+                android:padding="5dp"
+                android:src="@drawable/face_true"
+                android:visibility="gone" />
+
+            <ImageView
+                android:id="@+id/btnFaceFalse"
+                android:layout_width="40dp"
+                android:layout_height="wrap_content"
+                android:layout_gravity="left"
+                android:layout_marginLeft="5dp"
+                android:layout_marginTop="5dp"
+                android:layout_marginBottom="5dp"
+                android:layout_weight="1"
+                android:padding="5dp"
+                android:src="@drawable/face_false" />
+        </androidx.appcompat.widget.Toolbar>
+
+        <androidx.constraintlayout.widget.ConstraintLayout
     android:id="@+id/headerTop"
     android:background="@color/white"
     android:layout_width="match_parent"
Index: app/src/main/java/com/misit/faceidchecklogptabp/Api/ApiEndPoint.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.misit.abpenergy.api\r\n\r\nimport com.misit.faceidchecklogptabp.Response.*\r\nimport com.misit.faceidchecklogptabp.Response.Absen.AllAbsenResponse\r\nimport com.misit.faceidchecklogptabp.Response.Absen.DirInfoResponse\r\nimport okhttp3.MultipartBody\r\nimport okhttp3.RequestBody\r\nimport retrofit2.Call\r\nimport retrofit2.http.*\r\n\r\ninterface ApiEndPoint{\r\n\r\n    @GET(\"refresh-csrf\")\r\n    fun getToken(@Query(\"csrf_token\") tokenId:String): Call<CsrfTokenResponse>?\r\n    @Multipart\r\n    @POST(\"upload_image.php\")\r\n    fun uploadImage(@Part fileToUpload:MultipartBody.Part?,\r\n                    @Part(\"nik\") nik:RequestBody?,\r\n                    @Part(\"tgl\") tgl:RequestBody?,\r\n                    @Part(\"jam\") jam:RequestBody?,\r\n                    @Part(\"status\") status:RequestBody?,\r\n                    @Part(\"id\") id:RequestBody?,\r\n                    @Part(\"lupa_absen\") lupa_absen:RequestBody,\r\n                    @Part(\"lat\") lat:RequestBody,\r\n                    @Part(\"lng\") lng:RequestBody): Call<ImageResponse>\r\n    @Multipart\r\n    @POST(\"registrasi_wajah.php\")\r\n    fun daftarkanWajah(@Part fileToUpload:MultipartBody.Part?,\r\n                    @Part(\"nik\") nik:RequestBody?): Call<ImageResponse>\r\n//    @FormUrlEncoded\r\n//    @POST(\"login.php\")\r\n//    fun loginChecklogin(@Field(\"nik\") nik:String?,\r\n//                        @Field(\"password\") password:String?): Call<UserResponse>\r\n    @GET(\"api/android/app/cek/lokasi\")\r\n    fun cekLokasi(): Call<AbpResponse>?\r\n\r\n    @FormUrlEncoded\r\n    @POST(\"api/android/post/login-face-id\")\r\n    fun loginChecklogin(@Field(\"username\") username:String?,\r\n                        @Field(\"password\") password:String?,\r\n                        @Field(\"_token\") csrf_token:String?,\r\n                        @Field(\"android_token\") android_token:String?,\r\n                        @Field(\"app_version\") app_version:String?,\r\n                        @Field(\"app_name\") app_name:String?,\r\n                        @Field(\"imei\") imei:String?): Call<LoginResponse>\r\n\r\n    @FormUrlEncoded\r\n    @POST(\"api/android/post/updatePasswordFace\")\r\n    fun updatePassword(@Field(\"username\") username:String?,\r\n                       @Field(\"password\") password:String?,\r\n                       @Field(\"newPassword\") newPassword:String?,\r\n                       @Field(\"_token\") csrf_token:String?): Call<LoginResponse>\r\n\r\n\r\n    @FormUrlEncoded\r\n    @POST(\"api/android/post/kirim/masukan\")\r\n    fun kirimMasukan(@Field(\"nik\") nik:String?,\r\n                       @Field(\"nama\") nama:String?,\r\n                       @Field(\"masukan\") masukan:String?,\r\n                       @Field(\"_token\") csrf_token:String?): Call<MasukanResponse>\r\n\r\n    @GET(\"api/android/get/list/absen\")\r\n    fun getAbsen(@Query(\"nik\") nik:String,\r\n                 @Query(\"status\") status:String,\r\n                 @Query(\"page\") page:Int\r\n    ): Call<ListAbsenResponse>?\r\n\r\n    @GET(\"/absen/get/lastAbsen\")\r\n    fun lastAbsen(@Query(\"nik\") nik:String\r\n    ): Call<LastAbsenResponse>?\r\n\r\n    @GET(\"api/android/app/version\")\r\n    fun getAppVersion(@Query(\"app\") app:String?)\r\n            : Call<AppVersionResponse>?\r\n\r\n    @GET(\"/absen/list/all\")\r\n    fun listAllAbsen(@Query(\"tanggal\") tanggal:String?,\r\n                     @Query(\"status\") status:String?,\r\n                     @Query(\"page\") page:Int?)\r\n            : Call<AllAbsenResponse>?\r\n\r\n    @GET(\"api/android/token/firebase\")\r\n    fun getAndroidToken(@Query(\"nik\") nik:String?,\r\n                        @Query(\"app\") app:String?)\r\n            : Call<AndroidTokenResponse>?\r\n    @GET(\"absen/presentasi/pengguna\")\r\n    fun getPresentasiPengguna()\r\n            : Call<PresentasiPenggunaResponse>?\r\n\r\n    @GET(\"api/android/check/folder\")\r\n    fun getDirInfo(@Query(\"nik\") nik:String?)\r\n            : Call<DirInfoResponse>?\r\n    @GET(\"/absen/apl/masukan\")\r\n    fun getListMasukan(@Query(\"page\") page:Int?,\r\n                       @Query(\"cari\") cari:String?)\r\n            : Call<com.misit.faceidchecklogptabp.Masukan.Response.MasukanResponse>?\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/misit/faceidchecklogptabp/Api/ApiEndPoint.kt	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/java/com/misit/faceidchecklogptabp/Api/ApiEndPoint.kt	(date 1616834079714)
@@ -3,6 +3,7 @@
 import com.misit.faceidchecklogptabp.Response.*
 import com.misit.faceidchecklogptabp.Response.Absen.AllAbsenResponse
 import com.misit.faceidchecklogptabp.Response.Absen.DirInfoResponse
+import com.misit.faceidchecklogptabp.Response.MainResponse.FirstLoadResponse
 import okhttp3.MultipartBody
 import okhttp3.RequestBody
 import retrofit2.Call
@@ -59,6 +60,13 @@
                        @Field("masukan") masukan:String?,
                        @Field("_token") csrf_token:String?): Call<MasukanResponse>
 
+
+    @GET("api/android/token/firebase/new")
+    fun getAndroidToken(@Query("nik") nik:String?,
+                        @Query("app") app:String?,
+                        @Query("android_token") android_token:String?)
+            : Call<FirstLoadResponse>?
+
     @GET("api/android/get/list/absen")
     fun getAbsen(@Query("nik") nik:String,
                  @Query("status") status:String,
@@ -79,10 +87,7 @@
                      @Query("page") page:Int?)
             : Call<AllAbsenResponse>?
 
-    @GET("api/android/token/firebase")
-    fun getAndroidToken(@Query("nik") nik:String?,
-                        @Query("app") app:String?)
-            : Call<AndroidTokenResponse>?
+
     @GET("absen/presentasi/pengguna")
     fun getPresentasiPengguna()
             : Call<PresentasiPenggunaResponse>?
Index: app/src/main/java/com/misit/faceidchecklogptabp/LoginActivity.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.misit.faceidchecklogptabp\r\n\r\nimport android.Manifest\r\nimport android.annotation.SuppressLint\r\nimport android.content.Context\r\nimport android.content.Intent\r\nimport android.content.pm.PackageInfo\r\nimport android.content.pm.PackageManager\r\nimport android.os.Build\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport android.os.Bundle\r\nimport android.provider.Settings\r\nimport android.telephony.TelephonyManager\r\nimport android.util.Log\r\nimport android.view.KeyEvent\r\nimport android.view.View\r\nimport android.widget.Toast\r\nimport androidx.appcompat.app.AlertDialog\r\nimport androidx.core.app.ActivityCompat\r\nimport androidx.core.content.ContextCompat\r\nimport com.google.android.gms.ads.AdListener\r\nimport com.google.android.gms.ads.AdRequest\r\nimport com.google.android.gms.ads.AdView\r\nimport com.google.android.gms.ads.MobileAds\r\nimport com.google.android.gms.tasks.OnCompleteListener\r\nimport com.google.firebase.analytics.FirebaseAnalytics\r\nimport com.google.firebase.iid.FirebaseInstanceId\r\nimport com.google.firebase.messaging.FirebaseMessaging\r\nimport com.misit.abpenergy.api.ApiClient\r\nimport com.misit.abpenergy.api.ApiEndPoint\r\nimport com.misit.faceidchecklogptabp.Response.AbpResponse\r\nimport com.misit.faceidchecklogptabp.Response.CsrfTokenResponse\r\nimport com.misit.faceidchecklogptabp.Response.LoginResponse\r\nimport com.misit.faceidchecklogptabp.Utils.PopupUtil\r\nimport com.misit.faceidchecklogptabp.Utils.PrefsUtil\r\nimport es.dmoral.toasty.Toasty\r\nimport kotlinx.android.synthetic.main.activity_login.*\r\nimport retrofit2.Call\r\nimport retrofit2.Callback\r\nimport retrofit2.Response\r\n\r\nclass LoginActivity : AppCompatActivity(),View.OnClickListener {\r\n\r\n    private var csrf_token : String?=\"\"\r\n    private var android_token : String?=\"\"\r\n    private var app_version : String?=\"\"\r\n    private var IMEI : String?=\"\"\r\n    lateinit var tm : TelephonyManager\r\n\r\n    lateinit var mAdView : AdView\r\n    private var mFirebaseAnalytics: FirebaseAnalytics? = null\r\n    @SuppressLint(\"MissingPermission\")\r\n\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        super.onCreate(savedInstanceState)\r\n        setContentView(R.layout.activity_login)\r\n        var intPerm :Int= ContextCompat.checkSelfPermission(this, Manifest.permission.READ_PHONE_STATE)\r\n        if(intPerm==PackageManager.PERMISSION_GRANTED){\r\n            tm = getSystemService(Context.TELEPHONY_SERVICE) as TelephonyManager\r\n\r\n            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {\r\n                IMEI = Settings.Secure.getString(this.getContentResolver(), Settings.Secure.ANDROID_ID)\r\n            } else {\r\n                IMEI = tm.getDeviceId()\r\n\r\n            }\r\n        }else{\r\n            ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.READ_PHONE_STATE),123)\r\n        }\r\n//        Toasty.info(this,IMEI.toString()).show()\r\n        cekLokasi()\r\n        PrefsUtil.initInstance(this)\r\n        loginBtn.setOnClickListener(this)\r\n        InPassword.setOnKeyListener(View.OnKeyListener { v, keyCode, event ->\r\n            if (keyCode == KeyEvent.KEYCODE_ENTER) {\r\n                //Perform Code\r\n\r\n                if(isValidatedAll()) {\r\n                    loginSubmit(\r\n                        InUsername.text.toString().trim(),\r\n                        InPassword.text.toString().trim()\r\n                    )\r\n                }\r\n                return@OnKeyListener true\r\n            }\r\n            false\r\n        })\r\n    }\r\n    override fun onClick(v: View?) {\r\n        if(v?.id==R.id.loginBtn){\r\n            if(isValidatedAll()){\r\n                loginSubmit(InUsername.text.toString().trim(),InPassword.text.toString().trim())\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    override fun onResume() {\r\n        cekLokasi()\r\n        androidToken()\r\n        versionApp()\r\n        MobileAds.initialize(this) {}\r\n\r\n        mAdView = findViewById(R.id.adViewIndex)\r\n        val adRequest = AdRequest.Builder().build()\r\n        mAdView.loadAd(adRequest)\r\n\r\n        mAdView.adListener = object: AdListener() {\r\n            override fun onAdLoaded() {\r\n                // Code to be executed when an ad finishes loading.\r\n            }\r\n\r\n            override fun onAdFailedToLoad(errorCode : Int) {\r\n                Log.d(\"errorCode\",errorCode.toString())\r\n                // Code to be executed when an ad request fails.\r\n            }\r\n\r\n            override fun onAdOpened() {\r\n                // Code to be executed when an ad opens an overlay that\r\n                // covers the screen.\r\n            }\r\n\r\n            override fun onAdClicked() {\r\n                // Code to be executed when the user clicks on an ad.\r\n            }\r\n\r\n            override fun onAdLeftApplication() {\r\n                // Code to be executed when the user has left the app.\r\n            }\r\n\r\n            override fun onAdClosed() {\r\n                // Code to be executed when the user is about to return\r\n                // to the app after tapping on an ad.\r\n            }\r\n        }\r\n\r\n        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);\r\n        super.onResume()\r\n    }\r\n    fun cekLokasi(){\r\n        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.cekLokasi()\r\n        call?.enqueue(object : Callback<AbpResponse?> {\r\n            override fun onFailure(call: Call<AbpResponse?>, t: Throwable) {\r\n                koneksiInActive()\r\n            }\r\n\r\n            override fun onResponse(call: Call<AbpResponse?>, response: Response<AbpResponse?>) {\r\n                getToken()\r\n\r\n            }\r\n\r\n        })\r\n\r\n    }\r\n    fun androidToken(){\r\n        FirebaseMessaging.getInstance().isAutoInitEnabled = true\r\n        FirebaseInstanceId.getInstance().instanceId\r\n            .addOnCompleteListener(OnCompleteListener { task ->\r\n                if (!task.isSuccessful) {\r\n                    Toast.makeText(this@LoginActivity,\"Error : $task.exception\", Toast.LENGTH_SHORT).show()\r\n\r\n                    return@OnCompleteListener\r\n                }\r\n                // Get new Instance ID token\r\n                android_token = task.result?.token\r\n            })\r\n    }\r\n    private fun getToken() {\r\n        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.getToken(\"csrf_token\")\r\n        call?.enqueue(object : Callback<CsrfTokenResponse> {\r\n            override fun onFailure(call: Call<CsrfTokenResponse>, t: Throwable) {\r\n                Toast.makeText(this@LoginActivity,\"Error : $t\", Toast.LENGTH_SHORT).show()\r\n            }\r\n            override fun onResponse(\r\n                call: Call<CsrfTokenResponse>,\r\n                response: Response<CsrfTokenResponse>\r\n            ) {\r\n                csrf_token = response.body()?.csrfToken\r\n            }\r\n        })\r\n    }\r\n    fun versionApp(){\r\n        Use@ try {\r\n            val pInfo: PackageInfo = this.getPackageManager().getPackageInfo(packageName, 0)\r\n            app_version = pInfo.versionName\r\n        } catch (e: PackageManager.NameNotFoundException) {\r\n            e.printStackTrace()\r\n        }\r\n    }\r\n    fun loginSubmit(userIn:String,passIn:String){\r\n        PopupUtil.showLoading(this@LoginActivity,\"Logging In\",\"Please Wait\")\r\n        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.loginChecklogin(\r\n            userIn,\r\n            passIn,\r\n            csrf_token,\r\n            android_token,\r\n            app_version,\r\n            \"faceId\",\r\n            IMEI.toString()\r\n            )\r\n        call?.enqueue(object : Callback<LoginResponse?> {\r\n            override fun onFailure(call: Call<LoginResponse?>, t: Throwable) {\r\n                Toasty.error(this@LoginActivity,\"Error While Loging...\",Toasty.LENGTH_SHORT).show()\r\n                PopupUtil.dismissDialog()\r\n            }\r\n\r\n            override fun onResponse(\r\n                call: Call<LoginResponse?>,\r\n                response: Response<LoginResponse?>\r\n            ) {\r\n                var usrResponse =response.body()\r\n                    if (usrResponse!=null){\r\n                        if (usrResponse.success!!){\r\n                            PopupUtil.dismissDialog()\r\n                            PrefsUtil.getInstance()\r\n                                .setBooleanState(PrefsUtil.IS_LOGGED_IN,\r\n                                    true)\r\n                            PrefsUtil.getInstance()\r\n                                .setStringState(PrefsUtil.NIK,\r\n                                    usrResponse.dataLogin?.nik)\r\n                            PrefsUtil.getInstance()\r\n                                .setStringState(PrefsUtil.NAMA_LENGKAP,\r\n                                    usrResponse.dataLogin?.nama)\r\n                            PrefsUtil.getInstance()\r\n                                .setStringState(PrefsUtil.SHOW_ABSEN,\r\n                                    usrResponse.dataLogin?.show_absen)\r\n                            Toasty.success(this@LoginActivity,\"Login Success \",Toasty.LENGTH_LONG).show()\r\n                            val intents = Intent(this@LoginActivity,IndexActivity::class.java)\r\n                            finish()\r\n                            startActivity(intents)\r\n                            PopupUtil.dismissDialog()\r\n\r\n                        }else{\r\n                            Toasty.error(this@LoginActivity,\"Username Or Password Wrong!\",Toasty.LENGTH_SHORT).show()\r\n                            clearForm()\r\n                            InUsername.requestFocus()\r\n                            PopupUtil.dismissDialog()\r\n                        }\r\n                    }else{\r\n                        Toasty.error(this@LoginActivity,\"Username Or Password Wrong!\",Toasty.LENGTH_SHORT).show()\r\n                        clearForm()\r\n                        InUsername.requestFocus()\r\n                        PopupUtil.dismissDialog()\r\n                    }\r\n            }\r\n\r\n\r\n        })\r\n    }\r\n    private fun clearForm(){\r\n        InUsername.text=null;\r\n        InPassword.text=null;\r\n    }\r\n    private fun isValidatedAll()  :Boolean{\r\n\r\n        clearError()\r\n        if(InUsername.text!!.isEmpty()){\r\n            tilUsername.error=\"Please Input Someting\"\r\n            InUsername.requestFocus()\r\n            return false\r\n        }\r\n        if(InPassword.text!!.isEmpty()){\r\n            tilPassword.error=\"Please Input Someting\"\r\n            InPassword.requestFocus()\r\n            return false\r\n        }\r\n        PopupUtil.dismissDialog()\r\n        return true\r\n    }\r\n    fun koneksiInActive(){\r\n        AlertDialog.Builder(this)\r\n            .setTitle(\"Maaf , Anda Harus Menggunakan Jaringan Wifi PT. ABP!\")\r\n            .setPositiveButton(\"OK, Keluar\",{\r\n                    dialog,\r\n                    which ->\r\n                finish()\r\n            })\r\n            .setOnDismissListener({dialog -> finish()  })\r\n            .show()\r\n    }\r\n    private fun clearError() {\r\n        tilUsername.error=null\r\n        tilPassword.error=null\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/misit/faceidchecklogptabp/LoginActivity.kt	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/java/com/misit/faceidchecklogptabp/LoginActivity.kt	(date 1617067277537)
@@ -228,7 +228,7 @@
                                 .setStringState(PrefsUtil.SHOW_ABSEN,
                                     usrResponse.dataLogin?.show_absen)
                             Toasty.success(this@LoginActivity,"Login Success ",Toasty.LENGTH_LONG).show()
-                            val intents = Intent(this@LoginActivity,IndexActivity::class.java)
+                            val intents = Intent(this@LoginActivity,HomeActivity::class.java)
                             finish()
                             startActivity(intents)
                             PopupUtil.dismissDialog()
Index: app/src/main/java/com/misit/faceidchecklogptabp/Absen/PulangActivity.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.misit.faceidchecklogptabp.Absen\r\n\r\nimport android.app.AlertDialog\r\nimport android.content.Context\r\nimport android.content.ContextWrapper\r\nimport android.graphics.Bitmap\r\nimport android.net.Uri\r\nimport android.os.Build\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport android.os.Bundle\r\nimport android.util.Log\r\nimport android.view.View\r\nimport android.view.WindowManager\r\nimport android.widget.Toast\r\nimport com.google.android.gms.ads.AdListener\r\nimport com.google.android.gms.ads.AdRequest\r\nimport com.google.android.gms.ads.AdView\r\nimport com.google.android.gms.ads.MobileAds\r\nimport com.google.firebase.analytics.FirebaseAnalytics\r\nimport com.google.firebase.ml.vision.FirebaseVision\r\nimport com.google.firebase.ml.vision.common.FirebaseVisionImage\r\nimport com.google.firebase.ml.vision.common.FirebaseVisionPoint\r\nimport com.google.firebase.ml.vision.face.FirebaseVisionFace\r\nimport com.google.firebase.ml.vision.face.FirebaseVisionFaceContour\r\nimport com.google.firebase.ml.vision.face.FirebaseVisionFaceDetectorOptions\r\nimport com.google.firebase.ml.vision.face.FirebaseVisionFaceDetectorOptions.ALL_CONTOURS\r\nimport com.google.firebase.ml.vision.face.FirebaseVisionFaceDetectorOptions.NO_CONTOURS\r\nimport com.google.firebase.ml.vision.face.FirebaseVisionFaceLandmark\r\nimport com.misit.abpenergy.api.ApiClient\r\nimport com.misit.abpenergy.api.ApiEndPoint\r\nimport com.misit.faceidchecklogptabp.Helper.RectOverlay\r\nimport com.misit.faceidchecklogptabp.R\r\nimport com.misit.faceidchecklogptabp.Response.ImageResponse\r\nimport com.misit.faceidchecklogptabp.Utils.PrefsUtil\r\nimport com.misit.faceidchecklogptabp.Utils.SystemUtils\r\nimport com.wonderkiln.camerakit.*\r\nimport dmax.dialog.SpotsDialog\r\nimport es.dmoral.toasty.Toasty\r\nimport kotlinx.android.synthetic.main.activity_masuk.*\r\nimport kotlinx.android.synthetic.main.activity_pulang.btnBack\r\nimport kotlinx.android.synthetic.main.activity_pulang.btnToggle\r\nimport kotlinx.android.synthetic.main.activity_pulang.btn_detect\r\nimport kotlinx.android.synthetic.main.activity_pulang.camera_view\r\nimport kotlinx.android.synthetic.main.activity_pulang.graphic_overlay\r\nimport okhttp3.MediaType\r\nimport okhttp3.MultipartBody\r\nimport okhttp3.RequestBody\r\nimport retrofit2.Call\r\nimport retrofit2.Callback\r\nimport retrofit2.Response\r\nimport java.io.File\r\nimport java.io.FileOutputStream\r\nimport java.io.IOException\r\nimport java.io.OutputStream\r\nimport java.text.SimpleDateFormat\r\nimport java.util.*\r\nimport kotlin.collections.ArrayList\r\n\r\nclass PulangActivity : AppCompatActivity() {\r\n\r\n    lateinit var waitingDialog: AlertDialog\r\n    private var bitmap:Bitmap?=null\r\n    private var niknya:String?=null\r\n    lateinit var mouthPos:MutableList<FirebaseVisionPoint>\r\n    lateinit var leftEyPos:MutableList<FirebaseVisionPoint>\r\n\r\n    lateinit var  rectOverlay:RectOverlay\r\n    lateinit var leftEarPos:FirebaseVisionPoint\r\n    lateinit var rightEarPos:FirebaseVisionPoint\r\n    private var mFirebaseAnalytics: FirebaseAnalytics? = null\r\n\r\n    lateinit var mAdView : AdView\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        super.onCreate(savedInstanceState)\r\n        setContentView(R.layout.activity_pulang)\r\n//        SystemUtils.fullscreen(window,actionBar!!)\r\n        PrefsUtil.initInstance(this)\r\n        LAT = PrefsUtil.getInstance()\r\n            .getStringState(PrefsUtil.CURRENT_LAT,\"\")\r\n        LNG = PrefsUtil.getInstance()\r\n            .getStringState(PrefsUtil.CURRENT_LNG,\"\")\r\n\r\n//        Toasty.info(this,\"Lat : ${MasukActivity.LAT}, Lng : ${MasukActivity.LNG}\",Toasty.LENGTH_LONG).show()\r\n\r\n        waitingDialog = SpotsDialog.Builder().setContext(this)\r\n            .setMessage(\"Please Wait...\")\r\n            .setCancelable(false)\r\n            .build()\r\n        mouthPos = ArrayList()\r\n        leftEyPos=ArrayList()\r\n//        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {\r\n////            getWindow().setFlags(\r\n////                WindowManager.LayoutParams.FLAG_LAYOUT_NO_LIMITS,\r\n////                WindowManager.LayoutParams.FLAG_LAYOUT_NO_LIMITS)\r\n//            window.decorView.apply {\r\n//                // Hide both the navigation bar and the status bar.\r\n//                // SYSTEM_UI_FLAG_FULLSCREEN is only available on Android 4.1 and higher, but as\r\n//                // a general rule, you should design your app to hide the status bar whenever you\r\n//                // hide the navigation bar.\r\n//                systemUiVisibility = View.SYSTEM_UI_FLAG_HIDE_NAVIGATION\r\n////                or View.SYSTEM_UI_FLAG_FULLSCREEN\r\n//            }\r\n//\r\n//        }\r\n        niknya = intent.getStringExtra(NIK)\r\n        btn_detect.setOnClickListener{\r\n            camera_view.captureImage()\r\n            btn_detect.isEnabled=false\r\n            btn_detect.isClickable=false\r\n        }\r\n        btn_active_camera.setOnClickListener {\r\n            btn_detect.isEnabled=true\r\n            btn_detect.isClickable=true\r\n            camera_view.start()\r\n            graphic_overlay.clear()\r\n            btn_active_camera.visibility=View.GONE\r\n            btn_detect.visibility=View.VISIBLE\r\n\r\n        }\r\n        btnToggle.setOnClickListener {\r\n//            if(camera_view.isFacingBack) {\r\n//                btnToggle.text=\"Camera Belakang\"\r\n//            }else{\r\n//                btnToggle.text=\"Camera Depan\"\r\n//            }\r\n            camera_view.toggleFacing()\r\n        }\r\n\r\n        btnBack.setOnClickListener {\r\n            onBackPressed()\r\n        }\r\n        camera_view.addCameraKitListener(object: CameraKitEventListener {\r\n            override fun onVideo(p0: CameraKitVideo?) {\r\n\r\n            }\r\n\r\n            override fun onEvent(p0: CameraKitEvent?) {\r\n            }\r\n\r\n            override fun onImage(p0: CameraKitImage?) {\r\n\r\n                 waitingDialog.show()\r\n\r\n                bitmap = p0!!.bitmap\r\n                var bitmap1 = Bitmap.createScaledBitmap(bitmap!!,camera_view.width,camera_view.height,false)\r\n\r\n                camera_view.stop()\r\n                runFaceDetector(bitmap1)\r\n            }\r\n\r\n            override fun onError(p0: CameraKitError?) {\r\n\r\n            }\r\n\r\n        })\r\n    }\r\n\r\n\r\n    override fun onResume() {\r\n        super.onResume()\r\n        camera_view.start()\r\n        MobileAds.initialize(this) {}\r\n\r\n        mAdView = findViewById(R.id.adViewIndex)\r\n        val adRequest = AdRequest.Builder().build()\r\n        mAdView.loadAd(adRequest)\r\n\r\n        mAdView.adListener = object: AdListener() {\r\n            override fun onAdLoaded() {\r\n                // Code to be executed when an ad finishes loading.\r\n            }\r\n\r\n            override fun onAdFailedToLoad(errorCode : Int) {\r\n                Log.d(\"errorCode\",errorCode.toString())\r\n                // Code to be executed when an ad request fails.\r\n            }\r\n\r\n            override fun onAdOpened() {\r\n                // Code to be executed when an ad opens an overlay that\r\n                // covers the screen.\r\n            }\r\n\r\n            override fun onAdClicked() {\r\n                // Code to be executed when the user clicks on an ad.\r\n            }\r\n\r\n            override fun onAdLeftApplication() {\r\n                // Code to be executed when the user has left the app.\r\n            }\r\n\r\n            override fun onAdClosed() {\r\n                // Code to be executed when the user is about to return\r\n                // to the app after tapping on an ad.\r\n            }\r\n        }\r\n\r\n        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);\r\n        if(camera_view.isFacingBack){\r\n            camera_view.toggleFacing()\r\n//            btnToggle.text=\"Camera Belakang\"\r\n        }else{\r\n//            btnToggle.text=\"Camera Depan\"\r\n        }\r\n    }\r\n    override fun onPause() {\r\n        super.onPause()\r\n        camera_view.stop()\r\n    }\r\n    private fun saveImageToInternalStorage(bitmap: Bitmap?,id:Int): Uri {\r\n        var waktu = Date()\r\n        val cal = Calendar.getInstance()\r\n        cal.time = waktu\r\n        val simpleFormat = SimpleDateFormat(\"yyyy-MM-dd\", Locale.getDefault())\r\n        var tgl = \"${simpleFormat.format(cal.time)}\"\r\n        var jam = \"${cal.get(Calendar.HOUR_OF_DAY)}${cal.get(Calendar.MINUTE)}${cal.get(Calendar.SECOND)}\"\r\n        var pukul = \"${cal.get(Calendar.HOUR_OF_DAY)}:${cal.get(Calendar.MINUTE)}:${cal.get(Calendar.SECOND)}\"\r\n        val wrapper = ContextWrapper(applicationContext)\r\n        var file = wrapper.getDir(\"images\", Context.MODE_PRIVATE)\r\n        file = File(file, niknya+\"_Pulang_${tgl}__${jam}.jpg\")\r\n        try {\r\n            // Get the file output stream\r\n            val stream: OutputStream = FileOutputStream(file)\r\n            //var uri = Uri.parse(file.absolutePath)\r\n            // Compress bitmap\r\n            bitmap!!.compress(Bitmap.CompressFormat.JPEG, 20, stream)\r\n            // Flush the stream\r\n            stream.flush()\r\n            // Close stream\r\n            stream.close()\r\n        } catch (e: IOException){ // Catch the exception\r\n            e.printStackTrace()\r\n        }\r\n        var uri = Uri.parse(file.absolutePath)\r\n        var fileUri = RequestBody.create(MediaType.parse(\"image/*\"),file)\r\n        //Log.d(\"fileUri\",fileUri.toString())\r\n        var fileToUpload = MultipartBody.Part.createFormData(\"fileToUpload\",file.name,fileUri)\r\n        var niK = RequestBody.create(MultipartBody.FORM, niknya!!)\r\n        var tanggal = RequestBody.create(MultipartBody.FORM, tgl!!)\r\n        var jam_absen = RequestBody.create(MultipartBody.FORM, pukul!!)\r\n        var status_absen = RequestBody.create(MultipartBody.FORM, \"Pulang\")\r\n        var lat = RequestBody.create(MultipartBody.FORM,LAT)\r\n        var lng = RequestBody.create(MultipartBody.FORM,LNG)\r\n        var lupa_absen = RequestBody.create(MultipartBody.FORM,\"\")\r\n        var face_id = RequestBody.create(MultipartBody.FORM, id.toString())\r\n        //API\r\n        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.uploadImage(\r\n            fileToUpload,\r\n            niK,\r\n            tanggal,\r\n            jam_absen,\r\n            status_absen,\r\n            face_id,lupa_absen,lat,lng)\r\n        call?.enqueue(object : Callback<ImageResponse?> {\r\n            override fun onFailure(call: Call<ImageResponse?>, t: Throwable) {\r\n\r\n            }\r\n            override fun onResponse(\r\n                call: Call<ImageResponse?>,\r\n                response: Response<ImageResponse?>\r\n            ) {\r\n                val imageResponse = response.body()\r\n                if (imageResponse != null) {\r\n                    Log.d(\"Tidak dikenal\",imageResponse.tidak_dikenal.toString())\r\n                    if(imageResponse.tidak_dikenal!=null) {\r\n                        if (imageResponse.tidak_dikenal) {\r\n                            file.delete()\r\n                            btn_detect.visibility = View.VISIBLE\r\n                            btnBack.visibility = View.GONE\r\n                            waitingDialog.dismiss()\r\n                            camera_view.start()\r\n                            graphic_overlay.clear()\r\n                            Toasty.info(\r\n                                this@PulangActivity,\r\n                                \"Wajah Tidak Dikenal!\",\r\n                                Toasty.LENGTH_SHORT\r\n                            ).show()\r\n                        } else {\r\n                            file.delete()\r\n                            btn_detect.visibility = View.GONE\r\n                            btnBack.visibility = View.VISIBLE\r\n                            waitingDialog.dismiss()\r\n                            Toasty.info(\r\n                                this@PulangActivity,\r\n                                \"Wajah di kenali, Absen di daftar!\",\r\n                                Toasty.LENGTH_SHORT\r\n                            ).show()\r\n                        }\r\n                    }else{\r\n                        file.delete()\r\n                        btn_detect.visibility=View.VISIBLE\r\n                        btnBack.visibility=View.GONE\r\n                        waitingDialog.dismiss()\r\n                        camera_view.start()\r\n                        graphic_overlay.clear()\r\n                        Toasty.info(this@PulangActivity,\"Wajah Tidak Dikenal!\", Toasty.LENGTH_SHORT).show()\r\n\r\n                    }\r\n                }\r\n            }\r\n        })\r\n        //API\r\n        return uri\r\n    }\r\n\r\n    fun runFaceDetector(bitmap: Bitmap?){\r\n        val image = FirebaseVisionImage.fromBitmap(bitmap!!)\r\n\r\n        val options  = FirebaseVisionFaceDetectorOptions.Builder()\r\n            .setPerformanceMode(\r\n                FirebaseVisionFaceDetectorOptions.ACCURATE)\r\n            .setLandmarkMode(FirebaseVisionFaceDetectorOptions.ALL_LANDMARKS)\r\n            .setClassificationMode(\r\n                FirebaseVisionFaceDetectorOptions.ALL_CLASSIFICATIONS)\r\n            .setContourMode(ALL_CONTOURS)\r\n            .enableTracking()\r\n            .build()\r\n        val detector = FirebaseVision.getInstance().getVisionFaceDetector(options)\r\n\r\n        detector.detectInImage(image)\r\n            .addOnSuccessListener {\r\n                    result -> progressResult(result)\r\n            }\r\n            .addOnFailureListener{\r\n                    e -> Toast.makeText(this@PulangActivity,e.message, Toast.LENGTH_SHORT).show()\r\n            }\r\n\r\n    }\r\n    fun progressResult(result:List<FirebaseVisionFace>){\r\n        var count=0\r\n        var id=0\r\n        var smileProb=0f\r\n        mouthPos.clear()\r\n        leftEyPos.clear()\r\n        for (face in result){\r\n\r\n            val bounds = face.boundingBox\r\n            val rotY = face.headEulerAngleY // Head is rotated to the right rotY degrees\r\n            val rotZ = face.headEulerAngleZ // Head is tilted sideways rotZ degrees\r\n\r\n            // If landmark detection was enabled (mouth, ears, eyes, cheeks, and\r\n            // nose available):\r\n            val leftEar = face.getLandmark(FirebaseVisionFaceLandmark.LEFT_EAR)\r\n            val rightEar = face.getLandmark(FirebaseVisionFaceLandmark.RIGHT_EAR)\r\n            leftEar?.let {\r\n                leftEarPos = leftEar.position\r\n            }\r\n            rightEar?.let {\r\n                rightEarPos = rightEar.position\r\n            }\r\n            val mouth_bottom = face.getLandmark(FirebaseVisionFaceLandmark.MOUTH_BOTTOM)\r\n            mouth_bottom?.let {\r\n              //mouth_bottomPos = mouth_bottom!!.position!!\r\n\r\n            }\r\n            // If contour detection was enabled:\r\n            val leftEyeContour = face.getContour(FirebaseVisionFaceContour.LEFT_EYE).points\r\n            leftEyeContour.let {\r\n                leftEyPos.addAll(it)\r\n            }\r\n            val rightEyeContour = face.getContour(FirebaseVisionFaceContour.RIGHT_EYE).points\r\n            val upperLipBottomContour = face.getContour(FirebaseVisionFaceContour.UPPER_LIP_BOTTOM).points\r\n            upperLipBottomContour.let {\r\n                mouthPos.addAll(it)\r\n            }\r\n            // If classification was enabled:\r\n            if (face.smilingProbability != FirebaseVisionFace.UNCOMPUTED_PROBABILITY) {\r\n                smileProb = face.smilingProbability\r\n            }\r\n            if (face.rightEyeOpenProbability != FirebaseVisionFace.UNCOMPUTED_PROBABILITY) {\r\n                val rightEyeOpenProb = face.rightEyeOpenProbability\r\n            }\r\n\r\n            // If face tracking was enabled:\r\n            if (face.trackingId != FirebaseVisionFace.INVALID_ID) {\r\n                id = face.trackingId\r\n//                saveImageToInternalStorage(bitmap,id)\r\n            }\r\n            rectOverlay = RectOverlay(graphic_overlay,bounds)\r\n\r\n            count++\r\n        }\r\n        if(count>0){\r\n            //btnSave.visibility= View.VISIBLE\r\n            //btnSave.visibility= View.VISIBLE\r\n\r\n            waitingDialog.dismiss()\r\n            if(mouthPos.isNotEmpty()){\r\n                saveImageToInternalStorage(bitmap,id)\r\n                graphic_overlay.add(rectOverlay)\r\n//                Toasty.info(this@PulangActivity,\" LEFT: ${leftEarPos.toString()} \" +\r\n//                        \"|\" +\r\n//                        \" RIGHT: ${rightEarPos.toString()}\", Toasty.LENGTH_SHORT).show()\r\n//                Toasty.info(this@PulangActivity,\" ${leftEarPos.toString()}\", Toasty.LENGTH_SHORT).show()\r\n\r\n//                Toast.makeText(this@PulangActivity,String.format(\" ${leftEarPos}\"),Toast.LENGTH_LONG).show()\r\n            }else{\r\n                Toasty.error(this@PulangActivity,\r\n                    \"Wajah Tidak Terdeteksi! \" +\r\n                        \"Harap Membuka Masker atau \" +\r\n                        \"Pelindung Wajah dan \" +\r\n                        \"Tidak Boleh Lebih dari satu Wajah .!\")\r\n                    .show()\r\n\r\n                btn_active_camera.visibility=View.VISIBLE\r\n                btn_detect.visibility=View.GONE\r\n                waitingDialog.dismiss()\r\n            }\r\n\r\n            //Toast.makeText(this,\"$uri\",Toast.LENGTH_SHORT).show()\r\n        }else{\r\n            waitingDialog.dismiss()\r\n            Toasty.error(this@PulangActivity,\r\n                \"Wajah Tidak Terdeteksi! \" +\r\n                        \"Harap Membuka Masker atau \" +\r\n                        \"Pelindung Wajah dan \" +\r\n                        \"Tidak Boleh Lebih dari satu Wajah .!\")\r\n                .show()\r\n\r\n            btn_active_camera.visibility=View.VISIBLE\r\n            btn_detect.visibility=View.GONE\r\n//            Toasty.info(this@PulangActivity,\"Wajah Tidak Terdeteksi\", Toasty.LENGTH_SHORT).show()\r\n        }\r\n\r\n    }\r\n\r\n    companion object{\r\n        var NIK = \"NIK\"\r\n        var LAT = \"\"\r\n        var LNG = \"\"\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/misit/faceidchecklogptabp/Absen/PulangActivity.kt	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/java/com/misit/faceidchecklogptabp/Absen/PulangActivity.kt	(date 1616839867053)
@@ -67,7 +67,7 @@
     lateinit var  rectOverlay:RectOverlay
     lateinit var leftEarPos:FirebaseVisionPoint
     lateinit var rightEarPos:FirebaseVisionPoint
-    private var mFirebaseAnalytics: FirebaseAnalytics? = null
+//    private var mFirebaseAnalytics: FirebaseAnalytics? = null
 
     lateinit var mAdView : AdView
     override fun onCreate(savedInstanceState: Bundle?) {
@@ -194,7 +194,7 @@
             }
         }
 
-        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
+//        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
         if(camera_view.isFacingBack){
             camera_view.toggleFacing()
 //            btnToggle.text="Camera Belakang"
Index: app/src/main/java/com/misit/faceidchecklogptabp/Api/ApiClient.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.misit.abpenergy.api\r\n\r\nimport android.content.Context\r\nimport com.franmontiel.persistentcookiejar.ClearableCookieJar\r\nimport com.franmontiel.persistentcookiejar.PersistentCookieJar\r\nimport com.franmontiel.persistentcookiejar.cache.SetCookieCache\r\nimport com.franmontiel.persistentcookiejar.persistence.SharedPrefsCookiePersistor\r\nimport okhttp3.OkHttpClient\r\nimport okhttp3.logging.HttpLoggingInterceptor\r\nimport retrofit2.Retrofit\r\nimport retrofit2.converter.gson.GsonConverterFactory\r\n\r\nobject ApiClient{\r\n    private var BASE_URL= \"http://10.10.3.13\"\r\n//    private var BASE_URL= \"https://abpjobsite.com\"\r\n    private var retrofit : Retrofit? = null\r\n//    fun loadURL(base_url:String){\r\n////        BASE_URL = base_url\r\n//    }\r\n    fun getClient(context: Context?):Retrofit?{\r\n        if (retrofit==null){\r\n            retrofit = Retrofit.Builder()\r\n                .baseUrl(BASE_URL)\r\n                .client(getHeader(context))\r\n                .addConverterFactory(GsonConverterFactory.create())\r\n                .build()\r\n        }\r\n        return retrofit\r\n    }\r\n\r\n    private fun getHeader(context: Context?): OkHttpClient {\r\n        val interceptor = HttpLoggingInterceptor()\r\n        interceptor.level = HttpLoggingInterceptor.Level.BODY\r\n        val cookieJar: ClearableCookieJar = PersistentCookieJar(SetCookieCache(),SharedPrefsCookiePersistor(context))\r\n        return OkHttpClient.Builder()\r\n            .addInterceptor(interceptor)\r\n            .cookieJar(cookieJar)\r\n            .build()\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/misit/faceidchecklogptabp/Api/ApiClient.kt	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/java/com/misit/faceidchecklogptabp/Api/ApiClient.kt	(date 1617086807365)
@@ -1,6 +1,7 @@
 package com.misit.abpenergy.api
 
 import android.content.Context
+import com.franmontiel.persistentcookiejar.BuildConfig
 import com.franmontiel.persistentcookiejar.ClearableCookieJar
 import com.franmontiel.persistentcookiejar.PersistentCookieJar
 import com.franmontiel.persistentcookiejar.cache.SetCookieCache
@@ -32,9 +33,15 @@
         val interceptor = HttpLoggingInterceptor()
         interceptor.level = HttpLoggingInterceptor.Level.BODY
         val cookieJar: ClearableCookieJar = PersistentCookieJar(SetCookieCache(),SharedPrefsCookiePersistor(context))
-        return OkHttpClient.Builder()
-            .addInterceptor(interceptor)
+        var okhttpClient = OkHttpClient.Builder()
+        if(BuildConfig.DEBUG)
+        {
+            okhttpClient
+                .addInterceptor(interceptor)
+        }
+        return okhttpClient
             .cookieJar(cookieJar)
+            .retryOnConnectionFailure(false)
             .build()
     }
 }
\ No newline at end of file
Index: app/src/main/res/layout/activity_home.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_home.xml	(date 1617156314838)
+++ app/src/main/res/layout/activity_home.xml	(date 1617156314838)
@@ -0,0 +1,198 @@
+<?xml version="1.0" encoding="utf-8"?>
+<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    tools:context=".HomeActivity">
+
+    <LinearLayout
+        android:background="@color/bg_color"
+        android:layout_width="match_parent"
+        android:layout_height="150dp"
+        android:padding="15dp"
+        android:orientation="vertical"
+        android:id="@+id/lnHeader">
+        <TextView
+            android:textColor="@color/white"
+            android:textStyle="bold"
+            android:textSize="18sp"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Selamat Datang ,"
+            />
+        <TextView
+            android:id="@+id/tvNama"
+            android:textColor="@color/white"
+            android:textStyle="bold"
+            android:textSize="14sp"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Boris Reyson Sitorus"
+            />
+        <TextView
+            android:id="@+id/tvNik"
+            android:textColor="@color/white"
+            android:textSize="14sp"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="18060207"
+            />
+    </LinearLayout>
+
+    <androidx.cardview.widget.CardView
+        app:cardElevation="20dp"
+        app:cardCornerRadius="10dp"
+        android:layout_width="wrap_content"
+        android:layout_height="180dp"
+        android:layout_alignParentLeft="true"
+        android:layout_alignParentTop="true"
+        android:layout_alignParentRight="true"
+        android:layout_marginLeft="12dp"
+        android:layout_marginTop="95dp"
+        android:layout_marginRight="12dp">
+        <LinearLayout
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"
+            android:orientation="vertical">
+            <LinearLayout
+                android:paddingTop="5dp"
+                android:paddingBottom="5dp"
+                android:gravity="center"
+                android:layout_weight="1.94"
+                android:orientation="vertical"
+                android:layout_width="match_parent"
+                android:layout_height="0dp">
+                <TextView
+                    android:id="@+id/tvJam"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:text="07:00:00"
+                    android:textSize="40sp"
+                    android:gravity="center"
+                    android:textColor="#0022FF"
+                    />
+                <TextView
+                    android:id="@+id/tvTanggal"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:text="Senin, 29 Maret 2021"
+                    android:gravity="center"
+                    android:textColor="#000000"
+                    />
+            </LinearLayout>
+            <View
+                android:layout_gravity="center_horizontal"
+                android:layout_width="200dp"
+                android:layout_height="0dp"
+                android:layout_weight="0.02"
+
+                android:background="@color/borderSmoth"/>
+            <LinearLayout
+                android:paddingTop="5dp"
+                android:paddingBottom="5dp"
+                android:orientation="horizontal"
+                android:layout_weight="0.94"
+                android:layout_width="match_parent"
+                android:layout_height="0dp">
+                <Button
+                    android:id="@+id/btnNewMasuk"
+                    android:visibility="visible"
+                    android:layout_margin="5dp"
+                    android:padding="10dp"
+                    android:drawablePadding="5dp"
+                    android:textColor="@color/white"
+                    android:drawableTint="@color/white"
+                    android:text="Masuk"
+                    android:layout_weight="0.94"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:background="@drawable/masuk"
+                    android:drawableLeft="@drawable/scan_wajah"/>
+                <TextView
+                    android:visibility="gone"
+                    android:id="@+id/tvNewMasuk"
+                    android:gravity="center"
+                    android:layout_margin="5dp"
+                    android:textSize="20dp"
+                    android:drawablePadding="5dp"
+                    android:textColor="@color/successColor"
+                    android:text="07:00:00"
+                    android:layout_weight="0.94"
+                    android:layout_width="0dp"
+                    android:layout_height="match_parent"/>
+                <View
+    android:layout_gravity="center_vertical"
+    android:layout_width="0dp"
+    android:layout_height="30dp"
+    android:layout_weight="0.005"
+    android:background="@color/borderSmoth"/>
+                <Button
+                    android:visibility="visible"
+                    android:id="@+id/btnNewPulang"
+                    android:layout_margin="5dp"
+                    android:padding="10dp"
+                    android:drawablePadding="5dp"
+                    android:textColor="@color/white"
+                    android:drawableTint="@color/white"
+                    android:text="Pulang"
+                    android:layout_weight="0.94"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:background="@drawable/pulang"
+                    android:drawableLeft="@drawable/scan_wajah"/>
+                <TextView
+                    android:visibility="gone"
+                    android:id="@+id/tvNewPulang"
+                    android:textSize="20dp"
+                    android:gravity="center"
+                    android:layout_margin="5dp"
+                    android:drawablePadding="5dp"
+                    android:textColor="@color/pulang"
+                    android:text="18:00:00"
+                    android:layout_weight="0.94"
+                    android:layout_width="0dp"
+                    android:layout_height="match_parent"/>
+
+            </LinearLayout>
+        </LinearLayout>
+    </androidx.cardview.widget.CardView>
+    <LinearLayout
+        android:layout_below="@+id/lnHeader"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:orientation="vertical"
+        android:layout_marginTop="150dp">
+        <TextView
+            android:textStyle="bold"
+            android:textColor="@color/colorPrimaryDark"
+            android:padding="10dp"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Absen 3 hari terakhir"/>
+        <ScrollView
+            android:id="@+id/scrlLast"
+            android:padding="10dp"
+            android:layout_width="match_parent"
+            android:layout_height="match_parent">
+        <androidx.recyclerview.widget.RecyclerView
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:id="@+id/rvLast3Day"/>
+        </ScrollView>
+
+    </LinearLayout>
+
+    <com.google.android.material.floatingactionbutton.FloatingActionButton
+        android:id="@+id/btnFloatHistory"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+android:src="@drawable/ic_baseline_history_24"
+        android:layout_alignParentEnd="true"
+        android:layout_alignParentBottom="true"
+        android:textAlignment="center"
+        android:layout_marginBottom="20dp"
+        android:layout_marginEnd="20dp">
+
+    </com.google.android.material.floatingactionbutton.FloatingActionButton>
+</RelativeLayout>
\ No newline at end of file
Index: app/src/main/res/layout/activity_login.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".LoginActivity\">\r\n\r\n    <LinearLayout\r\n        android:id=\"@+id/linearLayout\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_gravity=\"center\"\r\n        android:orientation=\"vertical\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        app:layout_constraintVertical_bias=\"0.45\">\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\">\r\n\r\n            <ImageView\r\n                android:layout_width=\"80dp\"\r\n                android:layout_height=\"80dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/abp_logo\" />\r\n        </LinearLayout>\r\n\r\n        <androidx.cardview.widget.CardView\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_margin=\"20dp\"\r\n            app:cardCornerRadius=\"5dp\"\r\n            app:cardElevation=\"10dp\">\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"vertical\">\r\n\r\n                <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"@drawable/bg_header\"\r\n                    android:padding=\"20dp\"\r\n                    android:text=\"Login Form\"\r\n                    android:textColor=\"@color/white\"\r\n                    android:textSize=\"20sp\"\r\n                    android:textStyle=\"bold\" />\r\n\r\n                <com.google.android.material.textfield.TextInputLayout\r\n                    android:id=\"@+id/tilUsername\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_margin=\"10dp\">\r\n\r\n                    <com.google.android.material.textfield.TextInputEditText\r\n                        android:id=\"@+id/InUsername\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:hint=\"Username / Nik / NRP\"\r\n                        android:imeOptions=\"actionNext\"\r\n                        android:inputType=\"numberSigned\"\r\n                        android:maxLines=\"1\" />\r\n                </com.google.android.material.textfield.TextInputLayout>\r\n\r\n                <com.google.android.material.textfield.TextInputLayout\r\n                    android:id=\"@+id/tilPassword\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_margin=\"10dp\"\r\n                    app:passwordToggleEnabled=\"true\">\r\n\r\n                    <com.google.android.material.textfield.TextInputEditText\r\n                        android:id=\"@+id/InPassword\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:hint=\"Password\"\r\n                        android:inputType=\"textPassword\"\r\n                        android:maxLines=\"1\" />\r\n                </com.google.android.material.textfield.TextInputLayout>\r\n\r\n                <Button\r\n                    android:id=\"@+id/loginBtn\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_margin=\"10dp\"\r\n                    android:background=\"@drawable/btn_bg\"\r\n                    android:text=\"LogIn\"\r\n                    android:textAllCaps=\"false\"\r\n                    android:textColor=\"@color/white\" />\r\n            </LinearLayout>\r\n        </androidx.cardview.widget.CardView>\r\n\r\n    </LinearLayout>\r\n\r\n    <com.google.android.gms.ads.AdView\r\n        android:id=\"@+id/adViewIndex\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_alignParentBottom=\"true\"\r\n        android:layout_centerHorizontal=\"true\"\r\n        app:adSize=\"BANNER\"\r\n        app:adUnitId=\"@string/APP_ADMOB_ID_BANNER\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"></com.google.android.gms.ads.AdView>\r\n</androidx.constraintlayout.widget.ConstraintLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_login.xml	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/res/layout/activity_login.xml	(date 1616841198846)
@@ -6,98 +6,80 @@
     android:layout_height="match_parent"
     tools:context=".LoginActivity">
 
-    <LinearLayout
-        android:id="@+id/linearLayout"
-        android:layout_width="match_parent"
+
+    <androidx.cardview.widget.CardView
+        android:layout_width="0dp"
         android:layout_height="wrap_content"
-        android:layout_gravity="center"
-        android:orientation="vertical"
-        app:layout_constraintBottom_toBottomOf="parent"
+        android:layout_marginStart="32dp"
+        android:layout_marginTop="32dp"
+        android:layout_marginEnd="32dp"
+        android:layout_marginBottom="32dp"
+        app:cardCornerRadius="5dp"
+        app:cardElevation="10dp"
+        app:layout_constraintBottom_toTopOf="@id/adViewIndex"
         app:layout_constraintEnd_toEndOf="parent"
         app:layout_constraintStart_toStartOf="parent"
-        app:layout_constraintTop_toTopOf="parent"
-        app:layout_constraintVertical_bias="0.45">
+        app:layout_constraintTop_toTopOf="parent">
 
         <LinearLayout
             android:layout_width="match_parent"
-            android:layout_height="wrap_content"
+            android:layout_height="match_parent"
             android:orientation="vertical">
 
-            <ImageView
-                android:layout_width="80dp"
-                android:layout_height="80dp"
-                android:layout_gravity="center"
-                android:src="@drawable/abp_logo" />
-        </LinearLayout>
-
-        <androidx.cardview.widget.CardView
-            android:layout_width="match_parent"
-            android:layout_height="wrap_content"
-            android:layout_margin="20dp"
-            app:cardCornerRadius="5dp"
-            app:cardElevation="10dp">
-
-            <LinearLayout
-                android:layout_width="match_parent"
-                android:layout_height="wrap_content"
-                android:orientation="vertical">
-
-                <TextView
-                    android:layout_width="match_parent"
-                    android:layout_height="wrap_content"
-                    android:background="@drawable/bg_header"
-                    android:padding="20dp"
-                    android:text="Login Form"
-                    android:textColor="@color/white"
-                    android:textSize="20sp"
-                    android:textStyle="bold" />
+            <TextView
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:background="@drawable/bg_header"
+                android:padding="20dp"
+                android:text="Masuk Ke Face-Id"
+                android:textColor="@color/white"
+                android:textSize="20sp"
+                android:textStyle="bold" />
 
-                <com.google.android.material.textfield.TextInputLayout
-                    android:id="@+id/tilUsername"
-                    android:layout_width="match_parent"
-                    android:layout_height="wrap_content"
-                    android:layout_margin="10dp">
+            <com.google.android.material.textfield.TextInputLayout
+                android:id="@+id/tilUsername"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:layout_margin="10dp">
 
-                    <com.google.android.material.textfield.TextInputEditText
-                        android:id="@+id/InUsername"
-                        android:layout_width="match_parent"
-                        android:layout_height="wrap_content"
-                        android:hint="Username / Nik / NRP"
-                        android:imeOptions="actionNext"
-                        android:inputType="numberSigned"
-                        android:maxLines="1" />
-                </com.google.android.material.textfield.TextInputLayout>
+                <com.google.android.material.textfield.TextInputEditText
+                    android:id="@+id/InUsername"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:hint="Nomor Induk Karyawan"
+                    android:imeOptions="actionNext"
+                    android:inputType="numberSigned"
+                    android:maxLines="1" />
+            </com.google.android.material.textfield.TextInputLayout>
 
-                <com.google.android.material.textfield.TextInputLayout
-                    android:id="@+id/tilPassword"
-                    android:layout_width="match_parent"
-                    android:layout_height="wrap_content"
-                    android:layout_margin="10dp"
-                    app:passwordToggleEnabled="true">
+            <com.google.android.material.textfield.TextInputLayout
+                android:id="@+id/tilPassword"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:layout_margin="10dp"
+                app:passwordToggleEnabled="true">
 
-                    <com.google.android.material.textfield.TextInputEditText
-                        android:id="@+id/InPassword"
-                        android:layout_width="match_parent"
-                        android:layout_height="wrap_content"
-                        android:hint="Password"
-                        android:inputType="textPassword"
-                        android:maxLines="1" />
-                </com.google.android.material.textfield.TextInputLayout>
+                <com.google.android.material.textfield.TextInputEditText
+                    android:id="@+id/InPassword"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:hint="Kata Sandi"
+                    android:inputType="textPassword"
+                    android:maxLines="1" />
+            </com.google.android.material.textfield.TextInputLayout>
 
-                <Button
-                    android:id="@+id/loginBtn"
-                    android:layout_width="match_parent"
-                    android:layout_height="wrap_content"
-                    android:layout_margin="10dp"
-                    android:background="@drawable/btn_bg"
-                    android:text="LogIn"
-                    android:textAllCaps="false"
-                    android:textColor="@color/white" />
-            </LinearLayout>
-        </androidx.cardview.widget.CardView>
+            <Button
+                android:id="@+id/loginBtn"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:layout_margin="10dp"
+                android:background="@drawable/btn_bg"
+                android:text="Masuk"
+                android:textAllCaps="false"
+                android:textColor="@color/white" />
+        </LinearLayout>
+    </androidx.cardview.widget.CardView>
 
-    </LinearLayout>
-
     <com.google.android.gms.ads.AdView
         android:id="@+id/adViewIndex"
         android:layout_width="match_parent"
Index: app/src/main/java/com/misit/faceidchecklogptabp/Absen/MasukActivity.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.misit.faceidchecklogptabp.Absen\r\n\r\nimport android.Manifest\r\nimport android.app.AlertDialog\r\nimport android.content.Context\r\nimport android.content.ContextWrapper\r\nimport android.content.pm.PackageManager\r\nimport android.graphics.Bitmap\r\nimport android.location.Location\r\nimport android.location.LocationManager\r\nimport android.net.ConnectivityManager\r\nimport android.net.Uri\r\nimport android.os.Build\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport android.os.Bundle\r\nimport android.util.Log\r\nimport android.view.View\r\nimport android.view.WindowManager\r\nimport android.widget.Toast\r\nimport androidx.core.app.ActivityCompat\r\nimport com.google.android.gms.ads.AdListener\r\nimport com.google.android.gms.ads.AdRequest\r\nimport com.google.android.gms.ads.AdView\r\nimport com.google.android.gms.ads.MobileAds\r\nimport com.google.firebase.analytics.FirebaseAnalytics\r\nimport com.google.firebase.ml.vision.FirebaseVision\r\nimport com.google.firebase.ml.vision.common.FirebaseVisionImage\r\nimport com.google.firebase.ml.vision.common.FirebaseVisionPoint\r\nimport com.google.firebase.ml.vision.face.FirebaseVisionFace\r\nimport com.google.firebase.ml.vision.face.FirebaseVisionFaceContour\r\nimport com.google.firebase.ml.vision.face.FirebaseVisionFaceDetectorOptions\r\nimport com.google.firebase.ml.vision.face.FirebaseVisionFaceLandmark\r\nimport com.misit.abpenergy.api.ApiClient\r\nimport com.misit.abpenergy.api.ApiEndPoint\r\nimport com.misit.faceidchecklogptabp.Helper.RectOverlay\r\nimport com.misit.faceidchecklogptabp.R\r\nimport com.misit.faceidchecklogptabp.Response.ImageResponse\r\nimport com.misit.faceidchecklogptabp.Utils.PrefsUtil\r\nimport com.wonderkiln.camerakit.*\r\nimport dmax.dialog.SpotsDialog\r\nimport es.dmoral.toasty.Toasty\r\nimport kotlinx.android.synthetic.main.activity_masuk.*\r\nimport okhttp3.MediaType\r\nimport okhttp3.MultipartBody\r\nimport okhttp3.RequestBody\r\nimport retrofit2.Call\r\nimport retrofit2.Callback\r\nimport retrofit2.Response\r\nimport java.io.File\r\nimport java.io.FileOutputStream\r\nimport java.io.IOException\r\nimport java.io.OutputStream\r\nimport java.text.SimpleDateFormat\r\nimport java.util.*\r\n\r\nclass MasukActivity : AppCompatActivity() {\r\n\r\n    lateinit var waitingDialog: AlertDialog\r\n    private var bitmap:Bitmap?=null\r\n    private var niknya:String?=null\r\n    lateinit var  rectOverlay:RectOverlay\r\n    lateinit var mouthPos:MutableList<FirebaseVisionPoint>\r\n    private var mLocationManager : LocationManager?=null\r\n    private var mLocation : Location?= null\r\n    private var mFirebaseAnalytics: FirebaseAnalytics? = null\r\n\r\n    lateinit var mAdView : AdView\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        super.onCreate(savedInstanceState)\r\n        setContentView(R.layout.activity_masuk)\r\n//        SystemUtils.fullscreen(window,actionBar!!)\r\n        PrefsUtil.initInstance(this)\r\n        LAT = PrefsUtil.getInstance()\r\n            .getStringState(PrefsUtil.CURRENT_LAT,\"\")\r\n        LNG = PrefsUtil.getInstance()\r\n            .getStringState(PrefsUtil.CURRENT_LNG,\"\")\r\n\r\n//        Toasty.info(this,\"Lat : ${LAT}, Lng : ${LNG}\",Toasty.LENGTH_LONG).show()\r\n\r\n        mouthPos = ArrayList()\r\n\r\n        waitingDialog = SpotsDialog.Builder().setContext(this)\r\n            .setMessage(\"Please Wait...\")\r\n            .setCancelable(false)\r\n            .build()\r\n//        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {\r\n//            getWindow().setFlags(\r\n//                WindowManager.LayoutParams.FLAG_LAYOUT_NO_LIMITS,\r\n//                WindowManager.LayoutParams.FLAG_LAYOUT_NO_LIMITS)\r\n//        }\r\n        btn_detect.setOnClickListener{\r\n            camera_view.captureImage()\r\n            btn_detect.isEnabled=false\r\n            btn_detect.isClickable=false\r\n            //btnSave.visibility= View.GONE\r\n        }\r\n\r\n        btn_active_camera.setOnClickListener {\r\n            btn_detect.isEnabled=true\r\n            btn_detect.isClickable=true\r\n            camera_view.start()\r\n            graphic_overlay.clear()\r\n            btn_active_camera.visibility=View.GONE\r\n            btn_detect.visibility=View.VISIBLE\r\n        }\r\n\r\n        niknya = intent.getStringExtra(NIK)\r\n        btnToggle.setOnClickListener {\r\n//            if(camera_view.isFacingBack) {\r\n//                btnToggle.text=\"Camera Belakang\"\r\n//            }else{\r\n//                btnToggle.text=\"Camera Depan\"\r\n//            }\r\n            camera_view.toggleFacing()\r\n        }\r\n\r\n        btnBack.setOnClickListener {\r\n            onBackPressed()\r\n        }\r\n\r\n        camera_view.addCameraKitListener(object: CameraKitEventListener {\r\n            override fun onVideo(p0: CameraKitVideo?) {\r\n\r\n            }\r\n\r\n            override fun onEvent(p0: CameraKitEvent?) {\r\n            }\r\n\r\n            override fun onImage(p0: CameraKitImage?) {\r\n\r\n                waitingDialog.show()\r\n\r\n                bitmap = p0!!.bitmap\r\n                var bitmap1 = Bitmap.createScaledBitmap(bitmap!!,camera_view.width,camera_view.height,false)\r\n\r\n                camera_view.stop()\r\n                runFaceDetector(bitmap1)\r\n            }\r\n\r\n            override fun onError(p0: CameraKitError?) {\r\n\r\n            }\r\n\r\n        })\r\n    }\r\n    override fun onResume() {\r\n        super.onResume()\r\n        camera_view.start()\r\n        MobileAds.initialize(this) {}\r\n\r\n        mAdView = findViewById(R.id.adViewIndex)\r\n        val adRequest = AdRequest.Builder().build()\r\n        mAdView.loadAd(adRequest)\r\n\r\n        mAdView.adListener = object: AdListener() {\r\n            override fun onAdLoaded() {\r\n                // Code to be executed when an ad finishes loading.\r\n            }\r\n\r\n            override fun onAdFailedToLoad(errorCode : Int) {\r\n                Log.d(\"errorCode\",errorCode.toString())\r\n                // Code to be executed when an ad request fails.\r\n            }\r\n\r\n            override fun onAdOpened() {\r\n                // Code to be executed when an ad opens an overlay that\r\n                // covers the screen.\r\n            }\r\n\r\n            override fun onAdClicked() {\r\n                // Code to be executed when the user clicks on an ad.\r\n            }\r\n\r\n            override fun onAdLeftApplication() {\r\n                // Code to be executed when the user has left the app.\r\n            }\r\n\r\n            override fun onAdClosed() {\r\n                // Code to be executed when the user is about to return\r\n                // to the app after tapping on an ad.\r\n            }\r\n        }\r\n\r\n        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);\r\n        if(camera_view.isFacingBack){\r\n            camera_view.toggleFacing()\r\n//            btnToggle.text=\"Camera Belakang\"\r\n        }else{\r\n//            btnToggle.text=\"Camera Depan\"\r\n        }\r\n    }\r\n    override fun onPause() {\r\n        super.onPause()\r\n        camera_view.stop()\r\n    }\r\n    private fun saveImageToInternalStorage(bitmap: Bitmap?,id:Int): Uri {\r\n        var waktu = Date()\r\n        val cal = Calendar.getInstance()\r\n        cal.time = waktu\r\n        val simpleFormat = SimpleDateFormat(\"yyyy-MM-dd\", Locale.getDefault())\r\n        var tgl = \"${simpleFormat.format(cal.time)}\"\r\n        var jam = \"${cal.get(Calendar.HOUR_OF_DAY)}${cal.get(Calendar.MINUTE)}${cal.get(Calendar.SECOND)}\"\r\n        var pukul = \"${cal.get(Calendar.HOUR_OF_DAY)}:${cal.get(Calendar.MINUTE)}:${cal.get(Calendar.SECOND)}\"\r\n        val wrapper = ContextWrapper(applicationContext)\r\n        var file = wrapper.getDir(\"images\", Context.MODE_PRIVATE)\r\n        file = File(file, niknya+\"_Masuk_${tgl}__${jam}.jpg\")\r\n        try {\r\n            // Get the file output stream\r\n            val stream: OutputStream = FileOutputStream(file)\r\n            //var uri = Uri.parse(file.absolutePath)\r\n            // Compress bitmap\r\n            bitmap!!.compress(Bitmap.CompressFormat.JPEG, 20, stream)\r\n            // Flush the stream\r\n            stream.flush()\r\n            // Close stream\r\n            stream.close()\r\n        } catch (e: IOException){ // Catch the exception\r\n            e.printStackTrace()\r\n        }\r\n        var uri = Uri.parse(file.absolutePath)\r\n        var fileUri = RequestBody.create(MediaType.parse(\"image/*\"),file)\r\n        //Log.d(\"fileUri\",fileUri.toString())\r\n        var niK = RequestBody.create(MultipartBody.FORM, niknya!!)\r\n        var tanggal = RequestBody.create(MultipartBody.FORM, tgl)\r\n        var jam_absen = RequestBody.create(MultipartBody.FORM, pukul)\r\n        var status_absen = RequestBody.create(MultipartBody.FORM, \"Masuk\")\r\n        var idnya = RequestBody.create(MultipartBody.FORM, id.toString())\r\n        var lupa_absen = RequestBody.create(MultipartBody.FORM,\"\")\r\n        var lat = RequestBody.create(MultipartBody.FORM,LAT)\r\n        var lng = RequestBody.create(MultipartBody.FORM,LNG)\r\n        var fileToUpload = MultipartBody.Part.createFormData(\"fileToUpload\",file.name,fileUri)\r\n\r\n        //API\r\n        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPoint::class.java)\r\n        val call = apiEndPoint.uploadImage(\r\n            fileToUpload,\r\n            niK,\r\n            tanggal,\r\n            jam_absen,\r\n            status_absen,\r\n            idnya,lupa_absen,lat,lng)\r\n        call.enqueue(object : Callback<ImageResponse?> {\r\n            override fun onFailure(call: Call<ImageResponse?>, t: Throwable) {\r\n                Toasty.info(this@MasukActivity,\"$t\", Toasty.LENGTH_SHORT).show()\r\n            }\r\n            override fun onResponse(\r\n                call: Call<ImageResponse?>,\r\n                response: Response<ImageResponse?>\r\n            ) {\r\n                val imageResponse = response.body()\r\n                if (imageResponse != null) {\r\n                    if(imageResponse.tidak_dikenal!=null){\r\n                        if(imageResponse.tidak_dikenal){\r\n                            file.delete()\r\n                            btn_detect.visibility=View.VISIBLE\r\n                            btnBack.visibility=View.GONE\r\n                            waitingDialog.dismiss()\r\n                            camera_view.start()\r\n                            graphic_overlay.clear()\r\n                            Toasty.info(this@MasukActivity,\"Wajah Tidak Dikenal!\", Toasty.LENGTH_SHORT).show()\r\n                        }else{\r\n                            file.delete()\r\n                            btn_detect.visibility=View.GONE\r\n                            btnBack.visibility=View.VISIBLE\r\n                            waitingDialog.dismiss()\r\n                            Toasty.info(this@MasukActivity,\"Wajah di kenali, Absen di daftar!\", Toasty.LENGTH_SHORT).show()\r\n                        }\r\n                    }else{\r\n                        file.delete()\r\n                        btn_detect.visibility=View.VISIBLE\r\n                        btnBack.visibility=View.GONE\r\n                        waitingDialog.dismiss()\r\n                        camera_view.start()\r\n                        graphic_overlay.clear()\r\n                        Toasty.info(this@MasukActivity,\"Wajah Tidak Dikenal!\", Toasty.LENGTH_SHORT).show()\r\n                    }\r\n\r\n                   }\r\n            }\r\n        })\r\n        //API\r\n        return uri\r\n    }\r\n\r\n\r\n    fun runFaceDetector(bitmap: Bitmap?){\r\n        val image = FirebaseVisionImage.fromBitmap(bitmap!!)\r\n\r\n        val options  = FirebaseVisionFaceDetectorOptions.Builder()\r\n            .setPerformanceMode(\r\n                FirebaseVisionFaceDetectorOptions.ACCURATE)\r\n            .setLandmarkMode(FirebaseVisionFaceDetectorOptions.ALL_LANDMARKS)\r\n            .setClassificationMode(\r\n                FirebaseVisionFaceDetectorOptions.ALL_CLASSIFICATIONS)\r\n            .setContourMode(FirebaseVisionFaceDetectorOptions.ALL_CONTOURS)\r\n            .enableTracking()\r\n            .build()\r\n        val detector = FirebaseVision.getInstance().getVisionFaceDetector(options)\r\n\r\n        detector.detectInImage(image)\r\n            .addOnSuccessListener {\r\n                    result -> progressResult(result)\r\n            }\r\n            .addOnFailureListener{\r\n                    e -> Toast.makeText(this@MasukActivity,e.message, Toast.LENGTH_SHORT).show()\r\n            }\r\n\r\n    }\r\n    fun progressResult(result:List<FirebaseVisionFace>){\r\n        var count=0\r\n        var id=0\r\n        for (face in result){\r\n            val bounds = face.boundingBox\r\n\r\n            val leftEar = face.getLandmark(FirebaseVisionFaceLandmark.LEFT_EAR)\r\n            leftEar?.let {\r\n                //val leftEarPos = leftEar.position\r\n            }\r\n\r\n            if (face.smilingProbability != FirebaseVisionFace.UNCOMPUTED_PROBABILITY) {\r\n            }\r\n            if (face.rightEyeOpenProbability != FirebaseVisionFace.UNCOMPUTED_PROBABILITY) {\r\n            }\r\n            val upperLipBottomContour = face.getContour(FirebaseVisionFaceContour.UPPER_LIP_BOTTOM).points\r\n\r\n            upperLipBottomContour.let {\r\n                mouthPos.addAll(it)\r\n            }\r\n\r\n            if (face.trackingId!= FirebaseVisionFace.INVALID_ID) {\r\n                id=face.trackingId\r\n            }\r\n\r\n            rectOverlay = RectOverlay(graphic_overlay,bounds)\r\n//            graphic_overlay.add(rectOverlay)\r\n            count++\r\n        }\r\n        if(count>0){\r\n            //btnSave.visibility= View.VISIBLE\r\n            //Toast.makeText(this,\"$uri\",Toast.LENGTH_SHORT).show()\r\n            waitingDialog.dismiss()\r\n            if(mouthPos.isNotEmpty()){\r\n                saveImageToInternalStorage(bitmap,id)\r\n                graphic_overlay.add(rectOverlay)\r\n//                Toast.makeText(this@PulangActivity,String.format(\" ${mouth_bottomPos}\"),Toast.LENGTH_LONG).show()\r\n            }else{\r\n                Toasty.error(this@MasukActivity,\r\n                    \"Wajah Tidak Terdeteksi! \" +\r\n                            \"Harap Membuka Masker atau \" +\r\n                            \"Pelindung Wajah dan \" +\r\n                            \"Tidak Boleh Lebih dari satu Wajah .!\")\r\n                    .show()\r\n                btn_active_camera.visibility=View.VISIBLE\r\n                btn_detect.visibility=View.GONE\r\n                waitingDialog.dismiss()\r\n\r\n\r\n            }\r\n        }else{\r\n            waitingDialog.dismiss()\r\n            Toasty.error(this@MasukActivity,\r\n                \"Wajah Tidak Terdeteksi! \" +\r\n                        \"Harap Membuka Masker atau \" +\r\n                        \"Pelindung Wajah dan \" +\r\n                        \"Tidak Boleh Lebih dari satu Wajah .!\")\r\n                .show()\r\n//            waitingDialog.dismiss()\r\n            btn_active_camera.visibility=View.VISIBLE\r\n            btn_detect.visibility=View.GONE\r\n//            Toasty.info(this@MasukActivity,\"Wajah Tidak Terdeteksi\", Toasty.LENGTH_SHORT).show()\r\n        }\r\n    }\r\n\r\n    companion object{\r\n        var NIK = \"NIK\"\r\n        var LAT = \"\"\r\n        var LNG = \"\"\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/misit/faceidchecklogptabp/Absen/MasukActivity.kt	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/java/com/misit/faceidchecklogptabp/Absen/MasukActivity.kt	(date 1616839867036)
@@ -62,7 +62,7 @@
     lateinit var mouthPos:MutableList<FirebaseVisionPoint>
     private var mLocationManager : LocationManager?=null
     private var mLocation : Location?= null
-    private var mFirebaseAnalytics: FirebaseAnalytics? = null
+//    private var mFirebaseAnalytics: FirebaseAnalytics? = null
 
     lateinit var mAdView : AdView
     override fun onCreate(savedInstanceState: Bundle?) {
@@ -181,7 +181,7 @@
             }
         }
 
-        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
+//        mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);
         if(camera_view.isFacingBack){
             camera_view.toggleFacing()
 //            btnToggle.text="Camera Belakang"
Index: app/src/main/res/layout/last_3_days_absen.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/last_3_days_absen.xml	(date 1617066244050)
+++ app/src/main/res/layout/last_3_days_absen.xml	(date 1617066244050)
@@ -0,0 +1,120 @@
+<?xml version="1.0" encoding="utf-8"?>
+<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content">
+
+    <androidx.cardview.widget.CardView
+        app:cardCornerRadius="5dp"
+        app:cardBackgroundColor="@color/successColor"
+        android:layout_alignParentTop="true"
+        android:layout_marginTop="20dp"
+        android:layout_width="match_parent"
+        android:layout_height="135dp"
+        android:layout_alignParentLeft="true"
+        android:layout_marginLeft="20dp"
+        android:layout_alignParentRight="true"
+        android:layout_marginRight="20dp"
+        app:cardElevation="10dp"
+        android:layout_marginBottom="20dp"
+        >
+        <LinearLayout
+            android:paddingTop="20dp"
+            android:paddingLeft="10dp"
+            android:paddingBottom="10dp"
+            android:paddingRight="50dp"
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"
+            android:orientation="horizontal">
+            <LinearLayout
+                android:layout_width="match_parent"
+                android:layout_height="match_parent"
+                android:orientation="vertical">
+                <TextView
+                    android:textStyle="bold"
+                    android:textColor="@color/white"
+                    android:padding="2dp"
+                    android:id="@+id/tvNama"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:text="Boris Reyson Sitorus"/>
+                <TextView
+                    android:textColor="@color/white"
+                    android:padding="2dp"
+                    android:id="@+id/tvNik"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:text="18060207"/>
+                <TextView
+                    android:textSize="30sp"
+                    android:textColor="@color/white"
+                    android:padding="2dp"
+                    android:gravity="center_vertical"
+                    android:id="@+id/tvJam"
+                    android:layout_width="match_parent"
+                    android:layout_height="match_parent"
+                    android:text="07:00:00"/>
+            </LinearLayout>
+        </LinearLayout>
+    </androidx.cardview.widget.CardView>
+
+    <androidx.cardview.widget.CardView
+        android:layout_width="70dp"
+        android:layout_height="70dp"
+        android:layout_alignParentRight="true"
+        android:layout_alignParentTop="true"
+        android:layout_marginRight="2dp"
+        android:layout_marginTop="2dp"
+        app:cardElevation="10dp"
+        app:cardCornerRadius="70dp">
+        <ImageView
+            android:padding="15dp"
+            android:scaleType="centerCrop"
+            android:id="@+id/imgFace"
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"
+            android:src="@drawable/abp_logo"/>
+    </androidx.cardview.widget.CardView>
+
+    <androidx.cardview.widget.CardView
+        android:layout_width="wrap_content"
+        android:layout_height="25dp"
+        android:layout_alignParentLeft="true"
+        android:layout_alignParentTop="true"
+        android:layout_marginLeft="5dp"
+        android:layout_marginTop="8dp"
+        app:cardElevation="10dp"
+        app:cardCornerRadius="5dp">
+        <TextView
+            android:textStyle="bold"
+            android:textSize="18dp"
+            android:paddingLeft="10dp"
+            android:paddingRight="10dp"
+            android:gravity="center"
+            android:id="@+id/tvTGL"
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"
+            android:text="Selasa, 30 Maret 2021"/>
+    </androidx.cardview.widget.CardView>
+
+    <androidx.cardview.widget.CardView
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_alignParentRight="true"
+        android:layout_alignParentTop="true"
+        android:layout_marginRight="25dp"
+        android:layout_marginTop="140dp"
+        app:cardElevation="10dp"
+        app:cardCornerRadius="5dp">
+        <TextView
+            android:textStyle="bold"
+            android:gravity="center"
+            android:textColor="@color/successColor"
+            android:padding="4dp"
+            android:id="@+id/tvStatus"
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"
+            android:text="Masuk"/>
+    </androidx.cardview.widget.CardView>
+</RelativeLayout>
\ No newline at end of file
Index: app/src/main/res/drawable-v24/background_border.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/drawable-v24/background_border.xml	(date 1614917318000)
+++ app/src/main/res/drawable-v24/background_border.xml	(date 1614917318000)
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2020 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~     http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle" >
+    <solid android:color="@android:color/transparent" />
+    <stroke android:width="1dp" android:color="@color/colorPrimary"/>
+    <!-- The radius makes the corners rounded -->
+    <corners android:radius="5dp" />
+</shape>
\ No newline at end of file
Index: app/src/main/res/layout/activity_main.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"@color/bg_color\"\r\n    tools:context=\".MainActivity\">\r\n\r\n    <TextView\r\n        android:id=\"@+id/tvVersionCode\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginBottom=\"16dp\"\r\n        android:text=\"1\"\r\n        android:textColor=\"@color/white\"\r\n        android:textSize=\"10sp\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/tvVersion\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginBottom=\"4dp\"\r\n        android:text=\"App Version\"\r\n        android:textColor=\"@color/white\"\r\n        android:textSize=\"10sp\"\r\n        app:layout_constraintBottom_toTopOf=\"@+id/tvVersionCode\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\" />\r\n\r\n    <ImageView\r\n        android:id=\"@+id/imageView\"\r\n        android:layout_width=\"90dp\"\r\n        android:layout_height=\"90dp\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        android:background=\"@drawable/bg_abp\"\r\n        android:padding=\"10dp\" />\r\n\r\n    <ProgressBar\r\n        android:visibility=\"gone\"\r\n        android:id=\"@+id/progressHorizontal\"\r\n        style=\"?android:attr/progressBarStyleHorizontal\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:indeterminateTint=\"@color/red_smooth\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n    <com.google.android.gms.ads.AdView\r\n        android:id=\"@+id/adView\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_alignParentBottom=\"true\"\r\n        android:layout_centerHorizontal=\"true\"\r\n        app:adSize=\"BANNER\"\r\n        app:adUnitId=\"@string/APP_ADMOB_ID_BANNER\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"></com.google.android.gms.ads.AdView>\r\n\r\n</androidx.constraintlayout.widget.ConstraintLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_main.xml	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/res/layout/activity_main.xml	(date 1616841198840)
@@ -24,7 +24,7 @@
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         android:layout_marginBottom="4dp"
-        android:text="App Version"
+        android:text="Versi"
         android:textColor="@color/white"
         android:textSize="10sp"
         app:layout_constraintBottom_toTopOf="@+id/tvVersionCode"
Index: app/src/main/res/values/strings.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><resources>\r\n\r\n    <string name=\"pref_key\">com.misit.faceidchecklogptabp</string>\r\n    <string name=\"app_name\">Face Id PT. ABP Energy</string>\r\n    <string name=\"APP_ADMOB_ID\">ca-app-pub-5972533139163141~9698907454</string>\r\n    <string name=\"APP_ADMOB_ID_BANNER\">ca-app-pub-5972533139163141/7494458082</string>\r\n    <string name=\"APP_ADMOB_ID_NATIVE_ADVANCED\">ca-app-pub-5972533139163141/4047899600</string>\r\n    <string name=\"banner_test\">ca-app-pub-3940256099942544/6300978111</string>\r\n    <string name=\"cari_karyawan_masukan\">Cari Karyawan / Masukan</string>\r\n</resources>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/values/strings.xml	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/res/values/strings.xml	(date 1616841198852)
@@ -1,10 +1,28 @@
 <resources>
 
     <string name="pref_key">com.misit.faceidchecklogptabp</string>
-    <string name="app_name">Face Id PT. ABP Energy</string>
+    <string name="app_name">Face Id ABP Energy</string>
     <string name="APP_ADMOB_ID">ca-app-pub-5972533139163141~9698907454</string>
     <string name="APP_ADMOB_ID_BANNER">ca-app-pub-5972533139163141/7494458082</string>
     <string name="APP_ADMOB_ID_NATIVE_ADVANCED">ca-app-pub-5972533139163141/4047899600</string>
     <string name="banner_test">ca-app-pub-3940256099942544/6300978111</string>
     <string name="cari_karyawan_masukan">Cari Karyawan / Masukan</string>
+
+
+    <string name="launch_activity">Launch activity</string>
+    <string name="location_unknown">Location Unknown</string>
+    <string name="location_updates_label">Location Updates</string>
+
+    <string name="permission_rationale">Location permission needed for core functionality</string>
+    <string name="permission_denied_explanation">Permission was denied, but is needed for core functionality.</string>
+    <string name="settings">Settings</string>
+    <string name="ok">OK</string>
+
+    <string name="start_location_updates_button_text">Start receiving location updates</string>
+    <string name="stop_location_updates_button_text">Stop receiving location updates</string>
+
+    <string name="location_updated">Location Updated: %1$s</string>
+
+    <string name="preference_file_key">com.example.android.while_in_use_location.PREFERENCE_FILE_KEY</string>
+    <string name="no_location_text">No current location</string>
 </resources>
Index: app/src/main/java/com/misit/faceidchecklogptabp/Adapter/Last3DaysAdapter.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/misit/faceidchecklogptabp/Adapter/Last3DaysAdapter.kt	(date 1617066243995)
+++ app/src/main/java/com/misit/faceidchecklogptabp/Adapter/Last3DaysAdapter.kt	(date 1617066243995)
@@ -0,0 +1,40 @@
+package com.misit.faceidchecklogptabp.Adapter
+
+import android.content.Context
+import android.view.LayoutInflater
+import android.view.ViewGroup
+import androidx.recyclerview.widget.RecyclerView
+import com.misit.faceidchecklogptabp.R
+import com.misit.faceidchecklogptabp.Response.Absen.DataItems
+import java.text.SimpleDateFormat
+
+class Last3DaysAdapter(
+    private val context: Context?,
+    private val listAbsen:MutableList<DataItems>):
+    RecyclerView.Adapter<ListAbsenAdapter.MyViewHolder>(){
+
+    private val layoutInflater: LayoutInflater
+    private var simpleDateFormat: SimpleDateFormat? = null
+    private var onItemClickListener: ListAbsenAdapter.OnItemClickListener? = null
+
+    override fun onCreateViewHolder(
+        parent: ViewGroup,
+        viewType: Int
+    ): ListAbsenAdapter.MyViewHolder {
+        val view = layoutInflater.inflate(R.layout.last_3_days_absen,parent,false)
+        return ListAbsenAdapter.MyViewHolder(view)
+    }
+
+    override fun getItemCount(): Int {
+        TODO("Not yet implemented")
+    }
+
+    override fun onBindViewHolder(holder: ListAbsenAdapter.MyViewHolder, position: Int) {
+        TODO("Not yet implemented")
+    }
+
+
+    init {
+        layoutInflater = LayoutInflater.from(context)
+    }
+}
\ No newline at end of file
Index: app/src/main/res/values/colors.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<resources>\r\n    <color name=\"colorPrimary\">#355B8C</color>\r\n    <color name=\"colorPrimaryDark\">#355B8C</color>\r\n    <color name=\"colorAccent\">#355B8C</color>\r\n    <color name=\"colorHeader\">#355B8C</color>\r\n    <color name=\"white\">#FFFFFF</color>\r\n    <color name=\"red_smooth\">#A62D2D</color>\r\n    <color name=\"bg_color\">#355B8C</color>\r\n    <color name=\"masuk\">#4CAF50</color>\r\n    <color name=\"pulang\">#F44336</color>\r\n    <color name=\"transparent\">#0D000000</color>\r\n</resources>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/values/colors.xml	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/res/values/colors.xml	(date 1617005108762)
@@ -1,6 +1,7 @@
 <?xml version="1.0" encoding="utf-8"?>
 <resources>
     <color name="colorPrimary">#355B8C</color>
+    <color name="borderSmoth">#285674DF</color>
     <color name="colorPrimaryDark">#355B8C</color>
     <color name="colorAccent">#355B8C</color>
     <color name="colorHeader">#355B8C</color>
Index: app/src/main/res/values/google_maps_api.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<resources>\r\n    <string name=\"google_maps_key\" templateMergeStrategy=\"preserve\" translatable=\"false\">AIzaSyCNFKd78hcUmIP4NNLXHI8Hf4qyfp418D0</string>\r\n</resources>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/values/google_maps_api.xml	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/res/values/google_maps_api.xml	(date 1616832157630)
@@ -1,4 +1,4 @@
 <?xml version="1.0" encoding="utf-8"?>
 <resources>
-    <string name="google_maps_key" templateMergeStrategy="preserve" translatable="false">AIzaSyCNFKd78hcUmIP4NNLXHI8Hf4qyfp418D0</string>
+    <string name="google_maps_key" templateMergeStrategy="preserve" translatable="false">AIzaSyAi2tEop3np-bpG-ZCCcSOEg9VKeNSoiZs</string>
 </resources>
\ No newline at end of file
Index: app/src/main/res/drawable/ic_baseline_history_24.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/drawable/ic_baseline_history_24.xml	(date 1617009667876)
+++ app/src/main/res/drawable/ic_baseline_history_24.xml	(date 1617009667876)
@@ -0,0 +1,5 @@
+<vector android:height="24dp" android:tint="#FFF7FF"
+    android:viewportHeight="24" android:viewportWidth="24"
+    android:width="24dp" xmlns:android="http://schemas.android.com/apk/res/android">
+    <path android:fillColor="@android:color/white" android:pathData="M13,3c-4.97,0 -9,4.03 -9,9L1,12l3.89,3.89 0.07,0.14L9,12L6,12c0,-3.87 3.13,-7 7,-7s7,3.13 7,7 -3.13,7 -7,7c-1.93,0 -3.68,-0.79 -4.94,-2.06l-1.42,1.42C8.27,19.99 10.51,21 13,21c4.97,0 9,-4.03 9,-9s-4.03,-9 -9,-9zM12,8v5l4.28,2.54 0.72,-1.21 -3.5,-2.08L13.5,8L12,8z"/>
+</vector>
Index: app/src/main/AndroidManifest.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    package=\"com.misit.faceidchecklogptabp\">\r\n\r\n    <uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\" />\r\n    <uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\" />\r\n    <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\" />\r\n    <uses-permission android:name=\"android.permission.READ_EXTERNAL_STORAGE\" />\r\n    <uses-permission android:name=\"android.permission.WRITE_INTERNAL_STORAGE\" />\r\n    <uses-permission android:name=\"android.permission.CAMERA\" />\r\n    <uses-permission android:name=\"android.permission.INTERNET\" />\r\n    <uses-permission android:name=\"android.permission.READ_PHONE_STATE\" />\r\n    <uses-permission android:name=\"android.permission.READ_PHONE_NUMBERS\" />\r\n\r\n    <uses-feature android:name=\"android.hardware.camera\" />\r\n    <uses-feature android:name=\"android.hardware.camera.autofocus\" />\r\n\r\n    <application\r\n        android:allowBackup=\"true\"\r\n        android:icon=\"@mipmap/ic_launcher\"\r\n        android:label=\"@string/app_name\"\r\n        android:networkSecurityConfig=\"@xml/network\"\r\n        android:roundIcon=\"@mipmap/ic_launcher_round\"\r\n        android:supportsRtl=\"true\"\r\n        android:theme=\"@style/AppTheme\">\r\n        <activity android:name=\".Absen.AbsenMapActivity\"></activity>\r\n        <activity android:name=\".Masukan.MasukanDetailActivity\" />\r\n\r\n        <meta-data\r\n            android:name=\"com.google.android.gms.ads.APPLICATION_ID\"\r\n            android:value=\"@string/APP_ADMOB_ID\" />\r\n\r\n        <activity\r\n            android:name=\".Masukan.MasukanActivity\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\" />\r\n        <activity\r\n            android:name=\".Absen.DaftarWajahActivity\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\"\r\n            android:theme=\"@style/noActionBar\" />\r\n        <activity android:name=\".Helper.KirimMasukanActivity\" />\r\n        <activity\r\n            android:name=\".Absen.LupaPulangActivity\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\"\r\n            android:theme=\"@style/noActionBar\" />\r\n        <activity\r\n            android:name=\".Absen.LupaMasukActivity\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\"\r\n            android:theme=\"@style/noActionBar\" />\r\n        <activity\r\n            android:name=\".Chart.PersentaseActivity\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\" />\r\n        <activity\r\n            android:name=\".ListAbsenActivity\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\" />\r\n        <uses-library\r\n            android:name=\"org.apache.http.legacy\"\r\n            android:required=\"false\" />\r\n\r\n        <meta-data\r\n            android:name=\"com.google.android.geo.API_KEY\"\r\n            android:value=\"@string/google_maps_key\" />\r\n\r\n        <meta-data\r\n            android:name=\"firebase_messaging_auto_init_enabled\"\r\n            android:value=\"false\" />\r\n        <meta-data\r\n            android:name=\"firebase_analytics_collection_enabled\"\r\n            android:value=\"false\" />\r\n\r\n        <service\r\n            android:name=\".services.MyFirebaseId\"\r\n            android:exported=\"false\">\r\n            <intent-filter>\r\n                <action android:name=\"com.google.firebase.MESSAGING_EVENT\" />\r\n            </intent-filter>\r\n        </service>\r\n\r\n        <activity\r\n            android:name=\".ViewImageActivity\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\" />\r\n        <activity\r\n            android:name=\".LihatAbsenActivity\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\" />\r\n        <activity\r\n            android:name=\".IndexActivity\"\r\n            android:label=\"@string/app_name\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\"\r\n            android:theme=\"@style/noActionBar\" />\r\n        <activity\r\n            android:name=\".Absen.PulangActivity\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\"\r\n            android:theme=\"@style/noActionBar\">\r\n            <meta-data\r\n                android:name=\"com.google.firebase.ml.vision.DEPEDENCIES\"\r\n                android:value=\"face\" />\r\n        </activity>\r\n        <activity\r\n            android:name=\".Absen.MasukActivity\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\"\r\n            android:theme=\"@style/noActionBar\">\r\n            <meta-data\r\n                android:name=\"com.google.firebase.ml.vision.DEPEDENCIES\"\r\n                android:value=\"face\" />\r\n        </activity>\r\n        <activity\r\n            android:name=\".LoginActivity\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\"\r\n            android:theme=\"@style/noActionBar\" />\r\n        <activity\r\n            android:name=\".MainActivity\"\r\n            android:launchMode=\"singleTask\"\r\n            android:screenOrientation=\"portrait\"\r\n            android:theme=\"@style/noActionBar\">\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.MAIN\" />\r\n\r\n                <category android:name=\"android.intent.category.LAUNCHER\" />\r\n            </intent-filter>\r\n        </activity>\r\n    </application>\r\n\r\n</manifest>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/AndroidManifest.xml	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ app/src/main/AndroidManifest.xml	(date 1617066439105)
@@ -4,6 +4,8 @@
 
     <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
     <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
+    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
+    <uses-permission android:name="android.permission.WAKE_LOCK" />
     <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
     <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
     <uses-permission android:name="android.permission.WRITE_INTERNAL_STORAGE" />
@@ -11,6 +13,12 @@
     <uses-permission android:name="android.permission.INTERNET" />
     <uses-permission android:name="android.permission.READ_PHONE_STATE" />
     <uses-permission android:name="android.permission.READ_PHONE_NUMBERS" />
+    <uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
+    <!--
+ Required only when requesting background location access on
+          Android 10 (API level 29) and higher.
+    -->
+    <uses-permission android:name="android.permission.ACCESS_BACKGROUND_LOCATION" />
 
     <uses-feature android:name="android.hardware.camera" />
     <uses-feature android:name="android.hardware.camera.autofocus" />
@@ -23,7 +31,11 @@
         android:roundIcon="@mipmap/ic_launcher_round"
         android:supportsRtl="true"
         android:theme="@style/AppTheme">
-        <activity android:name=".Absen.AbsenMapActivity"></activity>
+        <activity android:name=".HomeActivity"
+            android:launchMode="singleTask"
+            android:screenOrientation="portrait"
+            android:theme="@style/noActionBar"></activity>
+        <activity android:name=".Absen.AbsenMapActivity" />
         <activity android:name=".Masukan.MasukanDetailActivity" />
 
         <meta-data
@@ -58,6 +70,7 @@
             android:name=".ListAbsenActivity"
             android:launchMode="singleTask"
             android:screenOrientation="portrait" />
+
         <uses-library
             android:name="org.apache.http.legacy"
             android:required="false" />
@@ -65,7 +78,6 @@
         <meta-data
             android:name="com.google.android.geo.API_KEY"
             android:value="@string/google_maps_key" />
-
         <meta-data
             android:name="firebase_messaging_auto_init_enabled"
             android:value="false" />
Index: build.gradle
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>// Top-level build file where you can add configuration options common to all sub-projects/modules.\r\n\r\nbuildscript {\r\n    ext.kotlin_version = '1.3.61'\r\n    repositories {\r\n        google()\r\n        jcenter()\r\n    }\r\n    dependencies {\r\n        classpath 'com.android.tools.build:gradle:3.5.3'\r\n        classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version\"\r\n        classpath 'com.google.gms:google-services:4.3.3'\r\n        classpath 'com.google.firebase:firebase-crashlytics-gradle:2.0.0'\r\n        // NOTE: Do not place your application dependencies here; they belong\r\n        // in the individual module build.gradle files\r\n    }\r\n}\r\nallprojects {\r\n    repositories {\r\n        google()\r\n        jcenter()\r\n        maven { url \"https://jitpack.io\" }\r\n        maven { url 'https://dl.bintray.com/camerakit/camerakit-android-snapshots' }\r\n    }\r\n}\r\ntask clean(type: Delete) {\r\n    delete rootProject.buildDir\r\n}\r\nconfigurations.all {\r\n    resolutionStrategy.cacheChangingModulesFor 0, 'seconds'\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- build.gradle	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ build.gradle	(date 1617092744376)
@@ -21,6 +21,7 @@
         jcenter()
         maven { url "https://jitpack.io" }
         maven { url 'https://dl.bintray.com/camerakit/camerakit-android-snapshots' }
+
     }
 }
 task clean(type: Delete) {
Index: .idea/misc.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ProjectRootManager\" version=\"2\" languageLevel=\"JDK_1_7\" project-jdk-name=\"1.8\" project-jdk-type=\"JavaSDK\">\r\n    <output url=\"file://$PROJECT_DIR$/build/classes\" />\r\n  </component>\r\n  <component name=\"ProjectType\">\r\n    <option name=\"id\" value=\"Android\" />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/misc.xml	(revision 0541c75f3845100eb2c6d5cae1a8705ead42dae8)
+++ .idea/misc.xml	(date 1616028110464)
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <project version="4">
-  <component name="ProjectRootManager" version="2" languageLevel="JDK_1_7" project-jdk-name="1.8" project-jdk-type="JavaSDK">
+  <component name="ProjectRootManager" version="2" languageLevel="JDK_1_8" default="true" project-jdk-name="1.8" project-jdk-type="JavaSDK">
     <output url="file://$PROJECT_DIR$/build/classes" />
   </component>
   <component name="ProjectType">
Index: .idea/compiler.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/compiler.xml	(date 1616028110496)
+++ .idea/compiler.xml	(date 1616028110496)
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="CompilerConfiguration">
+    <bytecodeTargetLevel target="1.8" />
+  </component>
+</project>
\ No newline at end of file
Index: .idea/jarRepositories.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/jarRepositories.xml	(date 1616028202768)
+++ .idea/jarRepositories.xml	(date 1616028202768)
@@ -0,0 +1,35 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="RemoteRepositoriesConfiguration">
+    <remote-repository>
+      <option name="id" value="central" />
+      <option name="name" value="Maven Central repository" />
+      <option name="url" value="https://repo1.maven.org/maven2" />
+    </remote-repository>
+    <remote-repository>
+      <option name="id" value="jboss.community" />
+      <option name="name" value="JBoss Community repository" />
+      <option name="url" value="https://repository.jboss.org/nexus/content/repositories/public/" />
+    </remote-repository>
+    <remote-repository>
+      <option name="id" value="maven2" />
+      <option name="name" value="maven2" />
+      <option name="url" value="https://dl.bintray.com/camerakit/camerakit-android-snapshots" />
+    </remote-repository>
+    <remote-repository>
+      <option name="id" value="BintrayJCenter" />
+      <option name="name" value="BintrayJCenter" />
+      <option name="url" value="https://jcenter.bintray.com/" />
+    </remote-repository>
+    <remote-repository>
+      <option name="id" value="maven" />
+      <option name="name" value="maven" />
+      <option name="url" value="https://jitpack.io" />
+    </remote-repository>
+    <remote-repository>
+      <option name="id" value="Google" />
+      <option name="name" value="Google" />
+      <option name="url" value="https://dl.google.com/dl/android/maven2/" />
+    </remote-repository>
+  </component>
+</project>
\ No newline at end of file
